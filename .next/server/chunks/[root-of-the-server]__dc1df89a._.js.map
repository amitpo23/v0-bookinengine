{"version":3,"sources":["../../../../v0-bookinengine/node_modules/next/src/server/route-modules/app-page/module.compiled.js","../../../../v0-bookinengine/node_modules/next/src/server/route-modules/app-page/vendored/rsc/react.ts","../../../../v0-bookinengine/node_modules/node-domexception/index.js","../../../../v0-bookinengine/lib/ai-engines/handlers/voice.ts","../../../../v0-bookinengine/lib/ai-engines/handlers/monitoring.ts","../../../../v0-bookinengine/lib/ai-engines/handlers/booking.ts"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-rsc']!.React\n","/*! node-domexception. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> */\n\nif (!globalThis.DOMException) {\n  try {\n    const { MessageChannel } = require('worker_threads'),\n    port = new MessageChannel().port1,\n    ab = new ArrayBuffer()\n    port.postMessage(ab, [ab, ab])\n  } catch (err) {\n    err.constructor.name === 'DOMException' && (\n      globalThis.DOMException = err.constructor\n    )\n  }\n}\n\nmodule.exports = globalThis.DOMException\n","/**\r\n * Voice Handlers\r\n * Tool handlers for voice interaction, call management, and TTS/STT\r\n * Based on: call-center-ai Azure Communication Services integration\r\n */\r\n\r\nimport type { ConversationContext } from '../types';\r\n\r\n// Azure Communication Services config (from environment)\r\nconst ACS_CONNECTION_STRING = process.env.ACS_CONNECTION_STRING || '';\r\nconst ACS_PHONE_NUMBER = process.env.ACS_PHONE_NUMBER || '';\r\nconst AZURE_SPEECH_KEY = process.env.AZURE_SPEECH_KEY || '';\r\nconst AZURE_SPEECH_REGION = process.env.AZURE_SPEECH_REGION || 'westeurope';\r\n\r\n// ========================================\r\n// INITIATE CALL\r\n// ========================================\r\n\r\ninterface InitiateCallParams {\r\n  phoneNumber: string;\r\n  purpose: string;\r\n  language?: string;\r\n}\r\n\r\ninterface CallResult {\r\n  success: boolean;\r\n  callId: string;\r\n  status: 'initiated' | 'ringing' | 'connected' | 'failed';\r\n  fromNumber: string;\r\n  toNumber: string;\r\n  startedAt: Date;\r\n  estimatedDuration?: number;\r\n}\r\n\r\nexport async function initiateCall(\r\n  params: InitiateCallParams,\r\n  context: ConversationContext\r\n): Promise<CallResult> {\r\n  console.log(`[VoiceHandler] Initiating call to ${params.phoneNumber}`);\r\n\r\n  try {\r\n    // Validate phone number format (E.164)\r\n    const phoneRegex = /^\\+[1-9]\\d{1,14}$/;\r\n    if (!phoneRegex.test(params.phoneNumber)) {\r\n      throw new Error('Invalid phone number format. Use E.164 format (e.g., +972501234567)');\r\n    }\r\n\r\n    // In production, use Azure Communication Services\r\n    // const client = new CallAutomationClient(ACS_CONNECTION_STRING);\r\n    // const callConnection = await client.createCall(\r\n    //   { phoneNumber: params.phoneNumber },\r\n    //   { phoneNumber: ACS_PHONE_NUMBER },\r\n    //   'https://your-callback-url/events'\r\n    // );\r\n\r\n    const callId = `call-${Date.now()}-${Math.random().toString(36).substr(2, 8)}`;\r\n\r\n    // Store call context\r\n    if (context) {\r\n      context.metadata = {\r\n        ...context.metadata,\r\n        activeCall: {\r\n          callId,\r\n          phoneNumber: params.phoneNumber,\r\n          purpose: params.purpose,\r\n          language: params.language || 'he-IL',\r\n          startedAt: new Date()\r\n        }\r\n      };\r\n    }\r\n\r\n    return {\r\n      success: true,\r\n      callId,\r\n      status: 'initiated',\r\n      fromNumber: ACS_PHONE_NUMBER || '+972-XX-XXXXXXX',\r\n      toNumber: params.phoneNumber,\r\n      startedAt: new Date()\r\n    };\r\n  } catch (error: any) {\r\n    console.error(`[VoiceHandler] Call initiation error:`, error);\r\n    throw new Error(`Failed to initiate call: ${error.message}`);\r\n  }\r\n}\r\n\r\n// ========================================\r\n// TRANSFER TO HUMAN\r\n// ========================================\r\n\r\ninterface TransferParams {\r\n  reason: string;\r\n  agentQueue?: string;\r\n}\r\n\r\ninterface TransferResult {\r\n  success: boolean;\r\n  transferId: string;\r\n  targetQueue: string;\r\n  estimatedWaitTime: number;\r\n  message: string;\r\n}\r\n\r\nexport async function transferToHuman(\r\n  params: TransferParams,\r\n  context: ConversationContext\r\n): Promise<TransferResult> {\r\n  console.log(`[VoiceHandler] Transferring to human agent:`, params);\r\n\r\n  try {\r\n    // Determine target queue based on reason or specified queue\r\n    const queue = params.agentQueue || determineQueueFromReason(params.reason);\r\n\r\n    // Get estimated wait time (mock)\r\n    const estimatedWait = Math.floor(Math.random() * 5) + 1; // 1-5 minutes\r\n\r\n    const transferId = `xfer-${Date.now()}-${Math.random().toString(36).substr(2, 6)}`;\r\n\r\n    // Update context\r\n    if (context) {\r\n      context.metadata = {\r\n        ...context.metadata,\r\n        transferredToHuman: {\r\n          transferId,\r\n          reason: params.reason,\r\n          queue,\r\n          transferredAt: new Date()\r\n        }\r\n      };\r\n    }\r\n\r\n    return {\r\n      success: true,\r\n      transferId,\r\n      targetQueue: queue,\r\n      estimatedWaitTime: estimatedWait,\r\n      message: `Transferring you to our ${queue} team. Estimated wait time: ${estimatedWait} minutes.`\r\n    };\r\n  } catch (error: any) {\r\n    console.error(`[VoiceHandler] Transfer error:`, error);\r\n    throw new Error(`Transfer failed: ${error.message}`);\r\n  }\r\n}\r\n\r\nfunction determineQueueFromReason(reason: string): string {\r\n  const reasonLower = reason.toLowerCase();\r\n  \r\n  if (reasonLower.includes('billing') || reasonLower.includes('payment') || reasonLower.includes('refund')) {\r\n    return 'billing-support';\r\n  }\r\n  if (reasonLower.includes('cancel') || reasonLower.includes('modify') || reasonLower.includes('change')) {\r\n    return 'booking-modifications';\r\n  }\r\n  if (reasonLower.includes('complaint') || reasonLower.includes('problem') || reasonLower.includes('issue')) {\r\n    return 'customer-care';\r\n  }\r\n  if (reasonLower.includes('group') || reasonLower.includes('corporate') || reasonLower.includes('business')) {\r\n    return 'corporate-sales';\r\n  }\r\n  \r\n  return 'general-support';\r\n}\r\n\r\n// ========================================\r\n// SEND CALL SUMMARY SMS\r\n// ========================================\r\n\r\ninterface SendCallSummarySmsParams {\r\n  phoneNumber: string;\r\n  summary: string;\r\n}\r\n\r\ninterface SmsResult {\r\n  success: boolean;\r\n  messageId: string;\r\n  to: string;\r\n  status: 'sent' | 'delivered' | 'failed';\r\n  sentAt: Date;\r\n}\r\n\r\nexport async function sendCallSummarySms(\r\n  params: SendCallSummarySmsParams,\r\n  context: ConversationContext\r\n): Promise<SmsResult> {\r\n  console.log(`[VoiceHandler] Sending call summary SMS to ${params.phoneNumber}`);\r\n\r\n  try {\r\n    // Validate phone number\r\n    const phoneRegex = /^\\+[1-9]\\d{1,14}$/;\r\n    if (!phoneRegex.test(params.phoneNumber)) {\r\n      throw new Error('Invalid phone number format');\r\n    }\r\n\r\n    // Truncate summary if too long for SMS\r\n    const maxLength = 160 * 3; // Allow up to 3 SMS segments\r\n    const truncatedSummary = params.summary.length > maxLength\r\n      ? params.summary.substring(0, maxLength - 3) + '...'\r\n      : params.summary;\r\n\r\n    // In production, use Azure Communication Services SMS\r\n    // const client = new SmsClient(ACS_CONNECTION_STRING);\r\n    // const response = await client.send({\r\n    //   from: ACS_PHONE_NUMBER,\r\n    //   to: [params.phoneNumber],\r\n    //   message: truncatedSummary\r\n    // });\r\n\r\n    const messageId = `sms-${Date.now()}-${Math.random().toString(36).substr(2, 8)}`;\r\n\r\n    return {\r\n      success: true,\r\n      messageId,\r\n      to: params.phoneNumber,\r\n      status: 'sent',\r\n      sentAt: new Date()\r\n    };\r\n  } catch (error: any) {\r\n    console.error(`[VoiceHandler] SMS error:`, error);\r\n    throw new Error(`Failed to send SMS: ${error.message}`);\r\n  }\r\n}\r\n\r\n// ========================================\r\n// TEXT TO SPEECH\r\n// ========================================\r\n\r\ninterface TextToSpeechParams {\r\n  text: string;\r\n  voice?: string;\r\n  language?: string;\r\n  speed?: number;\r\n  pitch?: number;\r\n}\r\n\r\ninterface TtsResult {\r\n  success: boolean;\r\n  audioUrl?: string;\r\n  audioBase64?: string;\r\n  duration: number;\r\n  format: string;\r\n}\r\n\r\nexport async function textToSpeech(\r\n  params: TextToSpeechParams,\r\n  context: ConversationContext\r\n): Promise<TtsResult> {\r\n  console.log(`[VoiceHandler] Converting text to speech:`, params.text.substring(0, 50));\r\n\r\n  try {\r\n    const voice = params.voice || 'he-IL-HilaNeural';\r\n    const speed = params.speed || 1.0;\r\n\r\n    // In production, use Azure Cognitive Services Speech SDK\r\n    // const speechConfig = sdk.SpeechConfig.fromSubscription(AZURE_SPEECH_KEY, AZURE_SPEECH_REGION);\r\n    // speechConfig.speechSynthesisVoiceName = voice;\r\n    // const synthesizer = new sdk.SpeechSynthesizer(speechConfig);\r\n    // const result = await synthesizer.speakTextAsync(params.text);\r\n\r\n    // Mock response\r\n    const estimatedDuration = params.text.split(' ').length * 0.4; // ~0.4 seconds per word\r\n\r\n    return {\r\n      success: true,\r\n      audioUrl: `/api/tts/audio-${Date.now()}.mp3`,\r\n      duration: estimatedDuration,\r\n      format: 'audio/mpeg'\r\n    };\r\n  } catch (error: any) {\r\n    console.error(`[VoiceHandler] TTS error:`, error);\r\n    throw new Error(`Text-to-speech failed: ${error.message}`);\r\n  }\r\n}\r\n\r\n// ========================================\r\n// SPEECH TO TEXT\r\n// ========================================\r\n\r\ninterface SpeechToTextParams {\r\n  audioUrl?: string;\r\n  audioBase64?: string;\r\n  language?: string;\r\n}\r\n\r\ninterface SttResult {\r\n  success: boolean;\r\n  text: string;\r\n  confidence: number;\r\n  language: string;\r\n  duration: number;\r\n  alternatives?: Array<{ text: string; confidence: number }>;\r\n}\r\n\r\nexport async function speechToText(\r\n  params: SpeechToTextParams,\r\n  context: ConversationContext\r\n): Promise<SttResult> {\r\n  console.log(`[VoiceHandler] Converting speech to text`);\r\n\r\n  try {\r\n    const language = params.language || 'he-IL';\r\n\r\n    // In production, use Azure Cognitive Services Speech SDK\r\n    // const speechConfig = sdk.SpeechConfig.fromSubscription(AZURE_SPEECH_KEY, AZURE_SPEECH_REGION);\r\n    // speechConfig.speechRecognitionLanguage = language;\r\n    // const recognizer = new sdk.SpeechRecognizer(speechConfig, audioConfig);\r\n    // const result = await recognizer.recognizeOnceAsync();\r\n\r\n    // Mock response\r\n    return {\r\n      success: true,\r\n      text: 'אני רוצה להזמין חדר במלון בדובאי לשלושה לילות',\r\n      confidence: 0.95,\r\n      language,\r\n      duration: 3.2,\r\n      alternatives: [\r\n        { text: 'אני רוצה להזמין חדר במלון בדובאי לשלושה לילות', confidence: 0.95 },\r\n        { text: 'אני רוצה להזמין חדר במלון ב-דובאי ל-3 לילות', confidence: 0.88 }\r\n      ]\r\n    };\r\n  } catch (error: any) {\r\n    console.error(`[VoiceHandler] STT error:`, error);\r\n    throw new Error(`Speech-to-text failed: ${error.message}`);\r\n  }\r\n}\r\n\r\n// ========================================\r\n// VOICE ACTIVITY DETECTION\r\n// ========================================\r\n\r\ninterface VadParams {\r\n  audioChunk: string; // base64\r\n  sensitivity?: number;\r\n}\r\n\r\ninterface VadResult {\r\n  isSpeaking: boolean;\r\n  speechStart?: number;\r\n  speechEnd?: number;\r\n  confidence: number;\r\n}\r\n\r\nexport async function detectVoiceActivity(\r\n  params: VadParams,\r\n  context: ConversationContext\r\n): Promise<VadResult> {\r\n  // In production, use WebRTC VAD or Azure\r\n  const sensitivity = params.sensitivity || 0.5;\r\n\r\n  // Mock response\r\n  return {\r\n    isSpeaking: Math.random() > sensitivity,\r\n    confidence: 0.85 + Math.random() * 0.15\r\n  };\r\n}\r\n\r\n// ========================================\r\n// REAL-TIME AUDIO STREAMING\r\n// ========================================\r\n\r\nexport interface RealtimeStreamConfig {\r\n  callId: string;\r\n  sttLanguage: string;\r\n  ttsVoice: string;\r\n  interimResults: boolean;\r\n  vadSensitivity: number;\r\n  silenceTimeout: number;\r\n}\r\n\r\nexport interface RealtimeCallbacks {\r\n  onSpeechRecognized: (text: string, isFinal: boolean) => void;\r\n  onAudioGenerated: (audio: ArrayBuffer) => void;\r\n  onError: (error: Error) => void;\r\n  onCallEnded: (reason: string) => void;\r\n}\r\n\r\nexport function createRealtimeAudioStream(\r\n  config: RealtimeStreamConfig,\r\n  callbacks: RealtimeCallbacks\r\n): {\r\n  start: () => Promise<void>;\r\n  stop: () => Promise<void>;\r\n  sendAudio: (chunk: ArrayBuffer) => void;\r\n  sendResponse: (text: string) => Promise<void>;\r\n} {\r\n  let isRunning = false;\r\n\r\n  return {\r\n    async start() {\r\n      console.log(`[VoiceHandler] Starting realtime audio stream for call ${config.callId}`);\r\n      isRunning = true;\r\n      \r\n      // In production:\r\n      // 1. Open WebSocket connection to Azure Communication Services\r\n      // 2. Configure Speech SDK for continuous recognition\r\n      // 3. Set up audio streaming pipeline\r\n    },\r\n\r\n    async stop() {\r\n      console.log(`[VoiceHandler] Stopping realtime audio stream`);\r\n      isRunning = false;\r\n      callbacks.onCallEnded('stream_stopped');\r\n    },\r\n\r\n    sendAudio(chunk: ArrayBuffer) {\r\n      if (!isRunning) return;\r\n      // Send audio chunk to Speech SDK for recognition\r\n    },\r\n\r\n    async sendResponse(text: string) {\r\n      if (!isRunning) return;\r\n      \r\n      // Convert text to speech and play to caller\r\n      const ttsResult = await textToSpeech(\r\n        { text, voice: config.ttsVoice },\r\n        {} as ConversationContext\r\n      );\r\n      \r\n      // In production, stream audio to call\r\n      console.log(`[VoiceHandler] Playing TTS response: ${text.substring(0, 50)}...`);\r\n    }\r\n  };\r\n}\r\n\r\n// Export all handlers\r\nexport const voiceHandlers = {\r\n  initiateCall,\r\n  transferToHuman,\r\n  sendCallSummarySms,\r\n  textToSpeech,\r\n  speechToText,\r\n  detectVoiceActivity,\r\n  createRealtimeAudioStream\r\n};\r\n","/**\r\n * Monitoring Handlers\r\n * Tool handlers for price monitoring and tracking\r\n * Based on: hotel-price-monitor scraping capabilities\r\n */\r\n\r\nimport type { ConversationContext } from '../types';\r\n\r\n// ========================================\r\n// TRACK HOTEL PRICE\r\n// ========================================\r\n\r\ninterface TrackHotelPriceParams {\r\n  hotelUrl: string;\r\n  checkIn: string;\r\n  checkOut: string;\r\n  targetPrice?: number;\r\n  notifyEmail?: string;\r\n}\r\n\r\ninterface TrackingResult {\r\n  success: boolean;\r\n  trackingId: string;\r\n  hotelName: string;\r\n  currentPrice: number;\r\n  currency: string;\r\n  targetPrice?: number;\r\n  checkInterval: string;\r\n  notificationSettings: {\r\n    email?: string;\r\n    priceDropThreshold: number;\r\n  };\r\n  nextCheck: Date;\r\n}\r\n\r\nexport async function trackHotelPrice(\r\n  params: TrackHotelPriceParams,\r\n  context: ConversationContext\r\n): Promise<TrackingResult> {\r\n  console.log(`[MonitoringHandler] Starting price tracking for:`, params.hotelUrl);\r\n\r\n  try {\r\n    // Validate URL (Booking.com format)\r\n    if (!params.hotelUrl.includes('booking.com')) {\r\n      throw new Error('Currently only Booking.com URLs are supported');\r\n    }\r\n\r\n    // Extract hotel info from URL (in production, use scraper)\r\n    const hotelName = extractHotelNameFromUrl(params.hotelUrl);\r\n\r\n    const trackingId = `track-${Date.now()}-${Math.random().toString(36).substr(2, 8)}`;\r\n\r\n    // In production, would initialize scraping job:\r\n    // const scraper = new BookingComScraper();\r\n    // await scraper.initializeTracking({\r\n    //   url: params.hotelUrl,\r\n    //   checkIn: params.checkIn,\r\n    //   checkOut: params.checkOut,\r\n    //   trackingId\r\n    // });\r\n\r\n    // Mock current price\r\n    const currentPrice = Math.floor(Math.random() * 300) + 100;\r\n\r\n    const result: TrackingResult = {\r\n      success: true,\r\n      trackingId,\r\n      hotelName,\r\n      currentPrice,\r\n      currency: 'USD',\r\n      targetPrice: params.targetPrice,\r\n      checkInterval: 'Every 6 hours',\r\n      notificationSettings: {\r\n        email: params.notifyEmail,\r\n        priceDropThreshold: params.targetPrice ? 0 : 10 // Alert on any drop below target, or 10% otherwise\r\n      },\r\n      nextCheck: new Date(Date.now() + 6 * 60 * 60 * 1000)\r\n    };\r\n\r\n    // Store tracking in context\r\n    if (context) {\r\n      context.metadata = {\r\n        ...context.metadata,\r\n        priceTracking: [\r\n          ...(context.metadata?.priceTracking || []),\r\n          {\r\n            trackingId,\r\n            hotelUrl: params.hotelUrl,\r\n            hotelName,\r\n            startedAt: new Date()\r\n          }\r\n        ]\r\n      };\r\n    }\r\n\r\n    return result;\r\n  } catch (error: any) {\r\n    console.error(`[MonitoringHandler] Track price error:`, error);\r\n    throw new Error(`Failed to start price tracking: ${error.message}`);\r\n  }\r\n}\r\n\r\nfunction extractHotelNameFromUrl(url: string): string {\r\n  try {\r\n    const match = url.match(/hotel\\/([^/]+)/);\r\n    if (match) {\r\n      return match[1]\r\n        .replace(/-/g, ' ')\r\n        .replace(/\\b\\w/g, l => l.toUpperCase());\r\n    }\r\n  } catch {}\r\n  return 'Unknown Hotel';\r\n}\r\n\r\n// ========================================\r\n// GET PRICE HISTORY\r\n// ========================================\r\n\r\ninterface GetPriceHistoryParams {\r\n  hotelId: string;\r\n  dateFrom: string;\r\n  dateTo: string;\r\n}\r\n\r\ninterface PriceHistoryEntry {\r\n  date: string;\r\n  price: number;\r\n  currency: string;\r\n  availability: 'available' | 'limited' | 'sold_out';\r\n  source: string;\r\n}\r\n\r\ninterface PriceHistoryResult {\r\n  hotelId: string;\r\n  hotelName: string;\r\n  dateRange: {\r\n    from: string;\r\n    to: string;\r\n  };\r\n  history: PriceHistoryEntry[];\r\n  statistics: {\r\n    minPrice: number;\r\n    maxPrice: number;\r\n    avgPrice: number;\r\n    currentPrice: number;\r\n    priceChange: number;\r\n    priceChangePercent: number;\r\n  };\r\n}\r\n\r\nexport async function getPriceHistory(\r\n  params: GetPriceHistoryParams,\r\n  context: ConversationContext\r\n): Promise<PriceHistoryResult> {\r\n  console.log(`[MonitoringHandler] Getting price history for hotel:`, params.hotelId);\r\n\r\n  try {\r\n    // Generate mock historical data\r\n    const startDate = new Date(params.dateFrom);\r\n    const endDate = new Date(params.dateTo);\r\n    const days = Math.ceil((endDate.getTime() - startDate.getTime()) / (1000 * 60 * 60 * 24));\r\n\r\n    const history: PriceHistoryEntry[] = [];\r\n    let basePrice = 250;\r\n\r\n    for (let i = 0; i <= days; i++) {\r\n      const date = new Date(startDate);\r\n      date.setDate(date.getDate() + i);\r\n\r\n      // Simulate price fluctuations\r\n      const fluctuation = (Math.random() - 0.5) * 40;\r\n      const weekendMultiplier = (date.getDay() === 5 || date.getDay() === 6) ? 1.2 : 1;\r\n      const price = Math.round((basePrice + fluctuation) * weekendMultiplier);\r\n\r\n      history.push({\r\n        date: date.toISOString().split('T')[0],\r\n        price,\r\n        currency: 'USD',\r\n        availability: price < 300 ? 'available' : price < 350 ? 'limited' : 'sold_out',\r\n        source: 'booking.com'\r\n      });\r\n    }\r\n\r\n    const prices = history.map(h => h.price);\r\n    const minPrice = Math.min(...prices);\r\n    const maxPrice = Math.max(...prices);\r\n    const avgPrice = Math.round(prices.reduce((a, b) => a + b, 0) / prices.length);\r\n    const currentPrice = prices[prices.length - 1];\r\n    const firstPrice = prices[0];\r\n\r\n    return {\r\n      hotelId: params.hotelId,\r\n      hotelName: 'Sample Hotel Dubai',\r\n      dateRange: {\r\n        from: params.dateFrom,\r\n        to: params.dateTo\r\n      },\r\n      history,\r\n      statistics: {\r\n        minPrice,\r\n        maxPrice,\r\n        avgPrice,\r\n        currentPrice,\r\n        priceChange: currentPrice - firstPrice,\r\n        priceChangePercent: Math.round(((currentPrice - firstPrice) / firstPrice) * 100)\r\n      }\r\n    };\r\n  } catch (error: any) {\r\n    console.error(`[MonitoringHandler] Price history error:`, error);\r\n    throw new Error(`Failed to get price history: ${error.message}`);\r\n  }\r\n}\r\n\r\n// ========================================\r\n// ANALYZE PRICE TRENDS\r\n// ========================================\r\n\r\ninterface AnalyzePriceTrendsParams {\r\n  hotelId: string;\r\n  travelDates: {\r\n    from: string;\r\n    to: string;\r\n  };\r\n}\r\n\r\ninterface TrendAnalysisResult {\r\n  hotelId: string;\r\n  hotelName: string;\r\n  travelDates: {\r\n    from: string;\r\n    to: string;\r\n  };\r\n  currentTrend: 'rising' | 'falling' | 'stable';\r\n  trendStrength: number; // 0-100\r\n  prediction: {\r\n    direction: 'up' | 'down' | 'stable';\r\n    confidence: number;\r\n    expectedChange: number;\r\n    optimalBookingWindow: {\r\n      from: string;\r\n      to: string;\r\n    };\r\n  };\r\n  insights: string[];\r\n  recommendations: string[];\r\n  competitorComparison?: {\r\n    hotelName: string;\r\n    priceDifference: number;\r\n    rating: number;\r\n  }[];\r\n}\r\n\r\nexport async function analyzePriceTrends(\r\n  params: AnalyzePriceTrendsParams,\r\n  context: ConversationContext\r\n): Promise<TrendAnalysisResult> {\r\n  console.log(`[MonitoringHandler] Analyzing price trends for:`, params.hotelId);\r\n\r\n  try {\r\n    // Calculate days until travel\r\n    const travelDate = new Date(params.travelDates.from);\r\n    const daysUntilTravel = Math.ceil((travelDate.getTime() - Date.now()) / (1000 * 60 * 60 * 24));\r\n\r\n    // Determine trend based on various factors (mocked)\r\n    const trends = ['rising', 'falling', 'stable'] as const;\r\n    const currentTrend = trends[Math.floor(Math.random() * 3)];\r\n    const trendStrength = Math.floor(Math.random() * 60) + 20;\r\n\r\n    // Generate insights based on analysis\r\n    const insights: string[] = [];\r\n    const recommendations: string[] = [];\r\n\r\n    if (currentTrend === 'falling') {\r\n      insights.push('Prices have dropped 12% over the past 2 weeks');\r\n      insights.push('Historically, prices for these dates bottom out 3 weeks before check-in');\r\n      recommendations.push('Wait 1-2 more weeks before booking to catch the lowest price');\r\n    } else if (currentTrend === 'rising') {\r\n      insights.push('Prices have increased 8% in the last week');\r\n      insights.push('There\\'s an event in the area driving up demand');\r\n      recommendations.push('Book soon to lock in current prices');\r\n      recommendations.push('Consider flexible dates 1 week earlier for better rates');\r\n    } else {\r\n      insights.push('Prices have remained stable for the past month');\r\n      insights.push('Current price is close to the 90-day average');\r\n      recommendations.push('This is a good time to book - prices are fair');\r\n    }\r\n\r\n    // Add weekend insight\r\n    const dayOfWeek = travelDate.getDay();\r\n    if (dayOfWeek === 5 || dayOfWeek === 6) {\r\n      insights.push('Weekend check-in typically costs 15-20% more');\r\n      recommendations.push('Consider Thursday or Sunday check-in for savings');\r\n    }\r\n\r\n    // Add seasonality insight\r\n    const month = travelDate.getMonth();\r\n    if (month >= 10 || month <= 2) {\r\n      insights.push('This is high season in Dubai - expect premium pricing');\r\n    }\r\n\r\n    return {\r\n      hotelId: params.hotelId,\r\n      hotelName: 'Sample Hotel Dubai',\r\n      travelDates: params.travelDates,\r\n      currentTrend,\r\n      trendStrength,\r\n      prediction: {\r\n        direction: currentTrend === 'rising' ? 'up' : currentTrend === 'falling' ? 'down' : 'stable',\r\n        confidence: trendStrength + 20,\r\n        expectedChange: currentTrend === 'rising' ? 8 : currentTrend === 'falling' ? -10 : 0,\r\n        optimalBookingWindow: {\r\n          from: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\r\n          to: new Date(Date.now() + 14 * 24 * 60 * 60 * 1000).toISOString().split('T')[0]\r\n        }\r\n      },\r\n      insights,\r\n      recommendations,\r\n      competitorComparison: [\r\n        { hotelName: 'Similar Hotel A', priceDifference: -25, rating: 8.7 },\r\n        { hotelName: 'Similar Hotel B', priceDifference: +40, rating: 9.1 },\r\n        { hotelName: 'Similar Hotel C', priceDifference: -10, rating: 8.5 }\r\n      ]\r\n    };\r\n  } catch (error: any) {\r\n    console.error(`[MonitoringHandler] Trend analysis error:`, error);\r\n    throw new Error(`Failed to analyze price trends: ${error.message}`);\r\n  }\r\n}\r\n\r\n// ========================================\r\n// SCRAPER UTILITIES (Based on hotel-price-monitor)\r\n// ========================================\r\n\r\nexport interface ScraperConfig {\r\n  headless?: boolean;\r\n  proxy?: string;\r\n  userAgent?: string;\r\n  timeout?: number;\r\n}\r\n\r\nexport interface ScrapedPrice {\r\n  hotelName: string;\r\n  roomType: string;\r\n  price: number;\r\n  currency: string;\r\n  originalPrice?: number;\r\n  discount?: number;\r\n  cancellationPolicy: string;\r\n  boardType: string;\r\n  scrapedAt: Date;\r\n}\r\n\r\n/**\r\n * Placeholder for Booking.com scraper\r\n * In production, this would use Playwright to scrape prices\r\n */\r\nexport async function scrapeBookingComPrices(\r\n  url: string,\r\n  checkIn: string,\r\n  checkOut: string,\r\n  config?: ScraperConfig\r\n): Promise<ScrapedPrice[]> {\r\n  console.log(`[MonitoringHandler] Scraping prices from: ${url}`);\r\n\r\n  // In production:\r\n  // const browser = await chromium.launch({ headless: config?.headless ?? true });\r\n  // const page = await browser.newPage();\r\n  // await page.goto(url);\r\n  // ... scraping logic\r\n\r\n  // Mock response\r\n  return [\r\n    {\r\n      hotelName: extractHotelNameFromUrl(url),\r\n      roomType: 'Deluxe Room',\r\n      price: 289,\r\n      currency: 'USD',\r\n      originalPrice: 340,\r\n      discount: 15,\r\n      cancellationPolicy: 'Free cancellation',\r\n      boardType: 'Breakfast included',\r\n      scrapedAt: new Date()\r\n    },\r\n    {\r\n      hotelName: extractHotelNameFromUrl(url),\r\n      roomType: 'Suite',\r\n      price: 489,\r\n      currency: 'USD',\r\n      cancellationPolicy: 'Non-refundable',\r\n      boardType: 'Room only',\r\n      scrapedAt: new Date()\r\n    }\r\n  ];\r\n}\r\n\r\n// Export all handlers\r\nexport const monitoringHandlers = {\r\n  trackHotelPrice,\r\n  getPriceHistory,\r\n  analyzePriceTrends,\r\n  scrapeBookingComPrices\r\n};\r\n","/**\r\n * Booking Handlers\r\n * Tool handlers for hotel search, prebook, and booking operations\r\n * Based on: ai-travel-agent-platform Medici API integration\r\n */\r\n\r\nimport type { ConversationContext } from '../types';\r\n\r\nconst MEDICI_API_URL = process.env.MEDICI_API_URL || 'https://api.medicihotels.com';\r\nconst MEDICI_API_KEY = process.env.MEDICI_API_KEY || '';\r\n\r\n// ========================================\r\n// HOTEL SEARCH\r\n// ========================================\r\n\r\ninterface SearchHotelsParams {\r\n  destination: string;\r\n  checkIn: string;\r\n  checkOut: string;\r\n  adults: number;\r\n  children?: number[];\r\n  stars?: number[];\r\n  maxPrice?: number;\r\n  amenities?: string[];\r\n}\r\n\r\ninterface HotelSearchResult {\r\n  hotelId: string;\r\n  name: string;\r\n  stars: number;\r\n  address: string;\r\n  imageUrl: string;\r\n  rating: number;\r\n  reviewCount: number;\r\n  rooms: RoomOption[];\r\n  amenities: string[];\r\n  distance?: string;\r\n}\r\n\r\ninterface RoomOption {\r\n  roomCode: string;\r\n  roomName: string;\r\n  boardType: string;\r\n  price: number;\r\n  originalPrice?: number;\r\n  currency: string;\r\n  cancellationPolicy: string;\r\n  maxOccupancy: number;\r\n  available: number;\r\n}\r\n\r\nexport async function searchHotels(\r\n  params: SearchHotelsParams,\r\n  context: ConversationContext\r\n): Promise<{ hotels: HotelSearchResult[]; searchId: string; totalResults: number }> {\r\n  console.log(`[BookingHandler] Searching hotels:`, params);\r\n\r\n  try {\r\n    // Build search request for Medici API\r\n    const searchRequest = {\r\n      destination: params.destination,\r\n      checkIn: params.checkIn,\r\n      checkOut: params.checkOut,\r\n      occupancies: [{\r\n        adults: params.adults,\r\n        children: params.children?.map(age => ({ age })) || []\r\n      }],\r\n      filters: {\r\n        stars: params.stars,\r\n        maxPrice: params.maxPrice,\r\n        amenities: params.amenities\r\n      }\r\n    };\r\n\r\n    // In production, call actual Medici API\r\n    // const response = await fetch(`${MEDICI_API_URL}/search`, {\r\n    //   method: 'POST',\r\n    //   headers: {\r\n    //     'Content-Type': 'application/json',\r\n    //     'Authorization': `Bearer ${MEDICI_API_KEY}`\r\n    //   },\r\n    //   body: JSON.stringify(searchRequest)\r\n    // });\r\n\r\n    // For now, return mock data\r\n    const mockResults: HotelSearchResult[] = [\r\n      {\r\n        hotelId: 'htl-dubai-001',\r\n        name: 'Burj Al Arab Jumeirah',\r\n        stars: 5,\r\n        address: 'Jumeirah Beach Road, Dubai, UAE',\r\n        imageUrl: '/hotels/burj-al-arab.jpg',\r\n        rating: 9.4,\r\n        reviewCount: 12543,\r\n        amenities: ['Spa', 'Pool', 'WiFi', 'Beach Access', 'Restaurant', 'Butler Service'],\r\n        rooms: [\r\n          {\r\n            roomCode: 'room-001',\r\n            roomName: 'Deluxe Suite',\r\n            boardType: 'Breakfast Included',\r\n            price: 2500,\r\n            originalPrice: 2800,\r\n            currency: 'USD',\r\n            cancellationPolicy: 'Free cancellation until 24h before',\r\n            maxOccupancy: 2,\r\n            available: 3\r\n          },\r\n          {\r\n            roomCode: 'room-002',\r\n            roomName: 'Panoramic Suite',\r\n            boardType: 'Half Board',\r\n            price: 3800,\r\n            currency: 'USD',\r\n            cancellationPolicy: 'Non-refundable',\r\n            maxOccupancy: 3,\r\n            available: 1\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        hotelId: 'htl-dubai-002',\r\n        name: 'Atlantis The Palm',\r\n        stars: 5,\r\n        address: 'Crescent Road, The Palm, Dubai, UAE',\r\n        imageUrl: '/hotels/atlantis.jpg',\r\n        rating: 8.9,\r\n        reviewCount: 28912,\r\n        amenities: ['Waterpark', 'Pool', 'WiFi', 'Beach', 'Aquarium', 'Kids Club'],\r\n        rooms: [\r\n          {\r\n            roomCode: 'room-003',\r\n            roomName: 'Palm Beach Room',\r\n            boardType: 'Room Only',\r\n            price: 450,\r\n            originalPrice: 520,\r\n            currency: 'USD',\r\n            cancellationPolicy: 'Free cancellation until 48h before',\r\n            maxOccupancy: 2,\r\n            available: 8\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        hotelId: 'htl-dubai-003',\r\n        name: 'Four Seasons Resort Dubai',\r\n        stars: 5,\r\n        address: 'Jumeirah Beach, Dubai, UAE',\r\n        imageUrl: '/hotels/four-seasons.jpg',\r\n        rating: 9.2,\r\n        reviewCount: 8234,\r\n        amenities: ['Spa', 'Pool', 'WiFi', 'Beach', 'Golf', 'Tennis'],\r\n        rooms: [\r\n          {\r\n            roomCode: 'room-004',\r\n            roomName: 'Premier Room',\r\n            boardType: 'Breakfast Included',\r\n            price: 680,\r\n            currency: 'USD',\r\n            cancellationPolicy: 'Free cancellation until 72h before',\r\n            maxOccupancy: 2,\r\n            available: 5\r\n          }\r\n        ]\r\n      }\r\n    ];\r\n\r\n    // Store search context\r\n    if (context) {\r\n      context.bookingData = {\r\n        ...context.bookingData,\r\n        lastSearch: {\r\n          params,\r\n          timestamp: new Date(),\r\n          results: mockResults.map(h => ({ hotelId: h.hotelId, name: h.name }))\r\n        }\r\n      };\r\n    }\r\n\r\n    return {\r\n      hotels: mockResults,\r\n      searchId: `search-${Date.now()}`,\r\n      totalResults: mockResults.length\r\n    };\r\n  } catch (error: any) {\r\n    console.error(`[BookingHandler] Search error:`, error);\r\n    throw new Error(`Hotel search failed: ${error.message}`);\r\n  }\r\n}\r\n\r\n// ========================================\r\n// PREBOOK ROOM\r\n// ========================================\r\n\r\ninterface PrebookParams {\r\n  roomCode: string;\r\n  hotelId: string;\r\n  checkIn: string;\r\n  checkOut: string;\r\n  guests: {\r\n    adults: number;\r\n    children?: { age: number }[];\r\n  };\r\n}\r\n\r\ninterface PrebookResult {\r\n  success: boolean;\r\n  token: string;\r\n  expiresAt: Date;\r\n  pricing: {\r\n    roomRate: number;\r\n    taxes: number;\r\n    fees: number;\r\n    total: number;\r\n    currency: string;\r\n  };\r\n  cancellationPolicy: {\r\n    freeCancellationUntil?: Date;\r\n    penalties: { from: Date; amount: number }[];\r\n  };\r\n  hotelDetails: {\r\n    hotelId: string;\r\n    name: string;\r\n    roomName: string;\r\n    checkIn: string;\r\n    checkOut: string;\r\n    nights: number;\r\n  };\r\n}\r\n\r\nexport async function prebookRoom(\r\n  params: PrebookParams,\r\n  context: ConversationContext\r\n): Promise<PrebookResult> {\r\n  console.log(`[BookingHandler] Pre-booking room:`, params);\r\n\r\n  try {\r\n    // Calculate nights\r\n    const checkIn = new Date(params.checkIn);\r\n    const checkOut = new Date(params.checkOut);\r\n    const nights = Math.ceil((checkOut.getTime() - checkIn.getTime()) / (1000 * 60 * 60 * 24));\r\n\r\n    // Mock prebook response\r\n    const result: PrebookResult = {\r\n      success: true,\r\n      token: `prebook-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n      expiresAt: new Date(Date.now() + 30 * 60 * 1000), // 30 minutes\r\n      pricing: {\r\n        roomRate: 680 * nights,\r\n        taxes: 68 * nights,\r\n        fees: 25,\r\n        total: (680 + 68) * nights + 25,\r\n        currency: 'USD'\r\n      },\r\n      cancellationPolicy: {\r\n        freeCancellationUntil: new Date(checkIn.getTime() - 72 * 60 * 60 * 1000),\r\n        penalties: [\r\n          { from: new Date(checkIn.getTime() - 72 * 60 * 60 * 1000), amount: 680 },\r\n          { from: new Date(checkIn.getTime() - 24 * 60 * 60 * 1000), amount: 680 * nights }\r\n        ]\r\n      },\r\n      hotelDetails: {\r\n        hotelId: params.hotelId,\r\n        name: 'Four Seasons Resort Dubai',\r\n        roomName: 'Premier Room',\r\n        checkIn: params.checkIn,\r\n        checkOut: params.checkOut,\r\n        nights\r\n      }\r\n    };\r\n\r\n    // Store prebook context\r\n    if (context) {\r\n      context.bookingData = {\r\n        ...context.bookingData,\r\n        prebook: {\r\n          token: result.token,\r\n          expiresAt: result.expiresAt,\r\n          hotelId: params.hotelId,\r\n          roomCode: params.roomCode,\r\n          pricing: result.pricing\r\n        }\r\n      };\r\n    }\r\n\r\n    return result;\r\n  } catch (error: any) {\r\n    console.error(`[BookingHandler] Prebook error:`, error);\r\n    throw new Error(`Pre-booking failed: ${error.message}`);\r\n  }\r\n}\r\n\r\n// ========================================\r\n// BOOK ROOM\r\n// ========================================\r\n\r\ninterface BookRoomParams {\r\n  token: string;\r\n  roomCode: string;\r\n  customer: {\r\n    firstName: string;\r\n    lastName: string;\r\n    email: string;\r\n    phone: string;\r\n    address?: {\r\n      street: string;\r\n      city: string;\r\n      country: string;\r\n      postalCode: string;\r\n    };\r\n  };\r\n  guests: Array<{\r\n    firstName: string;\r\n    lastName: string;\r\n    isLeadGuest?: boolean;\r\n  }>;\r\n  specialRequests?: string;\r\n  paymentMethod?: string;\r\n}\r\n\r\ninterface BookingResult {\r\n  success: boolean;\r\n  bookingId: string;\r\n  confirmationNumber: string;\r\n  status: 'confirmed' | 'pending' | 'failed';\r\n  hotelConfirmation?: string;\r\n  totalPaid: number;\r\n  currency: string;\r\n  bookingDetails: {\r\n    hotelName: string;\r\n    roomName: string;\r\n    checkIn: string;\r\n    checkOut: string;\r\n    guests: string[];\r\n    specialRequests?: string;\r\n  };\r\n  paymentDetails: {\r\n    method: string;\r\n    last4?: string;\r\n    transactionId: string;\r\n  };\r\n  cancellationPolicy: string;\r\n}\r\n\r\nexport async function bookRoom(\r\n  params: BookRoomParams,\r\n  context: ConversationContext\r\n): Promise<BookingResult> {\r\n  console.log(`[BookingHandler] Completing booking:`, params);\r\n\r\n  try {\r\n    // Validate prebook token\r\n    if (!context?.bookingData?.prebook?.token || context.bookingData.prebook.token !== params.token) {\r\n      throw new Error('Invalid or expired prebook token');\r\n    }\r\n\r\n    // Check token expiration\r\n    if (new Date() > new Date(context.bookingData.prebook.expiresAt)) {\r\n      throw new Error('Prebook token has expired. Please search again.');\r\n    }\r\n\r\n    // Generate booking confirmation\r\n    const bookingId = `BK-${Date.now()}-${Math.random().toString(36).substr(2, 6).toUpperCase()}`;\r\n    const confirmationNumber = `CNF-${Math.random().toString(36).substr(2, 8).toUpperCase()}`;\r\n\r\n    const result: BookingResult = {\r\n      success: true,\r\n      bookingId,\r\n      confirmationNumber,\r\n      status: 'confirmed',\r\n      hotelConfirmation: `HC-${Math.random().toString(36).substr(2, 6).toUpperCase()}`,\r\n      totalPaid: context.bookingData.prebook.pricing.total,\r\n      currency: context.bookingData.prebook.pricing.currency,\r\n      bookingDetails: {\r\n        hotelName: 'Four Seasons Resort Dubai',\r\n        roomName: 'Premier Room',\r\n        checkIn: context.bookingData.prebook.checkIn || '2024-03-15',\r\n        checkOut: context.bookingData.prebook.checkOut || '2024-03-18',\r\n        guests: params.guests.map(g => `${g.firstName} ${g.lastName}`),\r\n        specialRequests: params.specialRequests\r\n      },\r\n      paymentDetails: {\r\n        method: params.paymentMethod || 'card',\r\n        last4: '4242',\r\n        transactionId: `txn-${Date.now()}`\r\n      },\r\n      cancellationPolicy: 'Free cancellation until 72 hours before check-in'\r\n    };\r\n\r\n    // Update context with booking result\r\n    if (context) {\r\n      context.bookingData = {\r\n        ...context.bookingData,\r\n        confirmedBooking: {\r\n          bookingId,\r\n          confirmationNumber,\r\n          status: 'confirmed',\r\n          bookedAt: new Date()\r\n        }\r\n      };\r\n    }\r\n\r\n    return result;\r\n  } catch (error: any) {\r\n    console.error(`[BookingHandler] Booking error:`, error);\r\n    throw new Error(`Booking failed: ${error.message}`);\r\n  }\r\n}\r\n\r\n// ========================================\r\n// CANCEL BOOKING\r\n// ========================================\r\n\r\ninterface CancelBookingParams {\r\n  bookingId: string;\r\n  reason?: string;\r\n  force?: boolean;\r\n}\r\n\r\ninterface CancellationResult {\r\n  success: boolean;\r\n  cancellationId: string;\r\n  refundAmount: number;\r\n  refundCurrency: string;\r\n  penaltyApplied: number;\r\n  refundMethod: string;\r\n  refundEta: string;\r\n  message: string;\r\n}\r\n\r\nexport async function cancelBooking(\r\n  params: CancelBookingParams,\r\n  context: ConversationContext\r\n): Promise<CancellationResult> {\r\n  console.log(`[BookingHandler] Cancelling booking:`, params);\r\n\r\n  try {\r\n    // Mock cancellation - check if within free cancellation period\r\n    const isWithinFreePeriod = Math.random() > 0.3; // 70% chance it's within free period\r\n\r\n    const originalAmount = 2244; // Example amount\r\n    const penaltyAmount = isWithinFreePeriod ? 0 : 680;\r\n    const refundAmount = originalAmount - penaltyAmount;\r\n\r\n    const result: CancellationResult = {\r\n      success: true,\r\n      cancellationId: `CAN-${Date.now()}-${Math.random().toString(36).substr(2, 6).toUpperCase()}`,\r\n      refundAmount,\r\n      refundCurrency: 'USD',\r\n      penaltyApplied: penaltyAmount,\r\n      refundMethod: 'Original payment method',\r\n      refundEta: '5-7 business days',\r\n      message: isWithinFreePeriod \r\n        ? 'Your booking has been cancelled with a full refund.'\r\n        : `Your booking has been cancelled. A cancellation fee of $${penaltyAmount} was applied.`\r\n    };\r\n\r\n    return result;\r\n  } catch (error: any) {\r\n    console.error(`[BookingHandler] Cancellation error:`, error);\r\n    throw new Error(`Cancellation failed: ${error.message}`);\r\n  }\r\n}\r\n\r\n// ========================================\r\n// GET CANCELLATION POLICY\r\n// ========================================\r\n\r\ninterface GetCancellationPolicyParams {\r\n  bookingId: string;\r\n}\r\n\r\ninterface CancellationPolicyResult {\r\n  bookingId: string;\r\n  hotelName: string;\r\n  checkIn: string;\r\n  currentStatus: string;\r\n  policy: {\r\n    freeCancellationUntil?: string;\r\n    isWithinFreePeriod: boolean;\r\n    penalties: Array<{\r\n      fromDate: string;\r\n      amount: number;\r\n      currency: string;\r\n      description: string;\r\n    }>;\r\n  };\r\n  recommendation: string;\r\n}\r\n\r\nexport async function getCancellationPolicy(\r\n  params: GetCancellationPolicyParams,\r\n  context: ConversationContext\r\n): Promise<CancellationPolicyResult> {\r\n  console.log(`[BookingHandler] Getting cancellation policy:`, params);\r\n\r\n  const checkIn = new Date('2024-03-15');\r\n  const freeCancellationDate = new Date(checkIn.getTime() - 72 * 60 * 60 * 1000);\r\n  const now = new Date();\r\n  const isWithinFreePeriod = now < freeCancellationDate;\r\n\r\n  return {\r\n    bookingId: params.bookingId,\r\n    hotelName: 'Four Seasons Resort Dubai',\r\n    checkIn: '2024-03-15',\r\n    currentStatus: 'confirmed',\r\n    policy: {\r\n      freeCancellationUntil: freeCancellationDate.toISOString(),\r\n      isWithinFreePeriod,\r\n      penalties: [\r\n        {\r\n          fromDate: freeCancellationDate.toISOString(),\r\n          amount: 680,\r\n          currency: 'USD',\r\n          description: 'First night penalty (72-24 hours before check-in)'\r\n        },\r\n        {\r\n          fromDate: new Date(checkIn.getTime() - 24 * 60 * 60 * 1000).toISOString(),\r\n          amount: 2244,\r\n          currency: 'USD',\r\n          description: 'Full booking amount (less than 24 hours)'\r\n        }\r\n      ]\r\n    },\r\n    recommendation: isWithinFreePeriod\r\n      ? 'You can cancel now for a full refund!'\r\n      : 'Cancellation will incur a penalty. Consider rescheduling instead.'\r\n  };\r\n}\r\n\r\n// Export all handlers\r\nexport const bookingHandlers = {\r\n  searchHotels,\r\n  prebookRoom,\r\n  bookRoom,\r\n  cancelBooking,\r\n  getCancellationPolicy\r\n};\r\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","vendored","React"],"mappings":"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","ignoreList":[0,1,2]}