module.exports=[46925,e=>{"use strict";var t=e.i(747909),a=e.i(174017),r=e.i(996250),i=e.i(759756),s=e.i(561916),o=e.i(114444),n=e.i(837092),l=e.i(869741),d=e.i(316795),c=e.i(487718),p=e.i(995169),u=e.i(47587),v=e.i(666012),h=e.i(570101),g=e.i(626937),f=e.i(10372),m=e.i(193695);e.i(52474);var x=e.i(257297),b=e.i(89171),y=e.i(711897);async function R(e){var t,a;let r,i,s,o=e.nextUrl.searchParams,n=o.get("severity"),l=o.get("type"),d=o.get("resolved"),c=parseInt(o.get("limit")||"100"),p=o.get("format")||"json",u={limit:c};n&&(u.severity=n),l&&(u.type=l),null!==d&&(u.resolved="true"===d);let v=y.alertManager.getAlerts(u),h=y.alertManager.getStats();return"html"===p?new b.NextResponse((t=v,a=h,r={critical:"#dc3545",high:"#fd7e14",medium:"#ffc107",low:"#17a2b8"},i={api_failure:"ğŸŒ",booking_failed:"ğŸ“‹",payment_failed:"ğŸ’³",cancellation_issue:"âŒ",price_mismatch:"ğŸ’°",availability_change:"ğŸ¨",rate_limit:"âš ï¸",timeout:"â±ï¸",authentication:"ğŸ”",data_integrity:"ğŸ”—",business_logic:"âš™ï¸",system_health:"ğŸ’»"},s=t.map(e=>{let t=new Date(e.timestamp).toLocaleString("he-IL"),a=i[e.type]||"ğŸ””",s=r[e.severity];return`
      <div class="alert-card ${e.resolved?"resolved":""}" style="border-right-color: ${s}">
        <div class="alert-header">
          <span class="alert-icon">${a}</span>
          <span class="alert-severity" style="background: ${s}">${e.severity.toUpperCase()}</span>
          <span class="alert-title">${e.title}</span>
          ${e.resolved?'<span class="alert-resolved">âœ“ × ×¤×ª×¨</span>':""}
        </div>
        <div class="alert-body">
          <p class="alert-description">${e.description}</p>
          <div class="alert-meta">
            <span>×¡×•×’: ${e.type}</span>
            <span>××§×•×¨: ${e.source}</span>
            <span>×–××Ÿ: ${t}</span>
          </div>
          ${e.bookingId?`<div class="alert-link">×”×–×× ×”: ${e.bookingId}</div>`:""}
        </div>
        ${!e.resolved?`
          <button class="resolve-btn" onclick="resolveAlert('${e.id}')">×¡××Ÿ ×›× ×¤×ª×¨</button>
        `:""}
      </div>
    `}).join(""),`
<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸš¨ Alerts Dashboard - Booking Engine</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { 
      font-family: 'Segoe UI', Tahoma, sans-serif; 
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: #eee;
      min-height: 100vh;
      padding: 20px;
    }
    h1 { 
      color: #ff6b6b; 
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 15px;
      font-size: 28px;
    }
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-bottom: 25px;
    }
    .stat-card {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
    }
    .stat-value { 
      font-size: 36px; 
      font-weight: bold; 
      color: #00d4ff;
    }
    .stat-value.critical { color: #dc3545; }
    .stat-value.high { color: #fd7e14; }
    .stat-value.medium { color: #ffc107; }
    .stat-label { 
      font-size: 12px; 
      color: #aaa;
      margin-top: 5px;
    }
    .filters {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    .filters select, .filters button {
      padding: 10px 15px;
      border-radius: 8px;
      border: 1px solid #333;
      background: rgba(255,255,255,0.1);
      color: #eee;
      cursor: pointer;
    }
    .filters button.primary {
      background: #ff6b6b;
      border: none;
    }
    .alerts-container {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .alert-card {
      background: rgba(255,255,255,0.05);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      padding: 15px;
      border-right: 4px solid #333;
      transition: all 0.3s ease;
    }
    .alert-card:hover {
      background: rgba(255,255,255,0.1);
      transform: translateX(-5px);
    }
    .alert-card.resolved {
      opacity: 0.6;
    }
    .alert-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 10px;
    }
    .alert-icon { font-size: 24px; }
    .alert-severity {
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 11px;
      font-weight: bold;
      color: #fff;
    }
    .alert-title {
      font-weight: 600;
      font-size: 16px;
      flex: 1;
    }
    .alert-resolved {
      background: #28a745;
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 11px;
    }
    .alert-body {
      padding-right: 36px;
    }
    .alert-description {
      color: #ccc;
      margin-bottom: 10px;
    }
    .alert-meta {
      display: flex;
      gap: 20px;
      font-size: 12px;
      color: #888;
    }
    .alert-link {
      margin-top: 8px;
      font-size: 12px;
      color: #00d4ff;
    }
    .resolve-btn {
      margin-top: 10px;
      padding: 8px 15px;
      background: #28a745;
      border: none;
      border-radius: 6px;
      color: #fff;
      cursor: pointer;
      font-size: 12px;
    }
    .resolve-btn:hover {
      background: #218838;
    }
    .empty-state {
      text-align: center;
      padding: 60px;
      color: #888;
    }
    .empty-state .icon { font-size: 60px; margin-bottom: 20px; }
  </style>
</head>
<body>
  <h1>ğŸš¨ Alerts Dashboard</h1>
  
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-value">${a.total}</div>
      <div class="stat-label">×¡×”"×› ×”×ª×¨××•×ª</div>
    </div>
    <div class="stat-card">
      <div class="stat-value" style="color: #ff6b6b">${a.unresolved}</div>
      <div class="stat-label">×œ× × ×¤×ª×¨×•</div>
    </div>
    <div class="stat-card">
      <div class="stat-value critical">${a.bySeverity.critical||0}</div>
      <div class="stat-label">×§×¨×™×˜×™</div>
    </div>
    <div class="stat-card">
      <div class="stat-value high">${a.bySeverity.high||0}</div>
      <div class="stat-label">×’×‘×•×”</div>
    </div>
    <div class="stat-card">
      <div class="stat-value medium">${a.bySeverity.medium||0}</div>
      <div class="stat-label">×‘×™× ×•× ×™</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">${a.last24h}</div>
      <div class="stat-label">24 ×©×¢×•×ª ××—×¨×•× ×•×ª</div>
    </div>
  </div>

  <div class="filters">
    <select id="severityFilter" onchange="applyFilters()">
      <option value="">×›×œ ×”×¨××•×ª</option>
      <option value="critical">×§×¨×™×˜×™</option>
      <option value="high">×’×‘×•×”</option>
      <option value="medium">×‘×™× ×•× ×™</option>
      <option value="low">× ××•×š</option>
    </select>
    <select id="resolvedFilter" onchange="applyFilters()">
      <option value="">×”×›×œ</option>
      <option value="false">×œ× × ×¤×ª×¨×•</option>
      <option value="true">× ×¤×ª×¨×•</option>
    </select>
    <button onclick="location.reload()">ğŸ”„ ×¨×¢× ×Ÿ</button>
    <button class="primary" onclick="testAlert()">ğŸ§ª ×™×¦×™×¨×ª ×”×ª×¨××ª ×‘×“×™×§×”</button>
  </div>

  <div class="alerts-container">
    ${s||'<div class="empty-state"><div class="icon">âœ…</div><h3>××™×Ÿ ×”×ª×¨××•×ª</h3><p>×”××¢×¨×›×ª ×¤×•×¢×œ×ª ×ª×§×™×Ÿ</p></div>'}
  </div>

  <script>
    function applyFilters() {
      const severity = document.getElementById('severityFilter').value;
      const resolved = document.getElementById('resolvedFilter').value;
      let url = '/api/alerts?format=html';
      if (severity) url += '&severity=' + severity;
      if (resolved) url += '&resolved=' + resolved;
      window.location.href = url;
    }

    async function resolveAlert(alertId) {
      try {
        const response = await fetch('/api/alerts', {
          method: 'PUT',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ alertId, action: 'resolve', resolvedBy: 'dashboard' })
        });
        if (response.ok) {
          location.reload();
        }
      } catch (error) {
        alert('×©×’×™××” ×‘×¡×’×™×¨×ª ×”×”×ª×¨××”');
      }
    }

    async function testAlert() {
      try {
        await fetch('/api/alerts', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            type: 'system_health',
            severity: 'low',
            title: 'Test Alert',
            description: 'This is a test alert from the dashboard'
          })
        });
        location.reload();
      } catch (error) {
        alert('×©×’×™××” ×‘×™×¦×™×¨×ª ×”×ª×¨××”');
      }
    }
  </script>
</body>
</html>
  `),{headers:{"Content-Type":"text/html"}}):b.NextResponse.json({success:!0,stats:h,count:v.length,alerts:v})}async function w(e){try{let{type:t,severity:a,title:r,description:i,metadata:s}=await e.json();if(!t||!a||!r)return b.NextResponse.json({error:"type, severity, and title are required"},{status:400});let o=await (0,y.triggerAlert)(t,a,r,i||"",s);return b.NextResponse.json({success:!0,alert:o})}catch(e){return b.NextResponse.json({error:e.message},{status:500})}}async function E(e){try{let{alertId:t,action:a,resolvedBy:r}=await e.json();if(!t||!a)return b.NextResponse.json({error:"alertId and action are required"},{status:400});if("resolve"===a){let e=y.alertManager.resolveAlert(t,r);return b.NextResponse.json({success:e})}return b.NextResponse.json({error:"Invalid action"},{status:400})}catch(e){return b.NextResponse.json({error:e.message},{status:500})}}e.s(["GET",()=>R,"POST",()=>w,"PUT",()=>E],328915);var C=e.i(328915);let A=new t.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/alerts/route",pathname:"/api/alerts",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/alerts/route.ts",nextConfigOutput:"",userland:C}),{workAsyncStorage:T,workUnitAsyncStorage:k,serverHooks:N}=A;function $(){return(0,r.patchFetch)({workAsyncStorage:T,workUnitAsyncStorage:k})}async function _(e,t,r){A.isDev&&(0,i.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let b="/api/alerts/route";b=b.replace(/\/index$/,"")||"/";let y=await A.prepare(e,t,{srcPage:b,multiZoneDraftMode:!1});if(!y)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:R,params:w,nextConfig:E,parsedUrl:C,isDraftMode:T,prerenderManifest:k,routerServerContext:N,isOnDemandRevalidate:$,revalidateOnlyGenerated:_,resolvedPathname:S,clientReferenceManifest:P,serverActionsManifest:I}=y,O=(0,l.normalizeAppPath)(b),U=!!(k.dynamicRoutes[O]||k.routes[S]),j=async()=>((null==N?void 0:N.render404)?await N.render404(e,t,C,!1):t.end("This page could not be found"),null);if(U&&!T){let e=!!k.routes[S],t=k.dynamicRoutes[O];if(t&&!1===t.fallback&&!e){if(E.experimental.adapterPath)return await j();throw new m.NoFallbackError}}let M=null;!U||A.isDev||T||(M="/index"===(M=S)?"/":M);let D=!0===A.isDev||!U,H=U&&!D;I&&P&&(0,o.setReferenceManifestsSingleton)({page:b,clientReferenceManifest:P,serverActionsManifest:I,serverModuleMap:(0,n.createServerModuleMap)({serverActionsManifest:I})});let q=e.method||"GET",F=(0,s.getTracer)(),z=F.getActiveScopeSpan(),B={params:w,prerenderManifest:k,renderOpts:{experimental:{authInterrupts:!!E.experimental.authInterrupts},cacheComponents:!!E.cacheComponents,supportsDynamicResponse:D,incrementalCache:(0,i.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:E.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,a,r)=>A.onRequestError(e,t,r,N)},sharedContext:{buildId:R}},K=new d.NodeNextRequest(e),L=new d.NodeNextResponse(t),G=c.NextRequestAdapter.fromNodeNextRequest(K,(0,c.signalFromNodeResponse)(t));try{let o=async e=>A.handle(G,B).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let a=F.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=a.get("next.route");if(r){let t=`${q} ${r}`;e.setAttributes({"next.route":r,"http.route":r,"next.span_name":t}),e.updateName(t)}else e.updateName(`${q} ${b}`)}),n=!!(0,i.getRequestMeta)(e,"minimalMode"),l=async i=>{var s,l;let d=async({previousCacheEntry:a})=>{try{if(!n&&$&&_&&!a)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await o(i);e.fetchMetrics=B.renderOpts.fetchMetrics;let l=B.renderOpts.pendingWaitUntil;l&&r.waitUntil&&(r.waitUntil(l),l=void 0);let d=B.renderOpts.collectedTags;if(!U)return await (0,v.sendResponse)(K,L,s,B.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(s.headers);d&&(t[f.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let a=void 0!==B.renderOpts.collectedRevalidate&&!(B.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&B.renderOpts.collectedRevalidate,r=void 0===B.renderOpts.collectedExpire||B.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:B.renderOpts.collectedExpire;return{value:{kind:x.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:a,expire:r}}}}catch(t){throw(null==a?void 0:a.isStale)&&await A.onRequestError(e,t,{routerKind:"App Router",routePath:b,routeType:"route",revalidateReason:(0,u.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:$})},N),t}},c=await A.handleResponse({req:e,nextConfig:E,cacheKey:M,routeKind:a.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:k,isRoutePPREnabled:!1,isOnDemandRevalidate:$,revalidateOnlyGenerated:_,responseGenerator:d,waitUntil:r.waitUntil,isMinimalMode:n});if(!U)return null;if((null==c||null==(s=c.value)?void 0:s.kind)!==x.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(l=c.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});n||t.setHeader("x-nextjs-cache",$?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),T&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,h.fromNodeOutgoingHttpHeaders)(c.value.headers);return n&&U||p.delete(f.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,g.getCacheControlHeader)(c.cacheControl)),await (0,v.sendResponse)(K,L,new Response(c.value.body,{headers:p,status:c.value.status||200})),null};z?await l(z):await F.withPropagatedContext(e.headers,()=>F.trace(p.BaseServerSpan.handleRequest,{spanName:`${q} ${b}`,kind:s.SpanKind.SERVER,attributes:{"http.method":q,"http.target":e.url}},l))}catch(t){if(t instanceof m.NoFallbackError||await A.onRequestError(e,t,{routerKind:"App Router",routePath:O,routeType:"route",revalidateReason:(0,u.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:$})}),U)throw t;return await (0,v.sendResponse)(K,L,new Response(null,{status:500})),null}}e.s(["handler",()=>_,"patchFetch",()=>$,"routeModule",()=>A,"serverHooks",()=>N,"workAsyncStorage",()=>T,"workUnitAsyncStorage",()=>k],46925)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_c5a61061.js.map