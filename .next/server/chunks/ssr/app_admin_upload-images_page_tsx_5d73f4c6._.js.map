{"version":3,"sources":["../../../../app/admin/upload-images/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { createClient } from '@supabase/supabase-js';\n\n// Initialize Supabase client lazily\nconst getSupabaseClient = () => {\n  const url = process.env.NEXT_PUBLIC_SUPABASE_URL;\n  const key = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n  \n  if (!url || !key) {\n    throw new Error('Supabase credentials not configured');\n  }\n  \n  return createClient(url, key);\n};\n\nexport default function UploadImagesPage() {\n  const [hotelId, setHotelId] = useState('scarlet-hotel');\n  const [roomType, setRoomType] = useState('');\n  const [selectedFiles, setSelectedFiles] = useState<File[]>([]);\n  const [uploading, setUploading] = useState(false);\n  const [uploadedUrls, setUploadedUrls] = useState<string[]>([]);\n  const [error, setError] = useState('');\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files) {\n      setSelectedFiles(Array.from(e.target.files));\n    }\n  };\n\n  const handleUpload = async () => {\n    if (selectedFiles.length === 0) {\n      setError('אנא בחר קבצים להעלאה');\n      return;\n    }\n\n    setUploading(true);\n    setError('');\n    const urls: string[] = [];\n\n    try {\n      const supabase = getSupabaseClient();\n      \n      for (const file of selectedFiles) {\n        // Generate unique filename\n      const fileExt = file.name.split('.').pop();\n      const fileName = `${Date.now()}-${Math.random().toString(36).substring(7)}.${fileExt}`;\n      const filePath = `${hotelId}/${roomType || 'general'}/${fileName}`;\n\n      // Upload directly to Supabase Storage\n      const { data, error } = await supabase.storage\n        .from('hotel-assets')\n        .upload(filePath, file, {\n          cacheControl: '3600',\n          upsert: false\n        });\n\n      if (error) {\n        throw new Error(error.message || 'שגיאה בהעלאת קובץ');\n      }\n\n      // Get public URL\n      const { data: { publicUrl } } = supabase.storage\n        .from('hotel-assets')\n        .getPublicUrl(filePath);\n\n      urls.push(publicUrl);\n      }\n\n      setUploadedUrls(urls);\n      setSelectedFiles([]);\n    } catch (err: any) {\n      setError(err.message || 'שגיאה בהעלאת התמונות');\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  return (\n    <div className=\"container mx-auto py-10\">\n      <Card className=\"max-w-2xl mx-auto\">\n        <CardHeader>\n          <CardTitle>העלאת תמונות חדרים</CardTitle>\n          <CardDescription>\n            העלה תמונות של חדרים למלון שיישמרו ב-Supabase Storage\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"hotelId\">מזהה מלון</Label>\n            <Input\n              id=\"hotelId\"\n              value={hotelId}\n              onChange={(e) => setHotelId(e.target.value)}\n              placeholder=\"scarlet-hotel\"\n            />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"roomType\">סוג חדר</Label>\n            <Input\n              id=\"roomType\"\n              value={roomType}\n              onChange={(e) => setRoomType(e.target.value)}\n              placeholder=\"deluxe-suite, standard-room, etc.\"\n            />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"files\">תמונות</Label>\n            <Input\n              id=\"files\"\n              type=\"file\"\n              multiple\n              accept=\"image/*\"\n              onChange={handleFileChange}\n            />\n            {selectedFiles.length > 0 && (\n              <p className=\"text-sm text-gray-600\">\n                נבחרו {selectedFiles.length} קבצים\n              </p>\n            )}\n          </div>\n\n          {error && (\n            <div className=\"p-3 bg-red-50 border border-red-200 rounded text-red-700\">\n              {error}\n            </div>\n          )}\n\n          <Button\n            onClick={handleUpload}\n            disabled={uploading || selectedFiles.length === 0}\n            className=\"w-full\"\n          >\n            {uploading ? 'מעלה...' : 'העלה תמונות'}\n          </Button>\n\n          {uploadedUrls.length > 0 && (\n            <div className=\"space-y-2\">\n              <h3 className=\"font-semibold\">תמונות שהועלו בהצלחה:</h3>\n              <div className=\"space-y-2\">\n                {uploadedUrls.map((url, index) => (\n                  <div key={index} className=\"flex items-center gap-2\">\n                    <img\n                      src={url}\n                      alt={`Uploaded ${index + 1}`}\n                      className=\"w-20 h-20 object-cover rounded\"\n                    />\n                    <a\n                      href={url}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      className=\"text-sm text-blue-600 hover:underline break-all\"\n                    >\n                      {url}\n                    </a>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}