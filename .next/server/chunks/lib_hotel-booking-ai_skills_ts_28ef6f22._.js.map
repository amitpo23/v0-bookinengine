{"version":3,"sources":["../../../lib/hotel-booking-ai/skills.ts","../../../lib/hotel-booking-ai/engine-manager.ts","../../../lib/hotel-booking-ai/templates.ts"],"sourcesContent":["/**\n * Hotel Booking AI - Skills Library\n * Complete collection of skills for the Hotel Booking AI system\n */\n\nimport type { BookingSkill } from './types';\n\n// ========================================\n// SEARCH SKILLS\n// ========================================\n\nexport const hotelSearchSkill: BookingSkill = {\n  id: 'hotel-search',\n  name: 'Hotel Search',\n  nameHe: 'חיפוש מלונות',\n  description: 'Search for available hotels with real-time pricing and availability',\n  descriptionHe: 'חיפוש מלונות זמינים עם תמחור וזמינות בזמן אמת',\n  category: 'search',\n  capabilities: ['search'],\n  isEnabled: true,\n  priority: 1,\n  icon: 'search',\n  requiredPermissions: ['booking:read'],\n  tools: [\n    {\n      name: 'search_hotels',\n      description: 'Search for available hotel rooms with pricing and availability',\n      descriptionHe: 'חיפוש חדרי מלון זמינים עם מחירים וזמינות',\n      parameters: [\n        { name: 'destination', type: 'string', description: 'City or destination name', required: true },\n        { name: 'checkIn', type: 'date', description: 'Check-in date (YYYY-MM-DD)', required: true },\n        { name: 'checkOut', type: 'date', description: 'Check-out date (YYYY-MM-DD)', required: true },\n        { name: 'adults', type: 'number', description: 'Number of adults', required: true, default: 2 },\n        { name: 'children', type: 'array', description: 'Array of children ages', required: false, default: [] },\n        { name: 'rooms', type: 'number', description: 'Number of rooms', required: false, default: 1 },\n        { name: 'stars', type: 'array', description: 'Filter by star rating (1-5)', required: false },\n        { name: 'maxPrice', type: 'number', description: 'Maximum price per night', required: false },\n        { name: 'amenities', type: 'array', description: 'Required amenities', required: false }\n      ],\n      handler: 'handlers/booking.searchHotels',\n      isAsync: true,\n      timeout: 30000,\n      retryConfig: { maxRetries: 3, delayMs: 1000, exponentialBackoff: true }\n    },\n    {\n      name: 'get_hotel_details',\n      description: 'Get detailed information about a specific hotel',\n      descriptionHe: 'קבלת מידע מפורט על מלון ספציפי',\n      parameters: [\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true }\n      ],\n      handler: 'handlers/booking.getHotelDetails',\n      isAsync: true,\n      timeout: 15000\n    }\n  ]\n};\n\nexport const destinationSearchSkill: BookingSkill = {\n  id: 'destination-search',\n  name: 'Destination Search',\n  nameHe: 'חיפוש יעדים',\n  description: 'Search and get information about travel destinations',\n  descriptionHe: 'חיפוש וקבלת מידע על יעדי נסיעות',\n  category: 'search',\n  capabilities: ['search', 'knowledge-base'],\n  isEnabled: true,\n  priority: 2,\n  icon: 'map-pin',\n  requiredPermissions: ['search:read'],\n  tools: [\n    {\n      name: 'search_destinations',\n      description: 'Search for travel destinations by name or criteria',\n      parameters: [\n        { name: 'query', type: 'string', description: 'Search query', required: true },\n        { name: 'type', type: 'string', description: 'Destination type: city, beach, mountain, etc.', required: false }\n      ],\n      handler: 'handlers/search.searchDestinations',\n      isAsync: true,\n      timeout: 10000\n    },\n    {\n      name: 'get_destination_info',\n      description: 'Get detailed information about a destination',\n      parameters: [\n        { name: 'destination', type: 'string', description: 'Destination name', required: true },\n        { name: 'topics', type: 'array', description: 'Info topics: weather, attractions, safety, cuisine', required: false }\n      ],\n      handler: 'handlers/search.getDestinationInfo',\n      isAsync: true,\n      timeout: 15000\n    }\n  ]\n};\n\n// ========================================\n// BOOKING SKILLS\n// ========================================\n\nexport const prebookSkill: BookingSkill = {\n  id: 'prebook',\n  name: 'Hotel Pre-booking',\n  nameHe: 'הזמנה מוקדמת',\n  description: 'Pre-book a room to confirm availability and lock the price',\n  descriptionHe: 'הזמנה מוקדמת לחדר לאישור זמינות ונעילת מחיר',\n  category: 'booking',\n  capabilities: ['prebook'],\n  isEnabled: true,\n  priority: 3,\n  icon: 'clock',\n  requiredPermissions: ['booking:write'],\n  tools: [\n    {\n      name: 'prebook_room',\n      description: 'Pre-book a room to confirm availability and lock price temporarily',\n      descriptionHe: 'הזמנה מוקדמת של חדר לאישור זמינות ונעילת מחיר',\n      parameters: [\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\n        { name: 'roomCode', type: 'string', description: 'Room code from search results', required: true },\n        { name: 'checkIn', type: 'date', description: 'Check-in date', required: true },\n        { name: 'checkOut', type: 'date', description: 'Check-out date', required: true },\n        { name: 'adults', type: 'number', description: 'Number of adults', required: true },\n        { name: 'children', type: 'array', description: 'Children ages', required: false }\n      ],\n      handler: 'handlers/booking.prebookRoom',\n      isAsync: true,\n      timeout: 30000\n    }\n  ]\n};\n\nexport const bookingSkill: BookingSkill = {\n  id: 'booking',\n  name: 'Hotel Booking',\n  nameHe: 'הזמנת מלון',\n  description: 'Complete hotel booking with customer details and payment',\n  descriptionHe: 'השלמת הזמנת מלון עם פרטי לקוח ותשלום',\n  category: 'booking',\n  capabilities: ['booking', 'payment-processing'],\n  isEnabled: true,\n  priority: 4,\n  icon: 'check-circle',\n  requiredPermissions: ['booking:write', 'payment:process'],\n  tools: [\n    {\n      name: 'complete_booking',\n      description: 'Complete the booking with customer details and payment',\n      descriptionHe: 'השלמת ההזמנה עם פרטי לקוח ותשלום',\n      parameters: [\n        { name: 'prebookToken', type: 'string', description: 'Token from prebook', required: true },\n        { name: 'customer', type: 'object', description: 'Customer details', required: true },\n        { name: 'guests', type: 'array', description: 'Guest list', required: true },\n        { name: 'specialRequests', type: 'string', description: 'Special requests', required: false },\n        { name: 'paymentMethod', type: 'string', description: 'Payment method', required: false }\n      ],\n      handler: 'handlers/booking.completeBooking',\n      isAsync: true,\n      timeout: 60000\n    },\n    {\n      name: 'get_booking_status',\n      description: 'Get the status of an existing booking',\n      parameters: [\n        { name: 'bookingId', type: 'string', description: 'Booking ID or confirmation number', required: true }\n      ],\n      handler: 'handlers/booking.getBookingStatus',\n      isAsync: true,\n      timeout: 15000\n    }\n  ]\n};\n\nexport const cancellationSkill: BookingSkill = {\n  id: 'cancellation',\n  name: 'Booking Cancellation',\n  nameHe: 'ביטול הזמנה',\n  description: 'Cancel or modify existing bookings',\n  descriptionHe: 'ביטול או שינוי הזמנות קיימות',\n  category: 'booking',\n  capabilities: ['cancellation', 'modification'],\n  isEnabled: true,\n  priority: 5,\n  icon: 'x-circle',\n  requiredPermissions: ['booking:cancel'],\n  tools: [\n    {\n      name: 'cancel_booking',\n      description: 'Cancel an existing booking',\n      descriptionHe: 'ביטול הזמנה קיימת',\n      parameters: [\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\n        { name: 'reason', type: 'string', description: 'Cancellation reason', required: false }\n      ],\n      handler: 'handlers/booking.cancelBooking',\n      isAsync: true,\n      timeout: 30000\n    },\n    {\n      name: 'get_cancellation_policy',\n      description: 'Get cancellation policy and potential penalties',\n      parameters: [\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true }\n      ],\n      handler: 'handlers/booking.getCancellationPolicy',\n      isAsync: true,\n      timeout: 10000\n    },\n    {\n      name: 'modify_booking',\n      description: 'Modify an existing booking (dates, guests, room)',\n      parameters: [\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\n        { name: 'modifications', type: 'object', description: 'Changes to apply', required: true }\n      ],\n      handler: 'handlers/booking.modifyBooking',\n      isAsync: true,\n      timeout: 45000\n    }\n  ]\n};\n\n// ========================================\n// ANALYSIS SKILLS\n// ========================================\n\nexport const priceMonitoringSkill: BookingSkill = {\n  id: 'price-monitoring',\n  name: 'Price Monitoring',\n  nameHe: 'מעקב מחירים',\n  description: 'Track and analyze hotel prices over time',\n  descriptionHe: 'מעקב וניתוח מחירי מלונות לאורך זמן',\n  category: 'analysis',\n  capabilities: ['price-tracking', 'analytics'],\n  isEnabled: true,\n  priority: 6,\n  icon: 'trending-down',\n  requiredPermissions: ['monitoring:read', 'monitoring:write'],\n  tools: [\n    {\n      name: 'track_price',\n      description: 'Start tracking price for a hotel',\n      parameters: [\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\n        { name: 'checkIn', type: 'date', description: 'Check-in date', required: true },\n        { name: 'checkOut', type: 'date', description: 'Check-out date', required: true },\n        { name: 'targetPrice', type: 'number', description: 'Alert when price drops below', required: false },\n        { name: 'notifyEmail', type: 'string', description: 'Email for alerts', required: false }\n      ],\n      handler: 'handlers/monitoring.trackPrice',\n      isAsync: true,\n      timeout: 15000\n    },\n    {\n      name: 'get_price_history',\n      description: 'Get historical price data',\n      parameters: [\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\n        { name: 'days', type: 'number', description: 'Number of days of history', required: false, default: 30 }\n      ],\n      handler: 'handlers/monitoring.getPriceHistory',\n      isAsync: true,\n      timeout: 10000\n    },\n    {\n      name: 'analyze_price_trends',\n      description: 'Analyze price trends and predict best booking time',\n      parameters: [\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\n        { name: 'travelDates', type: 'object', description: 'Travel date range', required: true }\n      ],\n      handler: 'handlers/monitoring.analyzeTrends',\n      isAsync: true,\n      timeout: 20000\n    }\n  ]\n};\n\n// ========================================\n// COMMUNICATION SKILLS\n// ========================================\n\nexport const notificationSkill: BookingSkill = {\n  id: 'notifications',\n  name: 'Notifications',\n  nameHe: 'התראות',\n  description: 'Send booking confirmations and notifications',\n  descriptionHe: 'שליחת אישורי הזמנה והתראות',\n  category: 'communication',\n  capabilities: ['email-notification', 'sms-notification'],\n  isEnabled: true,\n  priority: 7,\n  icon: 'bell',\n  requiredPermissions: ['notifications:send'],\n  tools: [\n    {\n      name: 'send_confirmation_email',\n      description: 'Send booking confirmation email',\n      parameters: [\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\n        { name: 'recipientEmail', type: 'string', description: 'Recipient email', required: true }\n      ],\n      handler: 'handlers/notifications.sendConfirmationEmail',\n      isAsync: true,\n      timeout: 15000\n    },\n    {\n      name: 'send_sms',\n      description: 'Send SMS notification',\n      parameters: [\n        { name: 'phoneNumber', type: 'string', description: 'Phone number (E.164)', required: true },\n        { name: 'message', type: 'string', description: 'Message content', required: true }\n      ],\n      handler: 'handlers/notifications.sendSms',\n      isAsync: true,\n      timeout: 10000\n    }\n  ]\n};\n\nexport const voiceSkill: BookingSkill = {\n  id: 'voice',\n  name: 'Voice Interaction',\n  nameHe: 'אינטראקציה קולית',\n  description: 'Handle voice calls with speech-to-text and text-to-speech',\n  descriptionHe: 'טיפול בשיחות קוליות עם המרת דיבור לטקסט וטקסט לדיבור',\n  category: 'communication',\n  capabilities: ['voice-interaction', 'real-time-streaming'],\n  isEnabled: true,\n  priority: 8,\n  icon: 'phone',\n  requiredPermissions: ['voice:read', 'voice:write'],\n  tools: [\n    {\n      name: 'initiate_call',\n      description: 'Initiate outbound phone call',\n      parameters: [\n        { name: 'phoneNumber', type: 'string', description: 'Phone number (E.164)', required: true },\n        { name: 'purpose', type: 'string', description: 'Call purpose', required: true },\n        { name: 'language', type: 'string', description: 'Call language', required: false, default: 'he-IL' }\n      ],\n      handler: 'handlers/voice.initiateCall',\n      isAsync: true,\n      timeout: 120000\n    },\n    {\n      name: 'transfer_to_agent',\n      description: 'Transfer call to human agent',\n      parameters: [\n        { name: 'reason', type: 'string', description: 'Transfer reason', required: true },\n        { name: 'queue', type: 'string', description: 'Target queue', required: false }\n      ],\n      handler: 'handlers/voice.transferToAgent',\n      isAsync: true,\n      timeout: 30000\n    }\n  ]\n};\n\n// ========================================\n// SUPPORT SKILLS\n// ========================================\n\nexport const customerSupportSkill: BookingSkill = {\n  id: 'customer-support',\n  name: 'Customer Support',\n  nameHe: 'תמיכת לקוחות',\n  description: 'Handle customer inquiries and complaints',\n  descriptionHe: 'טיפול בפניות ותלונות לקוחות',\n  category: 'support',\n  capabilities: ['knowledge-base', 'handoff-to-human'],\n  isEnabled: true,\n  priority: 9,\n  icon: 'headphones',\n  requiredPermissions: ['support:read', 'support:write'],\n  tools: [\n    {\n      name: 'search_faq',\n      description: 'Search FAQ for answers',\n      parameters: [\n        { name: 'question', type: 'string', description: 'Customer question', required: true }\n      ],\n      handler: 'handlers/support.searchFaq',\n      isAsync: true,\n      timeout: 5000\n    },\n    {\n      name: 'create_ticket',\n      description: 'Create support ticket',\n      parameters: [\n        { name: 'subject', type: 'string', description: 'Ticket subject', required: true },\n        { name: 'description', type: 'string', description: 'Issue description', required: true },\n        { name: 'priority', type: 'string', description: 'Priority: low, medium, high', required: false, default: 'medium' }\n      ],\n      handler: 'handlers/support.createTicket',\n      isAsync: true,\n      timeout: 10000\n    },\n    {\n      name: 'escalate_to_human',\n      description: 'Escalate conversation to human agent',\n      parameters: [\n        { name: 'reason', type: 'string', description: 'Escalation reason', required: true },\n        { name: 'urgency', type: 'string', description: 'Urgency level', required: false }\n      ],\n      handler: 'handlers/support.escalateToHuman',\n      isAsync: true,\n      timeout: 15000\n    }\n  ]\n};\n\n// ========================================\n// PERSONALIZATION SKILLS\n// ========================================\n\nexport const loyaltySkill: BookingSkill = {\n  id: 'loyalty',\n  name: 'Loyalty Program',\n  nameHe: 'תוכנית נאמנות',\n  description: 'Manage loyalty points and rewards',\n  descriptionHe: 'ניהול נקודות נאמנות ותגמולים',\n  category: 'personalization',\n  capabilities: ['loyalty-points', 'analytics'],\n  isEnabled: true,\n  priority: 10,\n  icon: 'star',\n  requiredPermissions: ['loyalty:read', 'loyalty:write'],\n  tools: [\n    {\n      name: 'get_loyalty_balance',\n      description: 'Get loyalty points balance',\n      parameters: [\n        { name: 'userId', type: 'string', description: 'User ID', required: true }\n      ],\n      handler: 'handlers/loyalty.getBalance',\n      isAsync: true,\n      timeout: 5000\n    },\n    {\n      name: 'redeem_points',\n      description: 'Redeem loyalty points for rewards',\n      parameters: [\n        { name: 'userId', type: 'string', description: 'User ID', required: true },\n        { name: 'points', type: 'number', description: 'Points to redeem', required: true },\n        { name: 'rewardType', type: 'string', description: 'Reward type', required: true }\n      ],\n      handler: 'handlers/loyalty.redeemPoints',\n      isAsync: true,\n      timeout: 15000\n    },\n    {\n      name: 'apply_discount',\n      description: 'Apply member discount to booking',\n      parameters: [\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\n        { name: 'userId', type: 'string', description: 'User ID', required: true }\n      ],\n      handler: 'handlers/loyalty.applyDiscount',\n      isAsync: true,\n      timeout: 10000\n    }\n  ]\n};\n\nexport const preferencesSkill: BookingSkill = {\n  id: 'preferences',\n  name: 'User Preferences',\n  nameHe: 'העדפות משתמש',\n  description: 'Learn and apply user preferences',\n  descriptionHe: 'לימוד ויישום העדפות משתמש',\n  category: 'personalization',\n  capabilities: ['analytics'],\n  isEnabled: true,\n  priority: 11,\n  icon: 'settings',\n  requiredPermissions: ['user:read', 'user:write'],\n  tools: [\n    {\n      name: 'get_preferences',\n      description: 'Get user preferences',\n      parameters: [\n        { name: 'userId', type: 'string', description: 'User ID', required: true }\n      ],\n      handler: 'handlers/preferences.getPreferences',\n      isAsync: true,\n      timeout: 5000\n    },\n    {\n      name: 'update_preferences',\n      description: 'Update user preferences',\n      parameters: [\n        { name: 'userId', type: 'string', description: 'User ID', required: true },\n        { name: 'preferences', type: 'object', description: 'Preferences to update', required: true }\n      ],\n      handler: 'handlers/preferences.updatePreferences',\n      isAsync: true,\n      timeout: 10000\n    },\n    {\n      name: 'get_recommendations',\n      description: 'Get personalized hotel recommendations',\n      parameters: [\n        { name: 'userId', type: 'string', description: 'User ID', required: true },\n        { name: 'destination', type: 'string', description: 'Destination', required: true },\n        { name: 'dates', type: 'object', description: 'Travel dates', required: true }\n      ],\n      handler: 'handlers/preferences.getRecommendations',\n      isAsync: true,\n      timeout: 15000\n    }\n  ]\n};\n\n// ========================================\n// EXPORT ALL SKILLS\n// ========================================\n\nexport const allSkills: BookingSkill[] = [\n  // Search\n  hotelSearchSkill,\n  destinationSearchSkill,\n  // Booking\n  prebookSkill,\n  bookingSkill,\n  cancellationSkill,\n  // Analysis\n  priceMonitoringSkill,\n  // Communication\n  notificationSkill,\n  voiceSkill,\n  // Support\n  customerSupportSkill,\n  // Personalization\n  loyaltySkill,\n  preferencesSkill\n];\n\nexport const getSkillById = (id: string): BookingSkill | undefined => {\n  return allSkills.find(skill => skill.id === id);\n};\n\nexport const getSkillsByCategory = (category: string): BookingSkill[] => {\n  return allSkills.filter(skill => skill.category === category);\n};\n\nexport const getEnabledSkills = (): BookingSkill[] => {\n  return allSkills.filter(skill => skill.isEnabled);\n};\n\nexport const getSkillsByCapability = (capability: string): BookingSkill[] => {\n  return allSkills.filter(skill => \n    skill.capabilities.includes(capability as any)\n  );\n};\n","/**\n * Hotel Booking AI - Engine Manager\n * Manages engine instances, conversation state, and tool execution\n */\n\n// @ts-ignore - groq-sdk may not be installed yet\nimport Groq from 'groq-sdk';\nimport type {\n  BookingEngineTemplate,\n  ConversationContext,\n  ConversationMessage,\n  BookingTool,\n  ToolResult,\n  EngineInstance,\n  EngineSessionMetrics\n} from './types';\nimport { allTemplates, getTemplateById } from './templates';\nimport { allSkills } from './skills';\n\n// ========================================\n// GROQ CLIENT\n// ========================================\n\nconst getGroqClient = (): any => {\n  const apiKey = process.env.GROQ_API_KEY;\n  if (!apiKey) {\n    throw new Error('GROQ_API_KEY environment variable is required');\n  }\n  return new Groq({ apiKey });\n};\n\n// ========================================\n// ENGINE INSTANCE MANAGEMENT\n// ========================================\n\nconst engineInstances = new Map<string, EngineInstance>();\nconst conversationContexts = new Map<string, ConversationContext>();\n\nexport interface CreateEngineOptions {\n  templateId: string;\n  userId?: string;\n  metadata?: Record<string, any>;\n}\n\n/**\n * Create a new engine instance from a template\n */\nexport function createEngine(options: CreateEngineOptions): EngineInstance {\n  const { templateId, userId, metadata } = options;\n\n  const template = getTemplateById(templateId);\n  if (!template) {\n    throw new Error(`Template not found: ${templateId}`);\n  }\n\n  const instanceId = `${templateId}-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n\n  const instance: EngineInstance = {\n    id: instanceId,\n    templateId,\n    template,\n    status: 'active',\n    createdAt: new Date().toISOString(),\n    lastActiveAt: new Date().toISOString(),\n    userId,\n    metadata: metadata || {},\n    metrics: {\n      messagesProcessed: 0,\n      toolsExecuted: 0,\n      avgResponseTime: 0,\n      errorCount: 0,\n      sessionDuration: 0\n    }\n  };\n\n  // Initialize conversation context\n  const context: ConversationContext = {\n    sessionId: instanceId,\n    engineType: template.type,\n    history: [],\n    currentState: 'greeting',\n    language: 'en',\n    userPreferences: {},\n    metadata: {\n      createdAt: instance.createdAt,\n      templateId\n    }\n  };\n\n  engineInstances.set(instanceId, instance);\n  conversationContexts.set(instanceId, context);\n\n  return instance;\n}\n\n/**\n * Get an existing engine instance\n */\nexport function getEngine(instanceId: string): EngineInstance | undefined {\n  return engineInstances.get(instanceId);\n}\n\n/**\n * Get conversation context for an engine\n */\nexport function getConversationContext(instanceId: string): ConversationContext | undefined {\n  return conversationContexts.get(instanceId);\n}\n\n/**\n * Destroy an engine instance and clean up resources\n */\nexport function destroyEngine(instanceId: string): boolean {\n  const deleted = engineInstances.delete(instanceId);\n  conversationContexts.delete(instanceId);\n  return deleted;\n}\n\n/**\n * List all active engine instances\n */\nexport function listEngines(filter?: { status?: string; templateId?: string }): EngineInstance[] {\n  const instances = Array.from(engineInstances.values());\n\n  if (!filter) return instances;\n\n  return instances.filter(instance => {\n    if (filter.status && instance.status !== filter.status) return false;\n    if (filter.templateId && instance.templateId !== filter.templateId) return false;\n    return true;\n  });\n}\n\n// ========================================\n// TOOL EXECUTION\n// ========================================\n\ninterface ToolHandler {\n  (params: Record<string, any>, context: ConversationContext): Promise<ToolResult>;\n}\n\nconst toolHandlers: Record<string, ToolHandler> = {};\n\n/**\n * Register a handler for a specific tool\n */\nexport function registerToolHandler(toolName: string, handler: ToolHandler): void {\n  toolHandlers[toolName] = handler;\n}\n\n/**\n * Execute a tool and return the result\n */\nexport async function executeTool(\n  toolName: string,\n  params: Record<string, any>,\n  context: ConversationContext\n): Promise<ToolResult> {\n  const handler = toolHandlers[toolName];\n\n  if (!handler) {\n    return {\n      success: false,\n      data: null,\n      error: `No handler registered for tool: ${toolName}`\n    };\n  }\n\n  try {\n    const startTime = Date.now();\n    const result = await handler(params, context);\n    result.executionTime = Date.now() - startTime;\n    return result;\n  } catch (error: any) {\n    console.error(`Tool execution error (${toolName}):`, error);\n    return {\n      success: false,\n      data: null,\n      error: error.message || 'Tool execution failed'\n    };\n  }\n}\n\n/**\n * Get available tools for an engine template\n */\nexport function getToolsForEngine(templateId: string): BookingTool[] {\n  const template = getTemplateById(templateId);\n  if (!template) return [];\n\n  const tools: BookingTool[] = [];\n  for (const skill of template.skills) {\n    tools.push(...skill.tools);\n  }\n  return tools;\n}\n\n// ========================================\n// CONVERSATION MANAGEMENT\n// ========================================\n\nexport interface ChatOptions {\n  instanceId: string;\n  message: string;\n  language?: 'en' | 'he';\n}\n\nexport interface ChatResponse {\n  reply: string;\n  toolCalls?: Array<{\n    name: string;\n    parameters: Record<string, any>;\n    result: ToolResult;\n  }>;\n  context: {\n    sessionId: string;\n    messageCount: number;\n    currentState: string;\n  };\n  usage?: {\n    promptTokens: number;\n    completionTokens: number;\n    totalTokens: number;\n  };\n}\n\n/**\n * Process a chat message for an engine instance\n */\nexport async function chat(options: ChatOptions): Promise<ChatResponse> {\n  const { instanceId, message, language = 'en' } = options;\n\n  const instance = getEngine(instanceId);\n  if (!instance) {\n    throw new Error(`Engine instance not found: ${instanceId}`);\n  }\n\n  const context = getConversationContext(instanceId);\n  if (!context) {\n    throw new Error(`Conversation context not found: ${instanceId}`);\n  }\n\n  const template = instance.template;\n  const startTime = Date.now();\n\n  // Update context\n  context.language = language;\n\n  // Add user message to history\n  const userMessage: ConversationMessage = {\n    role: 'user',\n    content: message,\n    timestamp: new Date().toISOString()\n  };\n  context.history.push(userMessage);\n\n  // Get tools for this engine\n  const tools = getToolsForEngine(instance.templateId);\n\n  // Build messages for LLM\n  const systemPrompt = language === 'he' && template.prompts.systemPromptHe\n    ? template.prompts.systemPromptHe\n    : template.prompts.systemPrompt;\n\n  const messages: any[] = [\n    { role: 'system', content: systemPrompt },\n    ...context.history.slice(-template.config.contextWindowSize).map(msg => ({\n      role: msg.role as 'user' | 'assistant' | 'system',\n      content: msg.content\n    }))\n  ];\n\n  // Convert tools to Groq format\n  const groqTools: any[] = tools.map(tool => ({\n    type: 'function' as const,\n    function: {\n      name: tool.name,\n      description: tool.description,\n      parameters: tool.parameters\n    }\n  }));\n\n  try {\n    const groq = getGroqClient();\n\n    // Initial LLM call\n    const completion = await groq.chat.completions.create({\n      model: template.modelConfig.model,\n      messages,\n      tools: groqTools.length > 0 ? groqTools : undefined,\n      tool_choice: groqTools.length > 0 ? 'auto' : undefined,\n      temperature: template.modelConfig.temperature,\n      max_tokens: template.modelConfig.maxTokens,\n      top_p: template.modelConfig.topP\n    });\n\n    const responseMessage = completion.choices[0].message;\n    const toolCalls: ChatResponse['toolCalls'] = [];\n\n    // Process tool calls if any - PARALLEL EXECUTION for better performance\n    if (responseMessage.tool_calls && responseMessage.tool_calls.length > 0) {\n      // Execute all independent tools in parallel\n      const toolPromises = responseMessage.tool_calls.map(async (toolCall: any) => {\n        const toolName = toolCall.function.name;\n        const toolParams = JSON.parse(toolCall.function.arguments);\n        \n        // Emit progress event\n        console.log(`[Progress] Executing tool: ${toolName}`);\n        \n        const result = await executeTool(toolName, toolParams, context);\n        \n        return {\n          id: toolCall.id,\n          name: toolName,\n          parameters: toolParams,\n          result\n        };\n      });\n\n      // Wait for all tools to complete in parallel\n      const toolResults = await Promise.all(toolPromises);\n      \n      // Process results\n      for (const toolResult of toolResults) {\n        toolCalls.push({\n          name: toolResult.name,\n          parameters: toolResult.parameters,\n          result: toolResult.result\n        });\n        instance.metrics.toolsExecuted++;\n      }\n\n      // Get final response with tool results\n      const toolResultMessages: any[] = [\n        ...messages,\n        responseMessage,\n        ...toolResults.map(tc => ({\n          role: 'tool' as const,\n          tool_call_id: tc.id,\n          content: JSON.stringify(tc.result.data)\n        }))\n      ];\n\n      const finalCompletion = await groq.chat.completions.create({\n        model: template.modelConfig.model,\n        messages: toolResultMessages,\n        temperature: template.modelConfig.temperature,\n        max_tokens: template.modelConfig.maxTokens\n      });\n\n      const finalReply = finalCompletion.choices[0].message.content || '';\n\n      // Add assistant message to history\n      const assistantMessage: ConversationMessage = {\n        role: 'assistant',\n        content: finalReply,\n        timestamp: new Date().toISOString(),\n        toolCalls: toolCalls.map(tc => ({\n          name: tc.name,\n          parameters: tc.parameters\n        }))\n      };\n      context.history.push(assistantMessage);\n\n      // Update metrics\n      instance.metrics.messagesProcessed++;\n      const responseTime = Date.now() - startTime;\n      instance.metrics.avgResponseTime =\n        (instance.metrics.avgResponseTime * (instance.metrics.messagesProcessed - 1) + responseTime) /\n        instance.metrics.messagesProcessed;\n      instance.lastActiveAt = new Date().toISOString();\n\n      return {\n        reply: finalReply,\n        toolCalls,\n        context: {\n          sessionId: instanceId,\n          messageCount: context.history.length,\n          currentState: context.currentState\n        },\n        usage: {\n          promptTokens: (completion.usage?.prompt_tokens || 0) +\n            (finalCompletion.usage?.prompt_tokens || 0),\n          completionTokens: (completion.usage?.completion_tokens || 0) +\n            (finalCompletion.usage?.completion_tokens || 0),\n          totalTokens: (completion.usage?.total_tokens || 0) +\n            (finalCompletion.usage?.total_tokens || 0)\n        }\n      };\n    }\n\n    // No tool calls - return direct response\n    const reply = responseMessage.content || '';\n\n    const assistantMessage: ConversationMessage = {\n      role: 'assistant',\n      content: reply,\n      timestamp: new Date().toISOString()\n    };\n    context.history.push(assistantMessage);\n\n    // Update metrics\n    instance.metrics.messagesProcessed++;\n    const responseTime = Date.now() - startTime;\n    instance.metrics.avgResponseTime =\n      (instance.metrics.avgResponseTime * (instance.metrics.messagesProcessed - 1) + responseTime) /\n      instance.metrics.messagesProcessed;\n    instance.lastActiveAt = new Date().toISOString();\n\n    return {\n      reply,\n      context: {\n        sessionId: instanceId,\n        messageCount: context.history.length,\n        currentState: context.currentState\n      },\n      usage: {\n        promptTokens: completion.usage?.prompt_tokens || 0,\n        completionTokens: completion.usage?.completion_tokens || 0,\n        totalTokens: completion.usage?.total_tokens || 0\n      }\n    };\n  } catch (error: any) {\n    console.error('Chat error:', error);\n    instance.metrics.errorCount++;\n\n    const errorMessage = template.prompts.errorMessages?.general ||\n      'I apologize, but something went wrong. Please try again.';\n\n    return {\n      reply: errorMessage,\n      context: {\n        sessionId: instanceId,\n        messageCount: context.history.length,\n        currentState: 'error'\n      }\n    };\n  }\n}\n\n// ========================================\n// CONVERSATION UTILITIES\n// ========================================\n\n/**\n * Get the greeting message for an engine\n */\nexport function getGreeting(instanceId: string, language: 'en' | 'he' = 'en'): string {\n  const instance = getEngine(instanceId);\n  if (!instance) return '';\n\n  const template = instance.template;\n  return language === 'he' && template.prompts.greetingMessageHe\n    ? template.prompts.greetingMessageHe\n    : template.prompts.greetingMessage || '';\n}\n\n/**\n * Clear conversation history for an engine\n */\nexport function clearHistory(instanceId: string): boolean {\n  const context = getConversationContext(instanceId);\n  if (!context) return false;\n\n  context.history = [];\n  context.currentState = 'greeting';\n  return true;\n}\n\n/**\n * Get conversation summary\n */\nexport function getConversationSummary(instanceId: string): {\n  messageCount: number;\n  toolCalls: number;\n  duration: number;\n  lastMessage?: string;\n} | null {\n  const instance = getEngine(instanceId);\n  const context = getConversationContext(instanceId);\n\n  if (!instance || !context) return null;\n\n  const firstMessageTime = context.history[0]\n    ? new Date(context.history[0].timestamp).getTime()\n    : Date.now();\n  const duration = Date.now() - firstMessageTime;\n\n  return {\n    messageCount: context.history.length,\n    toolCalls: instance.metrics.toolsExecuted,\n    duration,\n    lastMessage: context.history[context.history.length - 1]?.content\n  };\n}\n\n// ========================================\n// TEMPLATE UTILITIES\n// ========================================\n\n/**\n * Get all available templates\n */\nexport function getAvailableTemplates(): BookingEngineTemplate[] {\n  return allTemplates;\n}\n\n/**\n * Get template by ID\n */\nexport function getTemplate(templateId: string): BookingEngineTemplate | undefined {\n  return getTemplateById(templateId);\n}\n\n// ========================================\n// DASHBOARD STATS\n// ========================================\n\nexport interface DashboardStats {\n  activeEngines: number;\n  totalConversations: number;\n  totalMessages: number;\n  totalToolCalls: number;\n  avgResponseTime: number;\n  errorRate: number;\n  enginesByType: Record<string, number>;\n}\n\n/**\n * Get dashboard statistics\n */\nexport function getDashboardStats(): DashboardStats {\n  const engines = Array.from(engineInstances.values());\n\n  let totalMessages = 0;\n  let totalToolCalls = 0;\n  let totalResponseTime = 0;\n  let totalErrors = 0;\n  const enginesByType: Record<string, number> = {};\n\n  for (const engine of engines) {\n    totalMessages += engine.metrics.messagesProcessed;\n    totalToolCalls += engine.metrics.toolsExecuted;\n    totalResponseTime += engine.metrics.avgResponseTime * engine.metrics.messagesProcessed;\n    totalErrors += engine.metrics.errorCount;\n\n    const type = engine.template.type;\n    enginesByType[type] = (enginesByType[type] || 0) + 1;\n  }\n\n  return {\n    activeEngines: engines.filter(e => e.status === 'active').length,\n    totalConversations: engines.length,\n    totalMessages,\n    totalToolCalls,\n    avgResponseTime: totalMessages > 0 ? totalResponseTime / totalMessages : 0,\n    errorRate: totalMessages > 0 ? (totalErrors / totalMessages) * 100 : 0,\n    enginesByType\n  };\n}\n","/**\n * Hotel Booking AI - Engine Templates\n * Pre-configured engine templates for different booking scenarios\n */\n\nimport type { BookingEngineTemplate } from './types';\nimport {\n  hotelSearchSkill,\n  destinationSearchSkill,\n  prebookSkill,\n  bookingSkill,\n  cancellationSkill,\n  priceMonitoringSkill,\n  notificationSkill,\n  voiceSkill,\n  customerSupportSkill,\n  loyaltySkill,\n  preferencesSkill\n} from './skills';\n\n// ========================================\n// HOTEL BOOKING AGENT\n// Main booking engine with full capabilities\n// ========================================\n\nexport const hotelBookingAgentTemplate: BookingEngineTemplate = {\n  id: 'hotel-booking-agent',\n  type: 'hotel-booking',\n  name: 'Hotel Booking Agent',\n  nameHe: 'סוכן הזמנות מלון',\n  description: 'Complete hotel booking agent with search, prebook, and booking capabilities',\n  descriptionHe: 'סוכן הזמנות מלון מלא עם יכולות חיפוש, הזמנה מוקדמת והזמנה',\n  version: '1.0.0',\n  icon: 'building-2',\n  color: 'blue',\n  skills: [hotelSearchSkill, prebookSkill, bookingSkill, cancellationSkill, notificationSkill],\n  capabilities: ['search', 'prebook', 'booking', 'cancellation', 'email-notification'],\n  modelConfig: {\n    provider: 'groq',\n    model: 'llama-3.3-70b-versatile',\n    temperature: 0.7,\n    maxTokens: 4096,\n    topP: 0.9\n  },\n  persona: {\n    name: 'Alex',\n    nameHe: 'אלכס',\n    role: 'Senior Booking Agent',\n    roleHe: 'סוכן הזמנות בכיר',\n    personality: ['professional', 'helpful', 'efficient', 'knowledgeable'],\n    communicationStyle: 'friendly-professional',\n    expertise: ['hotel bookings', 'travel planning', 'customer service'],\n    languages: ['en', 'he', 'ar']\n  },\n  prompts: {\n    systemPrompt: `You are Alex, a senior hotel booking agent. Your role is to help customers find and book the perfect hotel accommodations.\n\nCORE RESPONSIBILITIES:\n1. Search for hotels based on customer requirements\n2. Present options clearly with pricing and key features\n3. Guide customers through the booking process\n4. Handle special requests and preferences\n5. Provide cancellation and modification assistance\n\nBOOKING FLOW:\n1. Gather requirements: destination, dates, guests, preferences\n2. Search for available hotels using search_hotels\n3. Present top 3-5 options with key details\n4. When customer selects, use prebook_room to confirm availability\n5. Collect customer details and complete booking\n6. Send confirmation email\n\nGUIDELINES:\n- Always confirm dates and guest count before searching\n- Present prices clearly in the customer's preferred currency\n- Highlight cancellation policies\n- Be proactive about special offers\n\nLANGUAGE: Respond in the same language the customer uses.`,\n    systemPromptHe: `אתה אלכס, סוכן הזמנות מלון בכיר. תפקידך לעזור ללקוחות למצוא ולהזמין את המלון המושלם.\n\nתחומי אחריות:\n1. חיפוש מלונות לפי דרישות הלקוח\n2. הצגת אפשרויות ברורה עם מחירים ותכונות\n3. ליווי לקוחות בתהליך ההזמנה\n4. טיפול בבקשות מיוחדות\n5. סיוע בביטולים ושינויים\n\nזרימת הזמנה:\n1. איסוף דרישות: יעד, תאריכים, אורחים\n2. חיפוש מלונות זמינים\n3. הצגת 3-5 אפשרויות מובילות\n4. הזמנה מוקדמת לבדיקת זמינות\n5. איסוף פרטי לקוח והשלמת הזמנה\n6. שליחת אישור במייל`,\n    greetingMessage: `Hello! I'm Alex, your hotel booking assistant. How can I help you find the perfect accommodation today?`,\n    greetingMessageHe: `שלום! אני אלכס, עוזר ההזמנות שלך. איך אוכל לעזור לך למצוא את המלון המושלם היום?`,\n    errorMessages: {\n      noResults: 'I couldn\\'t find any hotels matching your criteria. Would you like to adjust your search?',\n      bookingFailed: 'There was an issue completing your booking. Let me try again.',\n      timeout: 'The search is taking longer than expected. Please wait a moment.',\n      general: 'Something went wrong. Let me help you with that.'\n    }\n  },\n  config: {\n    maxConversationTurns: 50,\n    contextWindowSize: 20,\n    enableMemory: true,\n    enableLogging: true,\n    logLevel: 'info',\n    enableAnalytics: true,\n    responseTimeout: 30000,\n    autoSave: true\n  },\n  integrations: {\n    hotelApi: {\n      enabled: true,\n      provider: 'medici'\n    },\n    payment: {\n      enabled: true,\n      provider: 'stripe',\n      supportedMethods: ['card', 'apple_pay', 'google_pay']\n    }\n  }\n};\n\n// ========================================\n// PRICE MONITOR AGENT\n// Automated price tracking and alerts\n// ========================================\n\nexport const priceMonitorAgentTemplate: BookingEngineTemplate = {\n  id: 'price-monitor-agent',\n  type: 'price-monitor',\n  name: 'Price Monitor Agent',\n  nameHe: 'סוכן מעקב מחירים',\n  description: 'Automated price monitoring with alerts and trend analysis',\n  descriptionHe: 'מעקב מחירים אוטומטי עם התראות וניתוח מגמות',\n  version: '1.0.0',\n  icon: 'trending-down',\n  color: 'green',\n  skills: [hotelSearchSkill, priceMonitoringSkill, notificationSkill],\n  capabilities: ['search', 'price-tracking', 'analytics', 'email-notification'],\n  modelConfig: {\n    provider: 'groq',\n    model: 'llama-3.1-8b-instant',\n    temperature: 0.3,\n    maxTokens: 2048\n  },\n  persona: {\n    name: 'Atlas',\n    nameHe: 'אטלס',\n    role: 'Price Analyst',\n    roleHe: 'אנליסט מחירים',\n    personality: ['analytical', 'precise', 'data-driven', 'proactive'],\n    communicationStyle: 'informative-concise',\n    expertise: ['price analysis', 'market trends', 'deal detection'],\n    languages: ['en', 'he']\n  },\n  prompts: {\n    systemPrompt: `You are Atlas, a price monitoring specialist. You track hotel prices and help users book at the best time.\n\nCAPABILITIES:\n1. Track prices for specific hotels and dates\n2. Analyze historical pricing patterns\n3. Predict optimal booking windows\n4. Alert users to significant price drops\n\nINSIGHTS TO PROVIDE:\n- Price trends (rising, falling, stable)\n- Best time to book\n- Comparison with similar hotels\n- Seasonal patterns\n\nBe concise and data-driven. Present numbers clearly.`,\n    greetingMessage: `Hi! I'm Atlas, your price monitoring assistant. I can track hotel prices and alert you to the best deals. What would you like to monitor?`,\n    greetingMessageHe: `שלום! אני אטלס, עוזר מעקב המחירים שלך. אני יכול לעקוב אחר מחירי מלונות ולהתריע על העסקאות הטובות ביותר. מה תרצה לעקוב?`,\n    errorMessages: {\n      noResults: 'I couldn\\'t find pricing data for this hotel.',\n      bookingFailed: 'Unable to start price tracking.',\n      timeout: 'Data retrieval is taking longer than expected.',\n      general: 'Something went wrong with the analysis.'\n    }\n  },\n  config: {\n    maxConversationTurns: 30,\n    contextWindowSize: 15,\n    enableMemory: true,\n    enableLogging: true,\n    logLevel: 'info',\n    enableAnalytics: true,\n    responseTimeout: 20000,\n    autoSave: true\n  }\n};\n\n// ========================================\n// CUSTOMER SUPPORT AGENT\n// Handle inquiries and complaints\n// ========================================\n\nexport const customerSupportAgentTemplate: BookingEngineTemplate = {\n  id: 'customer-support-agent',\n  type: 'customer-support',\n  name: 'Customer Support Agent',\n  nameHe: 'סוכן תמיכת לקוחות',\n  description: 'Customer support for booking issues and inquiries',\n  descriptionHe: 'תמיכת לקוחות לבעיות הזמנה ובירורים',\n  version: '1.0.0',\n  icon: 'headphones',\n  color: 'purple',\n  skills: [cancellationSkill, customerSupportSkill, notificationSkill],\n  capabilities: ['cancellation', 'modification', 'knowledge-base', 'handoff-to-human'],\n  modelConfig: {\n    provider: 'groq',\n    model: 'llama-3.3-70b-versatile',\n    temperature: 0.5,\n    maxTokens: 2048\n  },\n  persona: {\n    name: 'Sophie',\n    nameHe: 'סופי',\n    role: 'Customer Support Specialist',\n    roleHe: 'מומחית תמיכת לקוחות',\n    personality: ['empathetic', 'patient', 'solution-oriented', 'calm'],\n    communicationStyle: 'understanding-helpful',\n    expertise: ['issue resolution', 'policy expertise', 'customer advocacy'],\n    languages: ['en', 'he', 'ar', 'ru']\n  },\n  prompts: {\n    systemPrompt: `You are Sophie, a customer support specialist. You handle booking issues with empathy and efficiency.\n\nPRIORITIES:\n1. Acknowledge the customer's concern\n2. Apologize sincerely when appropriate\n3. Take ownership of the issue\n4. Find the best possible solution\n5. Follow up to ensure satisfaction\n\nCOMMON ISSUES:\n- Booking modifications and cancellations\n- Refund requests\n- Complaint resolution\n- Policy clarification\n\nESCALATION: Escalate to human agent when:\n- Customer explicitly requests\n- Legal/safety concerns\n- High-value customer at risk\n- Unable to resolve after 3 attempts\n\nAlways validate the customer's feelings and offer solutions, not excuses.`,\n    greetingMessage: `Hello, I'm Sophie from customer support. I'm here to help with any concerns about your booking. How can I assist you?`,\n    greetingMessageHe: `שלום, אני סופי מתמיכת הלקוחות. אני כאן לעזור עם כל שאלה בנוגע להזמנה שלך. במה אוכל לסייע?`,\n    errorMessages: {\n      noResults: 'I couldn\\'t find that booking. Could you double-check the confirmation number?',\n      bookingFailed: 'I\\'m having trouble processing that. Let me connect you with a specialist.',\n      timeout: 'This is taking a moment. Please hold on.',\n      general: 'I apologize for the inconvenience. Let me look into this.'\n    }\n  },\n  config: {\n    maxConversationTurns: 40,\n    contextWindowSize: 25,\n    enableMemory: true,\n    enableLogging: true,\n    logLevel: 'info',\n    enableAnalytics: true,\n    responseTimeout: 25000,\n    autoSave: true\n  }\n};\n\n// ========================================\n// VOICE BOOKING AGENT\n// Phone-based booking assistant\n// ========================================\n\nexport const voiceBookingAgentTemplate: BookingEngineTemplate = {\n  id: 'voice-booking-agent',\n  type: 'voice-agent',\n  name: 'Voice Booking Agent',\n  nameHe: 'סוכן הזמנות קולי',\n  description: 'Voice-enabled agent for phone-based hotel bookings',\n  descriptionHe: 'סוכן קולי להזמנות מלון טלפוניות',\n  version: '1.0.0',\n  icon: 'phone',\n  color: 'orange',\n  skills: [hotelSearchSkill, prebookSkill, bookingSkill, voiceSkill],\n  capabilities: ['search', 'prebook', 'booking', 'voice-interaction', 'sms-notification'],\n  modelConfig: {\n    provider: 'openai',\n    model: 'gpt-4o',\n    temperature: 0.7,\n    maxTokens: 1024\n  },\n  persona: {\n    name: 'Sam',\n    nameHe: 'סם',\n    role: 'Voice Booking Specialist',\n    roleHe: 'מומחה הזמנות קולי',\n    personality: ['clear', 'patient', 'efficient', 'friendly'],\n    communicationStyle: 'conversational-clear',\n    expertise: ['phone bookings', 'audio clarity', 'efficient communication'],\n    languages: ['en', 'he'],\n    voiceId: 'he-IL-HilaNeural'\n  },\n  prompts: {\n    systemPrompt: `You are Sam, a voice booking specialist handling phone calls for hotel reservations.\n\nVOICE GUIDELINES:\n1. Speak clearly and at moderate pace\n2. Confirm information by repeating key details\n3. Use phonetic spelling for important codes\n4. Break complex information into digestible parts\n5. Allow pauses for customer responses\n\nCALL FLOW:\n1. Greet and identify yourself\n2. Determine: new booking, modification, or cancellation\n3. Gather requirements step by step\n4. Confirm all details before proceeding\n5. Provide confirmation number clearly\n6. Offer to send SMS summary\n\nKeep sentences short. Avoid jargon.`,\n    greetingMessage: `Thank you for calling! This is Sam, your booking assistant. How can I help you today?`,\n    greetingMessageHe: `תודה שהתקשרת! כאן סם, עוזר ההזמנות שלך. איך אוכל לעזור לך היום?`,\n    errorMessages: {\n      noResults: 'I couldn\\'t find any hotels for those dates. Would you like to try different dates?',\n      bookingFailed: 'I\\'m having trouble completing the booking. Let me try again.',\n      timeout: 'Please hold on a moment while I search.',\n      general: 'I apologize, there seems to be an issue. Let me help you with that.'\n    }\n  },\n  config: {\n    maxConversationTurns: 60,\n    contextWindowSize: 15,\n    enableMemory: true,\n    enableLogging: true,\n    logLevel: 'info',\n    enableAnalytics: true,\n    responseTimeout: 10000,\n    autoSave: true,\n    enableVoice: true,\n    voiceConfig: {\n      sttProvider: 'azure',\n      ttsProvider: 'azure',\n      voiceId: 'he-IL-HilaNeural',\n      language: 'he-IL',\n      prosodyRate: 0.95\n    }\n  }\n};\n\n// ========================================\n// CONCIERGE AGENT\n// In-stay hotel services\n// ========================================\n\nexport const conciergeAgentTemplate: BookingEngineTemplate = {\n  id: 'concierge-agent',\n  type: 'concierge',\n  name: 'Hotel Concierge',\n  nameHe: 'קונסיירז\\' מלון',\n  description: 'In-stay concierge for guest services and recommendations',\n  descriptionHe: 'קונסיירז\\' לשירותי אורחים והמלצות',\n  version: '1.0.0',\n  icon: 'sparkles',\n  color: 'gold',\n  skills: [destinationSearchSkill, customerSupportSkill, notificationSkill],\n  capabilities: ['knowledge-base', 'search', 'sms-notification'],\n  modelConfig: {\n    provider: 'groq',\n    model: 'llama-3.3-70b-versatile',\n    temperature: 0.6,\n    maxTokens: 2048\n  },\n  persona: {\n    name: 'James',\n    nameHe: 'ג\\'יימס',\n    role: 'Head Concierge',\n    roleHe: 'ראש הקונסיירז\\'',\n    personality: ['sophisticated', 'attentive', 'resourceful', 'discrete'],\n    communicationStyle: 'formal-elegant',\n    expertise: ['local dining', 'entertainment', 'transportation', 'special requests'],\n    languages: ['en', 'he', 'fr', 'it', 'de']\n  },\n  prompts: {\n    systemPrompt: `You are James, the head concierge at a luxury hotel. You provide impeccable service with extensive local knowledge.\n\nSERVICES:\n- Restaurant reservations and recommendations\n- Transportation arrangements\n- Entertainment and event tickets\n- Local tours and experiences\n- Special occasion arrangements\n- Room service coordination\n\nSTANDARDS:\n- Maintain highest professionalism\n- Anticipate guest needs\n- Know local establishments personally\n- Handle requests with discretion\n- Provide multiple options\n\nNever say \"no\" - always offer alternatives.`,\n    greetingMessage: `Good day. I'm James, your concierge. How may I be of service during your stay?`,\n    greetingMessageHe: `יום טוב. אני ג'יימס, הקונסיירז' שלך. במה אוכל לסייע במהלך שהייתך?`,\n    errorMessages: {\n      noResults: 'I\\'m having difficulty finding that. Let me suggest some alternatives.',\n      bookingFailed: 'I apologize, but I\\'m unable to arrange that at the moment. May I offer another option?',\n      timeout: 'Please allow me a moment to arrange this for you.',\n      general: 'I apologize for any inconvenience. Allow me to assist you personally.'\n    }\n  },\n  config: {\n    maxConversationTurns: 40,\n    contextWindowSize: 20,\n    enableMemory: true,\n    enableLogging: true,\n    logLevel: 'info',\n    enableAnalytics: true,\n    responseTimeout: 20000,\n    autoSave: true\n  }\n};\n\n// ========================================\n// GROUP BOOKING AGENT\n// Corporate and group bookings\n// ========================================\n\nexport const groupBookingAgentTemplate: BookingEngineTemplate = {\n  id: 'group-booking-agent',\n  type: 'group-booking',\n  name: 'Group Booking Agent',\n  nameHe: 'סוכן הזמנות קבוצתיות',\n  description: 'Specialized agent for corporate and group bookings',\n  descriptionHe: 'סוכן מתמחה בהזמנות לחברות וקבוצות',\n  version: '1.0.0',\n  icon: 'users',\n  color: 'indigo',\n  skills: [hotelSearchSkill, prebookSkill, bookingSkill, loyaltySkill],\n  capabilities: ['search', 'prebook', 'booking', 'analytics', 'loyalty-points'],\n  modelConfig: {\n    provider: 'groq',\n    model: 'llama-3.3-70b-versatile',\n    temperature: 0.6,\n    maxTokens: 4096\n  },\n  persona: {\n    name: 'David',\n    nameHe: 'דוד',\n    role: 'Corporate Sales Manager',\n    roleHe: 'מנהל מכירות לעסקים',\n    personality: ['professional', 'negotiator', 'strategic', 'relationship-focused'],\n    communicationStyle: 'business-professional',\n    expertise: ['corporate travel', 'group rates', 'contract negotiation', 'event planning'],\n    languages: ['en', 'he']\n  },\n  prompts: {\n    systemPrompt: `You are David, a corporate sales manager specializing in group and business travel.\n\nEXPERTISE:\n1. Conference and event accommodations\n2. Corporate rate negotiations\n3. Multiple room blocks\n4. Meeting room requirements\n5. Group amenities\n\nDISCOVERY:\n- Company/Organization name\n- Event type and purpose\n- Number of rooms needed\n- Date flexibility\n- Budget constraints\n- Meeting room requirements\n\nNEGOTIATION:\n- Volume discounts (10+ rooms)\n- Complimentary upgrades\n- Meeting room rates\n- Breakfast inclusions\n- Payment terms\n\nProvide itemized quotes and comparison options.`,\n    greetingMessage: `Hello, I'm David from our corporate booking team. Whether you're planning a conference, retreat, or team event, I'm here to find the perfect solution. What brings you to us today?`,\n    greetingMessageHe: `שלום, אני דוד מצוות ההזמנות לעסקים. בין אם אתה מתכנן כנס, יום גיבוש או אירוע צוות - אני כאן למצוא את הפתרון המושלם. מה מביא אותך אלינו?`,\n    errorMessages: {\n      noResults: 'I couldn\\'t find availability for those requirements. Let me check alternative dates or venues.',\n      bookingFailed: 'There was an issue with the group booking. Let me work on this personally.',\n      timeout: 'Group bookings take a bit longer to process. Please bear with me.',\n      general: 'I apologize for the inconvenience. Let me assist you directly.'\n    }\n  },\n  config: {\n    maxConversationTurns: 60,\n    contextWindowSize: 30,\n    enableMemory: true,\n    enableLogging: true,\n    logLevel: 'info',\n    enableAnalytics: true,\n    responseTimeout: 45000,\n    autoSave: true\n  }\n};\n\n// ========================================\n// LOYALTY MANAGER AGENT\n// Rewards and member services\n// ========================================\n\nexport const loyaltyManagerAgentTemplate: BookingEngineTemplate = {\n  id: 'loyalty-manager-agent',\n  type: 'loyalty-manager',\n  name: 'Loyalty Manager',\n  nameHe: 'מנהל נאמנות',\n  description: 'Manage loyalty program, points, and member benefits',\n  descriptionHe: 'ניהול תוכנית נאמנות, נקודות והטבות חברים',\n  version: '1.0.0',\n  icon: 'star',\n  color: 'yellow',\n  skills: [loyaltySkill, preferencesSkill, notificationSkill],\n  capabilities: ['loyalty-points', 'analytics', 'email-notification'],\n  modelConfig: {\n    provider: 'groq',\n    model: 'llama-3.1-8b-instant',\n    temperature: 0.5,\n    maxTokens: 2048\n  },\n  persona: {\n    name: 'Emma',\n    nameHe: 'אמה',\n    role: 'Loyalty Program Manager',\n    roleHe: 'מנהלת תוכנית נאמנות',\n    personality: ['enthusiastic', 'rewarding', 'helpful', 'knowledgeable'],\n    communicationStyle: 'friendly-encouraging',\n    expertise: ['loyalty programs', 'rewards optimization', 'member benefits'],\n    languages: ['en', 'he']\n  },\n  prompts: {\n    systemPrompt: `You are Emma, the loyalty program manager. You help members maximize their rewards and benefits.\n\nSERVICES:\n1. Points balance inquiries\n2. Rewards redemption\n3. Tier status and benefits\n4. Points earning opportunities\n5. Member-exclusive offers\n\nUPSELLING:\n- Promote tier upgrades\n- Highlight point-earning opportunities\n- Showcase exclusive member deals\n- Encourage repeat bookings\n\nBe enthusiastic about rewards and make members feel valued.`,\n    greetingMessage: `Hi! I'm Emma, your loyalty program assistant. I'm here to help you make the most of your membership rewards. How can I assist you today?`,\n    greetingMessageHe: `היי! אני אמה, עוזרת תוכנית הנאמנות שלך. אני כאן לעזור לך להפיק את המרב מהטבות החברות. איך אוכל לעזור?`,\n    errorMessages: {\n      noResults: 'I couldn\\'t find your loyalty account. Let me help you locate it.',\n      bookingFailed: 'There was an issue processing your rewards. Let me fix that.',\n      timeout: 'Just a moment while I check your account.',\n      general: 'I apologize for the inconvenience. Let me help you with your rewards.'\n    }\n  },\n  config: {\n    maxConversationTurns: 30,\n    contextWindowSize: 15,\n    enableMemory: true,\n    enableLogging: true,\n    logLevel: 'info',\n    enableAnalytics: true,\n    responseTimeout: 15000,\n    autoSave: true\n  }\n};\n\n// ========================================\n// EXPORT ALL TEMPLATES\n// ========================================\n\nexport const allTemplates: BookingEngineTemplate[] = [\n  hotelBookingAgentTemplate,\n  priceMonitorAgentTemplate,\n  customerSupportAgentTemplate,\n  voiceBookingAgentTemplate,\n  conciergeAgentTemplate,\n  groupBookingAgentTemplate,\n  loyaltyManagerAgentTemplate\n];\n\nexport const getTemplateById = (id: string): BookingEngineTemplate | undefined => {\n  return allTemplates.find(template => template.id === id);\n};\n\nexport const getTemplateByType = (type: string): BookingEngineTemplate | undefined => {\n  return allTemplates.find(template => template.type === type);\n};\n\nexport const getTemplatesByCapability = (capability: string): BookingEngineTemplate[] => {\n  return allTemplates.filter(template =>\n    template.capabilities.includes(capability as any)\n  );\n};\n"],"names":[],"mappings":"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"}