module.exports=[18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},71515,(e,t,r)=>{"use strict";t.exports=e.r(18622)},94424,(e,t,r)=>{"use strict";t.exports=e.r(71515).vendored["react-rsc"].React},24361,(e,t,r)=>{t.exports=e.x("util",()=>require("util"))},21517,(e,t,r)=>{t.exports=e.x("http",()=>require("http"))},24836,(e,t,r)=>{t.exports=e.x("https",()=>require("https"))},92509,(e,t,r)=>{t.exports=e.x("url",()=>require("url"))},6461,(e,t,r)=>{t.exports=e.x("zlib",()=>require("zlib"))},81111,(e,t,r)=>{t.exports=e.x("node:stream",()=>require("node:stream"))},88947,(e,t,r)=>{t.exports=e.x("stream",()=>require("stream"))},77416,e=>{"use strict";var t=e.i(19919),r=e.i(64969),s=e.i(26226),o=e.i(81191),a=e.i(15744),n=e.i(30880),i=e.i(3407),l=e.i(57026),u=e.i(27942),p=e.i(64733),c=e.i(24230),d=e.i(38973),h=e.i(82177),g=e.i(93101),m=e.i(53963),x=e.i(81585),f=e.i(93695);e.i(67096);var v=e.i(7771),R=e.i(48682),w=e.i(38748),y=e.i(68184);class T{tools=new Map;version="1.0.0";lastUpdated=new Date().toISOString();progressListeners=new Map;constructor(){this.initializeTools()}initializeTools(){for(let e of w.allSkills)for(let t of e.tools){let e={name:t.name,description:t.description,inputSchema:this.convertToJsonSchema(t.parameters),handler:t.handler};this.tools.set(t.name,e)}console.log(`[MCP] Initialized ${this.tools.size} hotel booking tools`)}convertToJsonSchema(e){let t={},r=[];for(let s of e)t[s.name]={type:s.type,description:s.description},s.enum&&(t[s.name].enum=s.enum),void 0!==s.default&&(t[s.name].default=s.default),s.required&&r.push(s.name);return{type:"object",properties:t,required:r}}getTools(){return Array.from(this.tools.values())}getTool(e){return this.tools.get(e)}onProgress(e,t){return this.progressListeners.has(e)||this.progressListeners.set(e,[]),this.progressListeners.get(e).push(t),()=>{let r=this.progressListeners.get(e);if(r){let e=r.indexOf(t);e>-1&&r.splice(e,1)}}}emitProgress(e,t){let r={...t,timestamp:new Date().toISOString()};for(let t of this.progressListeners.get(e)||[])try{t(r)}catch(e){console.error("[MCP] Progress listener error:",e)}}async execute(e){let t=Date.now(),{tool:r,parameters:s,sessionId:o="default",userId:a}=e;if(!this.tools.get(r))return{success:!1,data:null,error:`Tool not found: ${r}`,toolVersion:this.version};try{this.emitProgress(o,{type:"progress",tool:r,step:"starting",progress:0,message:`Starting ${r}...`});let e=await (0,y.executeTool)(r,s,{sessionId:o,engineType:"mcp",history:[],currentState:"executing",language:"en",userPreferences:{},metadata:{userId:a,source:"mcp"}});return this.emitProgress(o,{type:"complete",tool:r,step:"done",progress:100,message:`Completed ${r}`,data:e.success?e.data:null}),{success:e.success,data:e.data,error:e.error,executionTime:Date.now()-t,toolVersion:this.version}}catch(e){return this.emitProgress(o,{type:"error",tool:r,step:"failed",message:e.message||"Tool execution failed"}),{success:!1,data:null,error:e.message||"Tool execution failed",executionTime:Date.now()-t,toolVersion:this.version}}}async executeParallel(e){let t=e[0]?.sessionId||"default";this.emitProgress(t,{type:"progress",tool:"batch",step:"starting",progress:0,message:`Executing ${e.length} tools in parallel...`});let r=await Promise.all(e.map((r,s)=>this.execute(r).then(o=>(this.emitProgress(t,{type:"progress",tool:"batch",step:`completed-${s+1}`,progress:Math.round((s+1)/e.length*100),message:`Completed ${r.tool} (${s+1}/${e.length})`}),o))));return this.emitProgress(t,{type:"complete",tool:"batch",step:"done",progress:100,message:`All ${e.length} tools completed`}),r}reloadTools(){this.tools.clear(),this.initializeTools(),this.lastUpdated=new Date().toISOString(),console.log(`[MCP] Tools reloaded at ${this.lastUpdated}`)}getServerInfo(){return{name:"hotel-booking-ai",version:this.version,toolCount:this.tools.size,lastUpdated:this.lastUpdated,capabilities:["tool-execution","parallel-execution","progress-streaming","hot-reload"]}}}let E=new T;async function P(e){let t=e.nextUrl.searchParams,r=t.get("action");try{if("tools"===r)return R.NextResponse.json({success:!0,tools:E.getTools()});if("tool"===r){let e=t.get("name");if(!e)return R.NextResponse.json({success:!1,error:"Tool name required"},{status:400});let r=E.getTool(e);if(!r)return R.NextResponse.json({success:!1,error:"Tool not found"},{status:404});return R.NextResponse.json({success:!0,tool:r})}return R.NextResponse.json({success:!0,server:E.getServerInfo()})}catch(e){return R.NextResponse.json({success:!1,error:e.message},{status:500})}}async function b(e){try{let{action:t,tools:r,tool:s,parameters:o,sessionId:a,userId:n,stream:i}=await e.json();if("execute-parallel"===t&&Array.isArray(r)){let e=r.map(e=>({tool:e.tool||e.name,parameters:e.parameters||{},sessionId:a,userId:n})),t=await E.executeParallel(e);return R.NextResponse.json({success:!0,results:t})}if(s){let e=await E.execute({tool:s,parameters:o||{},sessionId:a,userId:n});return R.NextResponse.json(e)}if("reload"===t)return E.reloadTools(),R.NextResponse.json({success:!0,message:"Tools reloaded",server:E.getServerInfo()});return R.NextResponse.json({success:!1,error:"Invalid request. Provide tool name or action."},{status:400})}catch(e){return R.NextResponse.json({success:!1,error:e.message},{status:500})}}e.s(["GET",()=>P,"POST",()=>b],10315);var C=e.i(10315);let S=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/mcp/hotel-booking/route",pathname:"/api/mcp/hotel-booking",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/mcp/hotel-booking/route.ts",nextConfigOutput:"",userland:C}),{workAsyncStorage:N,workUnitAsyncStorage:A,serverHooks:j}=S;function k(){return(0,s.patchFetch)({workAsyncStorage:N,workUnitAsyncStorage:A})}async function q(e,t,s){S.isDev&&(0,o.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let R="/api/mcp/hotel-booking/route";R=R.replace(/\/index$/,"")||"/";let w=await S.prepare(e,t,{srcPage:R,multiZoneDraftMode:!1});if(!w)return t.statusCode=400,t.end("Bad Request"),null==s.waitUntil||s.waitUntil.call(s,Promise.resolve()),null;let{buildId:y,params:T,nextConfig:E,parsedUrl:P,isDraftMode:b,prerenderManifest:C,routerServerContext:N,isOnDemandRevalidate:A,revalidateOnlyGenerated:j,resolvedPathname:k,clientReferenceManifest:q,serverActionsManifest:O}=w,I=(0,l.normalizeAppPath)(R),_=!!(C.dynamicRoutes[I]||C.routes[k]),M=async()=>((null==N?void 0:N.render404)?await N.render404(e,t,P,!1):t.end("This page could not be found"),null);if(_&&!b){let e=!!C.routes[k],t=C.dynamicRoutes[I];if(t&&!1===t.fallback&&!e){if(E.experimental.adapterPath)return await M();throw new f.NoFallbackError}}let U=null;!_||S.isDev||b||(U="/index"===(U=k)?"/":U);let $=!0===S.isDev||!_,D=_&&!$;O&&q&&(0,n.setReferenceManifestsSingleton)({page:R,clientReferenceManifest:q,serverActionsManifest:O,serverModuleMap:(0,i.createServerModuleMap)({serverActionsManifest:O})});let H=e.method||"GET",L=(0,a.getTracer)(),z=L.getActiveScopeSpan(),F={params:T,prerenderManifest:C,renderOpts:{experimental:{authInterrupts:!!E.experimental.authInterrupts},cacheComponents:!!E.cacheComponents,supportsDynamicResponse:$,incrementalCache:(0,o.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:E.cacheLife,waitUntil:s.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,s)=>S.onRequestError(e,t,s,N)},sharedContext:{buildId:y}},K=new u.NodeNextRequest(e),V=new u.NodeNextResponse(t),B=p.NextRequestAdapter.fromNodeNextRequest(K,(0,p.signalFromNodeResponse)(t));try{let n=async e=>S.handle(B,F).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=L.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let s=r.get("next.route");if(s){let t=`${H} ${s}`;e.setAttributes({"next.route":s,"http.route":s,"next.span_name":t}),e.updateName(t)}else e.updateName(`${H} ${R}`)}),i=!!(0,o.getRequestMeta)(e,"minimalMode"),l=async o=>{var a,l;let u=async({previousCacheEntry:r})=>{try{if(!i&&A&&j&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let a=await n(o);e.fetchMetrics=F.renderOpts.fetchMetrics;let l=F.renderOpts.pendingWaitUntil;l&&s.waitUntil&&(s.waitUntil(l),l=void 0);let u=F.renderOpts.collectedTags;if(!_)return await (0,h.sendResponse)(K,V,a,F.renderOpts.pendingWaitUntil),null;{let e=await a.blob(),t=(0,g.toNodeOutgoingHttpHeaders)(a.headers);u&&(t[x.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==F.renderOpts.collectedRevalidate&&!(F.renderOpts.collectedRevalidate>=x.INFINITE_CACHE)&&F.renderOpts.collectedRevalidate,s=void 0===F.renderOpts.collectedExpire||F.renderOpts.collectedExpire>=x.INFINITE_CACHE?void 0:F.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:a.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:s}}}}catch(t){throw(null==r?void 0:r.isStale)&&await S.onRequestError(e,t,{routerKind:"App Router",routePath:R,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:D,isOnDemandRevalidate:A})},N),t}},p=await S.handleResponse({req:e,nextConfig:E,cacheKey:U,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:C,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:j,responseGenerator:u,waitUntil:s.waitUntil,isMinimalMode:i});if(!_)return null;if((null==p||null==(a=p.value)?void 0:a.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==p||null==(l=p.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});i||t.setHeader("x-nextjs-cache",A?"REVALIDATED":p.isMiss?"MISS":p.isStale?"STALE":"HIT"),b&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let c=(0,g.fromNodeOutgoingHttpHeaders)(p.value.headers);return i&&_||c.delete(x.NEXT_CACHE_TAGS_HEADER),!p.cacheControl||t.getHeader("Cache-Control")||c.get("Cache-Control")||c.set("Cache-Control",(0,m.getCacheControlHeader)(p.cacheControl)),await (0,h.sendResponse)(K,V,new Response(p.value.body,{headers:c,status:p.value.status||200})),null};z?await l(z):await L.withPropagatedContext(e.headers,()=>L.trace(c.BaseServerSpan.handleRequest,{spanName:`${H} ${R}`,kind:a.SpanKind.SERVER,attributes:{"http.method":H,"http.target":e.url}},l))}catch(t){if(t instanceof f.NoFallbackError||await S.onRequestError(e,t,{routerKind:"App Router",routePath:I,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:D,isOnDemandRevalidate:A})}),_)throw t;return await (0,h.sendResponse)(K,V,new Response(null,{status:500})),null}}e.s(["handler",()=>q,"patchFetch",()=>k,"routeModule",()=>S,"serverHooks",()=>j,"workAsyncStorage",()=>N,"workUnitAsyncStorage",()=>A],77416)},48989,e=>{e.v(t=>Promise.all(["server/chunks/[root-of-the-server]__1841b7e0._.js"].map(t=>e.l(t))).then(()=>t(66017)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__9918e0e9._.js.map