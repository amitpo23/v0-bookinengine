{"version":3,"sources":["../../../../v0-bookinengine/node_modules/next/src/server/route-modules/app-page/module.compiled.js","../../../../v0-bookinengine/node_modules/next/src/server/route-modules/app-page/vendored/rsc/react.ts","../../../../v0-bookinengine/node_modules/next-auth/providers/google.js","../../../../v0-bookinengine/lib/auth.ts"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-rsc']!.React\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = Google;\nfunction Google(options) {\n  return {\n    id: \"google\",\n    name: \"Google\",\n    type: \"oauth\",\n    wellKnown: \"https://accounts.google.com/.well-known/openid-configuration\",\n    authorization: {\n      params: {\n        scope: \"openid email profile\"\n      }\n    },\n    idToken: true,\n    checks: [\"pkce\", \"state\"],\n    profile(profile) {\n      return {\n        id: profile.sub,\n        name: profile.name,\n        email: profile.email,\n        image: profile.picture\n      };\n    },\n    style: {\n      logo: \"/google.svg\",\n      bg: \"#fff\",\n      text: \"#000\"\n    },\n    options\n  };\n}","import { NextAuthOptions } from 'next-auth'\r\nimport GoogleProvider from 'next-auth/providers/google'\r\nimport { supabaseAdmin } from './supabase'\r\n\r\nexport const authOptions: NextAuthOptions = {\r\n  providers: [\r\n    GoogleProvider({\r\n      clientId: process.env.GOOGLE_CLIENT_ID!,\r\n      clientSecret: process.env.GOOGLE_CLIENT_SECRET!,\r\n    }),\r\n  ],\r\n\r\n  callbacks: {\r\n    async signIn({ user, account }) {\r\n      if (!user.email) return false\r\n\r\n      try {\r\n        // Check if user exists in Supabase\r\n        const { data: existingUser } = await supabaseAdmin\r\n          .from('users')\r\n          .select('*')\r\n          .eq('email', user.email)\r\n          .single()\r\n\r\n        if (!existingUser) {\r\n          // Create new user in Supabase\r\n          await supabaseAdmin.from('users').insert({\r\n            email: user.email,\r\n            name: user.name,\r\n            image: user.image,\r\n            google_id: account?.providerAccountId,\r\n          })\r\n        } else {\r\n          // Update existing user\r\n          await supabaseAdmin\r\n            .from('users')\r\n            .update({\r\n              name: user.name,\r\n              image: user.image,\r\n              google_id: account?.providerAccountId,\r\n            })\r\n            .eq('email', user.email)\r\n        }\r\n\r\n        return true\r\n      } catch (error) {\r\n        console.error('Error in signIn callback:', error)\r\n        return false\r\n      }\r\n    },\r\n\r\n    async session({ session, token }) {\r\n      if (session.user) {\r\n        // Fetch additional user data from Supabase\r\n        const { data: userData } = await supabaseAdmin\r\n          .from('users')\r\n          .select('*')\r\n          .eq('email', session.user.email)\r\n          .single()\r\n\r\n        if (userData) {\r\n          session.user.id = userData.id\r\n          session.user.address = userData.address\r\n          session.user.city = userData.city\r\n          session.user.phone = userData.phone\r\n        }\r\n      }\r\n\r\n      return session\r\n    },\r\n  },\r\n\r\n  pages: {\r\n    signIn: '/', // Redirect to home page for sign in\r\n    error: '/', // Error page\r\n  },\r\n\r\n  session: {\r\n    strategy: 'jwt',\r\n  },\r\n\r\n  secret: process.env.NEXTAUTH_SECRET,\r\n}\r\n\r\n// Extend NextAuth types\r\ndeclare module 'next-auth' {\r\n  interface Session {\r\n    user: {\r\n      id: string\r\n      name?: string | null\r\n      email?: string | null\r\n      image?: string | null\r\n      phone?: string | null\r\n      address?: string | null\r\n      city?: string | null\r\n    }\r\n  }\r\n}\r\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","vendored","React"],"mappings":"43BA0BQG,EAAOC,OAAO,CAAGC,EAAQ,CAAA,CAAA,IAAA,gCC1BjCF,GAAOC,OAAO,CACZC,EAAQ,CAAA,CAAA,IAAA,GACRI,QAAQ,CAAC,YAAY,CAAEC,KAAK,mcCA9B,OAAO,cAAc,CAAC,EAAS,aAAc,CAC3C,OAAO,CACT,GACA,EAAQ,OAAO,CACf,EADkB,OACT,AAAO,CAAO,EACrB,MAAO,CACL,GAAI,SACJ,KAAM,SACN,KAAM,QACN,UAAW,+DACX,cAAe,CACb,OAAQ,CACN,MAAO,sBACT,CACF,EACA,SAAS,EACT,OAAQ,CAAC,OAAQ,QAAQ,SACzB,AAAQ,IACC,CACL,EAFW,CAEP,EAAQ,GAAG,CACf,KAAM,EAAQ,IAAI,CAClB,MAAO,EAAQ,KAAK,CACpB,MAAO,EAAQ,OAAO,CACxB,EAEF,MAAO,CACL,KAAM,cACN,GAAI,OACJ,KAAM,MACR,UACA,CACF,CACF,0BCjCA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEO,IAAM,EAA+B,CAC1C,UAAW,CACT,CAAA,EAAA,EAAA,OAAA,AAAc,EAAC,CACb,SAAU,QAAQ,GAAG,CAAC,gBAAgB,CACtC,aAAc,QAAQ,GAAG,CAAC,oBAAoB,AAChD,GACD,CAED,UAAW,CACT,MAAM,OAAO,MAAE,CAAI,SAAE,CAAO,CAAE,EAC5B,GAAI,CAAC,EAAK,KAAK,CAAE,MAAO,GAExB,GAAI,CAEF,GAAM,CAAE,KAAM,CAAY,CAAE,CAAG,MAAM,EAAA,aAAa,CAC/C,IAAI,CAAC,SACL,MAAM,CAAC,KACP,EAAE,CAAC,QAAS,EAAK,KAAK,EACtB,MAAM,GAsBT,OApBK,EAUH,MAAM,EAAA,IAVW,SAUE,CAChB,IAAI,CAAC,SACL,MAAM,CAAC,CACN,KAAM,EAAK,IAAI,CACf,MAAO,EAAK,KAAK,CACjB,UAAW,GAAS,iBACtB,GACC,EAAE,CAAC,QAAS,EAAK,KAAK,EAfzB,MAAM,EAAA,aAAa,CAAC,IAAI,CAAC,SAAS,MAAM,CAAC,CACvC,MAAO,EAAK,KAAK,CACjB,KAAM,EAAK,IAAI,CACf,MAAO,EAAK,KAAK,CACjB,UAAW,GAAS,iBACtB,IAaK,CACT,CAAE,MAAO,EAAO,CAEd,OADA,QAAQ,KAAK,CAAC,4BAA6B,IACpC,CACT,CACF,EAEA,MAAM,QAAQ,SAAE,CAAO,OAAE,CAAK,CAAE,EAC9B,GAAI,EAAQ,IAAI,CAAE,CAEhB,GAAM,CAAE,KAAM,CAAQ,CAAE,CAAG,MAAM,EAAA,aAAa,CAC3C,IAAI,CAAC,SACL,MAAM,CAAC,KACP,EAAE,CAAC,QAAS,EAAQ,IAAI,CAAC,KAAK,EAC9B,MAAM,GAEL,IACF,EAAQ,IAAI,AADA,CACC,EAAE,CAAG,EAAS,EAAE,CAC7B,EAAQ,IAAI,CAAC,OAAO,CAAG,EAAS,OAAO,CACvC,EAAQ,IAAI,CAAC,IAAI,CAAG,EAAS,IAAI,CACjC,EAAQ,IAAI,CAAC,KAAK,CAAG,EAAS,KAAK,CAEvC,CAEA,OAAO,CACT,CACF,EAEA,MAAO,CACL,OAAQ,IACR,MAAO,GACT,EAEA,QAAS,CACP,SAAU,KACZ,EAEA,OAAQ,QAAQ,GAAG,CAAC,eAAe,AACrC","ignoreList":[0,1,2]}