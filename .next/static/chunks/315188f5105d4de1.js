(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,2664,e=>{"use strict";var s=e.i(843476),t=e.i(271645),a=e.i(127341),l=e.i(167881),i=e.i(23750),n=e.i(10708),r=e.i(630374),c=e.i(62870),d=e.i(184762),o=e.i(319036),m=e.i(994179),x=e.i(970065),u=e.i(107233),h=e.i(788699),j=e.i(727612),v=e.i(174886),g=e.i(555436),p=e.i(751975),f=e.i(87316),N=e.i(217923),_=e.i(247167),b=e.i(988715);let y="https://wsmchexmtiijufemzzwu.supabase.co",w=(0,b.createClient)(y,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndzbWNoZXhtdGlpanVmZW16end1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQxNzI0ODIsImV4cCI6MjA3OTc0ODQ4Mn0.SWdtLvTaopbs2UDNmzpbA3g9O9hgIG3Tei4J8IRV-sY");y&&_.default.env.SUPABASE_SERVICE_ROLE_KEY&&(0,b.createClient)(y,_.default.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}});var S=e.i(401851);function C(){let[e,a]=(0,t.useState)([]),[_,b]=(0,t.useState)(!0),[y,C]=(0,t.useState)(""),[I,L]=(0,t.useState)(!1),[T,D]=(0,t.useState)(null),[k,B]=(0,t.useState)({code:"",description:"",discount_type:"percentage",discount_value:10,min_purchase_amount:"",max_discount_amount:"",usage_limit:"",valid_from:(0,S.format)(new Date,"yyyy-MM-dd"),valid_until:"",is_active:!0,applicable_templates:[]});(0,t.useEffect)(()=>{M()},[]);let M=async()=>{try{let{data:e,error:s}=await w.from("promo_codes").select("*").order("created_at",{ascending:!1});if(s)throw s;a(e||[])}catch(e){console.error("Error loading promo codes:",e)}finally{b(!1)}},z=async()=>{try{let e={code:k.code.toUpperCase(),description:k.description,discount_type:k.discount_type,discount_value:k.discount_value,min_purchase_amount:k.min_purchase_amount?parseFloat(k.min_purchase_amount):null,max_discount_amount:k.max_discount_amount?parseFloat(k.max_discount_amount):null,usage_limit:k.usage_limit?parseInt(k.usage_limit):null,valid_from:new Date(k.valid_from).toISOString(),valid_until:k.valid_until?new Date(k.valid_until).toISOString():null,is_active:k.is_active,applicable_templates:k.applicable_templates.length>0?k.applicable_templates:null};if(T){let{error:s}=await w.from("promo_codes").update(e).eq("id",T.id);if(s)throw s}else{let{error:s}=await w.from("promo_codes").insert(e);if(s)throw s}await M(),L(!1),V()}catch(e){console.error("Error saving promo code:",e),alert("×©×’×™××” ×‘×©××™×¨×ª ×§×•×“ ×¤×¨×•××•: "+e.message)}},O=async e=>{if(confirm("×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ×§×•×“ ×¤×¨×•××• ×–×”?"))try{let{error:s}=await w.from("promo_codes").delete().eq("id",e);if(s)throw s;await M()}catch(e){console.error("Error deleting promo code:",e),alert("×©×’×™××” ×‘××—×™×§×ª ×§×•×“ ×¤×¨×•××•")}},V=()=>{D(null),B({code:"",description:"",discount_type:"percentage",discount_value:10,min_purchase_amount:"",max_discount_amount:"",usage_limit:"",valid_from:(0,S.format)(new Date,"yyyy-MM-dd"),valid_until:"",is_active:!0,applicable_templates:[]})},E=e.filter(e=>e.code.toLowerCase().includes(y.toLowerCase())||e.description.toLowerCase().includes(y.toLowerCase()));return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,s.jsx)(p.Tag,{className:"h-6 w-6"}),"×§×•×“×™ ×¤×¨×•××•"]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"× ×™×”×•×œ ×§×•×“×™ ×”× ×—×” ×•××‘×¦×¢×™×"})]}),(0,s.jsxs)(l.Button,{onClick:()=>{V(),L(!0)},className:"gap-2",children:[(0,s.jsx)(u.Plus,{className:"h-4 w-4"}),"×§×•×“ ×¤×¨×•××• ×—×“×©"]})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(g.Search,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(i.Input,{placeholder:"×—×™×¤×•×© ×œ×¤×™ ×§×•×“ ××• ×ª×™××•×¨...",value:y,onChange:e=>C(e.target.value),className:"pr-10"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsxs)(x.Card,{className:"p-4",children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:'×¡×”"×› ×§×•×“×™×'}),(0,s.jsx)("div",{className:"text-2xl font-bold mt-1",children:e.length})]}),(0,s.jsxs)(x.Card,{className:"p-4",children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"×§×•×“×™× ×¤×¢×™×œ×™×"}),(0,s.jsx)("div",{className:"text-2xl font-bold mt-1 text-green-600",children:e.filter(e=>e.is_active).length})]}),(0,s.jsxs)(x.Card,{className:"p-4",children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:'×¡×”"×› ×©×™××•×©×™×'}),(0,s.jsx)("div",{className:"text-2xl font-bold mt-1",children:e.reduce((e,s)=>e+s.usage_count,0)})]}),(0,s.jsxs)(x.Card,{className:"p-4",children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"×¤×’×™ ×ª×•×§×£"}),(0,s.jsx)("div",{className:"text-2xl font-bold mt-1 text-red-600",children:e.filter(e=>e.valid_until&&new Date(e.valid_until)<new Date).length})]})]}),(0,s.jsx)("div",{className:"space-y-3",children:_?(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"×˜×•×¢×Ÿ..."}):0===E.length?(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:y?"×œ× × ××¦××• ×ª×•×¦××•×ª":"××™×Ÿ ×§×•×“×™ ×¤×¨×•××• ×¢×“×™×™×Ÿ"}):E.map(e=>{let t=e.valid_until&&new Date(e.valid_until)<new Date,a=e.usage_limit&&e.usage_count>=e.usage_limit;return(0,s.jsx)(x.Card,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,s.jsx)("code",{className:"text-lg font-bold bg-muted px-3 py-1 rounded",children:e.code}),(0,s.jsx)(m.Badge,{variant:e.is_active&&!t?"default":"secondary",children:e.is_active?t?"×¤×’ ×ª×•×§×£":"×¤×¢×™×œ":"×œ× ×¤×¢×™×œ"}),"percentage"===e.discount_type?(0,s.jsxs)(m.Badge,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:[e.discount_value,"% ×”× ×—×”"]}):(0,s.jsxs)(m.Badge,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[e.discount_value,"â‚ª ×”× ×—×”"]}),a&&(0,s.jsx)(m.Badge,{variant:"outline",className:"bg-red-50 text-red-700 border-red-200",children:"××’×‘×œ×” ×”×•×©×’×”"})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(f.Calendar,{className:"h-3 w-3"}),(0,S.format)(new Date(e.valid_from),"dd/MM/yyyy"),e.valid_until&&` - ${(0,S.format)(new Date(e.valid_until),"dd/MM/yyyy")}`]}),(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(N.BarChart3,{className:"h-3 w-3"}),"×©×™××•×©×™×: ",e.usage_count,e.usage_limit&&` / ${e.usage_limit}`]}),e.min_purchase_amount&&(0,s.jsxs)("span",{children:["××™× ×™××•×: ",e.min_purchase_amount,"â‚ª"]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>{var s;return s=e.code,void(navigator.clipboard.writeText(s),alert(`×§×•×“ ${s} ×”×•×¢×ª×§ ×œ×œ×•×—`))},title:"×”×¢×ª×§ ×§×•×“",children:(0,s.jsx)(v.Copy,{className:"h-4 w-4"})}),(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>{D(e),B({code:e.code,description:e.description,discount_type:e.discount_type,discount_value:e.discount_value,min_purchase_amount:e.min_purchase_amount?.toString()||"",max_discount_amount:e.max_discount_amount?.toString()||"",usage_limit:e.usage_limit?.toString()||"",valid_from:(0,S.format)(new Date(e.valid_from),"yyyy-MM-dd"),valid_until:e.valid_until?(0,S.format)(new Date(e.valid_until),"yyyy-MM-dd"):"",is_active:e.is_active,applicable_templates:e.applicable_templates||[]}),L(!0)},title:"×¢×¨×•×š",children:(0,s.jsx)(h.Pencil,{className:"h-4 w-4"})}),(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>O(e.id),title:"××—×§",className:"text-red-600 hover:text-red-700",children:(0,s.jsx)(j.Trash2,{className:"h-4 w-4"})})]})]})},e.id)})}),(0,s.jsx)(r.Dialog,{open:I,onOpenChange:L,children:(0,s.jsxs)(r.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)(r.DialogHeader,{children:[(0,s.jsx)(r.DialogTitle,{children:T?"×¢×¨×™×›×ª ×§×•×“ ×¤×¨×•××•":"×§×•×“ ×¤×¨×•××• ×—×“×©"}),(0,s.jsx)(r.DialogDescription,{children:"×”×–×Ÿ ××ª ×¤×¨×˜×™ ×§×•×“ ×”×¤×¨×•××• ×•×ª× ××™ ×”×©×™××•×©"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{children:"×§×•×“ *"}),(0,s.jsx)(i.Input,{placeholder:"SUMMER20",value:k.code,onChange:e=>B({...k,code:e.target.value.toUpperCase()}),maxLength:20})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{children:"×¡×•×’ ×”× ×—×” *"}),(0,s.jsxs)(c.Select,{value:k.discount_type,onValueChange:e=>B({...k,discount_type:e}),children:[(0,s.jsx)(c.SelectTrigger,{children:(0,s.jsx)(c.SelectValue,{})}),(0,s.jsxs)(c.SelectContent,{children:[(0,s.jsx)(c.SelectItem,{value:"percentage",children:"××—×•×– (%)"}),(0,s.jsx)(c.SelectItem,{value:"fixed",children:"×¡×›×•× ×§×‘×•×¢ (â‚ª)"})]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{children:"×ª×™××•×¨ *"}),(0,s.jsx)(d.Textarea,{placeholder:"×”× ×—×ª ×§×™×¥ 20%",value:k.description,onChange:e=>B({...k,description:e.target.value}),rows:2})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(n.Label,{children:["×¢×¨×š ×”× ×—×” * (","percentage"===k.discount_type?"%":"â‚ª",")"]}),(0,s.jsx)(i.Input,{type:"number",min:"0",value:k.discount_value,onChange:e=>B({...k,discount_value:parseFloat(e.target.value)})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{children:"××’×‘×œ×ª ×©×™××•×©×™× (××•×¤×¦×™×•× ×œ×™)"}),(0,s.jsx)(i.Input,{type:"number",min:"0",placeholder:"×œ×œ× ×”×’×‘×œ×”",value:k.usage_limit,onChange:e=>B({...k,usage_limit:e.target.value})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{children:"×¡×›×•× ×§× ×™×™×” ××™× ×™××œ×™ (â‚ª)"}),(0,s.jsx)(i.Input,{type:"number",min:"0",placeholder:"0",value:k.min_purchase_amount,onChange:e=>B({...k,min_purchase_amount:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{children:"×”× ×—×” ××§×¡×™××œ×™×ª (â‚ª)"}),(0,s.jsx)(i.Input,{type:"number",min:"0",placeholder:"×œ×œ× ×”×’×‘×œ×”",value:k.max_discount_amount,onChange:e=>B({...k,max_discount_amount:e.target.value})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{children:"×ª×•×§×£ ×- *"}),(0,s.jsx)(i.Input,{type:"date",value:k.valid_from,onChange:e=>B({...k,valid_from:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{children:"×ª×•×§×£ ×¢×“ (××•×¤×¦×™×•× ×œ×™)"}),(0,s.jsx)(i.Input,{type:"date",value:k.valid_until,onChange:e=>B({...k,valid_until:e.target.value})})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o.Switch,{checked:k.is_active,onCheckedChange:e=>B({...k,is_active:e})}),(0,s.jsx)(n.Label,{children:"×§×•×“ ×¤×¢×™×œ"})]}),(0,s.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,s.jsx)(l.Button,{onClick:z,className:"flex-1",children:T?"×¢×“×›×Ÿ":"×¦×•×¨ ×§×•×“ ×¤×¨×•××•"}),(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>L(!1),children:"×‘×™×˜×•×œ"})]})]})]})})]})}var I=e.i(243553),L=e.i(25652),T=e.i(761911),D=e.i(212426),k=e.i(263488),B=e.i(343432);let M={bronze:{label:"Bronze",color:"bg-orange-100 text-orange-700 border-orange-300",gradient:"from-orange-400 to-orange-600",nextTier:"Silver",nextAmount:2e3},silver:{label:"Silver",color:"bg-gray-200 text-gray-700 border-gray-400",gradient:"from-gray-400 to-gray-600",nextTier:"Gold",nextAmount:5e3},gold:{label:"Gold",color:"bg-yellow-100 text-yellow-700 border-yellow-400",gradient:"from-yellow-400 to-yellow-600",nextTier:"Platinum",nextAmount:1e4},platinum:{label:"Platinum",color:"bg-purple-100 text-purple-700 border-purple-400",gradient:"from-purple-400 to-purple-600",nextTier:null,nextAmount:null}};function z(){let[e,a]=(0,t.useState)([]),[n,d]=(0,t.useState)(!0),[o,u]=(0,t.useState)(""),[h,j]=(0,t.useState)("all"),[v,p]=(0,t.useState)(null),[f,N]=(0,t.useState)(!1);(0,t.useEffect)(()=>{_()},[]);let _=async()=>{try{let{data:e,error:s}=await w.from("loyalty_members").select("*").order("total_spent",{ascending:!1});if(s)throw s;a(e||[])}catch(e){console.error("Error loading loyalty members:",e)}finally{d(!1)}},b=async(e,s)=>{if(confirm("×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ×©×“×¨×’ ×—×‘×¨ ×–×” ×‘××•×¤×Ÿ ×™×“× ×™?"))try{let{error:t}=await w.from("loyalty_members").update({membership_tier:s,discount_percentage:{bronze:5,silver:10,gold:15,platinum:20}[s]}).eq("id",e);if(t)throw t;await _(),alert("×“×¨×’×ª ×”×—×‘×¨ ×¢×•×“×›× ×” ×‘×”×¦×œ×—×”!")}catch(e){console.error("Error upgrading tier:",e),alert("×©×’×™××” ×‘×©×“×¨×•×’ ×“×¨×’×”")}},y=e.filter(e=>{let s=e.email.toLowerCase().includes(o.toLowerCase())||e.first_name?.toLowerCase().includes(o.toLowerCase())||e.last_name?.toLowerCase().includes(o.toLowerCase()),t="all"===h||e.membership_tier===h;return s&&t}),C={total:e.length,active:e.filter(e=>e.is_active).length,totalBookings:e.reduce((e,s)=>e+s.total_bookings,0),totalRevenue:e.reduce((e,s)=>e+s.total_spent,0),bronze:e.filter(e=>"bronze"===e.membership_tier).length,silver:e.filter(e=>"silver"===e.membership_tier).length,gold:e.filter(e=>"gold"===e.membership_tier).length,platinum:e.filter(e=>"platinum"===e.membership_tier).length};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,s.jsx)(I.Crown,{className:"h-6 w-6 text-yellow-500"}),"××•×¢×“×•×Ÿ ×œ×§×•×—×•×ª"]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"× ×™×”×•×œ ×—×‘×¨×™ ××•×¢×“×•×Ÿ ×•××¢×§×‘ ××—×¨ ×”×˜×‘×•×ª"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsx)(x.Card,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:'×¡×”"×› ×—×‘×¨×™×'}),(0,s.jsx)("div",{className:"text-2xl font-bold mt-1",children:C.total})]}),(0,s.jsx)(T.Users,{className:"h-8 w-8 text-muted-foreground/30"})]})}),(0,s.jsx)(x.Card,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"×”×–×× ×•×ª"}),(0,s.jsx)("div",{className:"text-2xl font-bold mt-1",children:C.totalBookings})]}),(0,s.jsx)(L.TrendingUp,{className:"h-8 w-8 text-muted-foreground/30"})]})}),(0,s.jsx)(x.Card,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"×”×›× ×¡×•×ª"}),(0,s.jsxs)("div",{className:"text-2xl font-bold mt-1",children:[C.totalRevenue.toLocaleString(),"â‚ª"]})]}),(0,s.jsx)(D.DollarSign,{className:"h-8 w-8 text-muted-foreground/30"})]})}),(0,s.jsxs)(x.Card,{className:"p-4",children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground mb-2",children:"×”×ª×¤×œ×’×•×ª ×“×¨×’×•×ª"}),(0,s.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"ğŸ¥‰ Bronze"}),(0,s.jsx)("span",{className:"font-semibold",children:C.bronze})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"ğŸ¥ˆ Silver"}),(0,s.jsx)("span",{className:"font-semibold",children:C.silver})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"ğŸ¥‡ Gold"}),(0,s.jsx)("span",{className:"font-semibold",children:C.gold})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"ğŸ’ Platinum"}),(0,s.jsx)("span",{className:"font-semibold",children:C.platinum})]})]})]})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)(g.Search,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(i.Input,{placeholder:"×—×™×¤×•×© ×œ×¤×™ ×©× ××• ××™××™×™×œ...",value:o,onChange:e=>u(e.target.value),className:"pr-10"})]}),(0,s.jsxs)(c.Select,{value:h,onValueChange:j,children:[(0,s.jsx)(c.SelectTrigger,{className:"w-[180px]",children:(0,s.jsx)(c.SelectValue,{placeholder:"×›×œ ×”×“×¨×’×•×ª"})}),(0,s.jsxs)(c.SelectContent,{children:[(0,s.jsx)(c.SelectItem,{value:"all",children:"×›×œ ×”×“×¨×’×•×ª"}),(0,s.jsx)(c.SelectItem,{value:"bronze",children:"ğŸ¥‰ Bronze"}),(0,s.jsx)(c.SelectItem,{value:"silver",children:"ğŸ¥ˆ Silver"}),(0,s.jsx)(c.SelectItem,{value:"gold",children:"ğŸ¥‡ Gold"}),(0,s.jsx)(c.SelectItem,{value:"platinum",children:"ğŸ’ Platinum"})]})]})]}),(0,s.jsx)("div",{className:"space-y-3",children:n?(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"×˜×•×¢×Ÿ..."}):0===y.length?(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:o||"all"!==h?"×œ× × ××¦××• ×ª×•×¦××•×ª":"××™×Ÿ ×—×‘×¨×™ ××•×¢×“×•×Ÿ ×¢×“×™×™×Ÿ"}):y.map(e=>{let t=M[e.membership_tier],a=t.nextAmount?e.total_spent/t.nextAmount*100:100;return(0,s.jsx)(x.Card,{className:"p-4 cursor-pointer hover:bg-accent/50 transition-colors",onClick:()=>{p(e),N(!0)},children:(0,s.jsx)("div",{className:"flex items-start justify-between gap-4",children:(0,s.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-semibold",children:e.first_name&&e.last_name?`${e.first_name} ${e.last_name}`:e.email}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[(0,s.jsx)(k.Mail,{className:"h-3 w-3"}),e.email]}),e.phone&&(0,s.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[(0,s.jsx)(B.Phone,{className:"h-3 w-3"}),e.phone]})]}),(0,s.jsxs)(m.Badge,{variant:"outline",className:t.color,children:[(0,s.jsx)(I.Crown,{className:"h-3 w-3 mr-1"}),t.label]}),(0,s.jsxs)(m.Badge,{variant:"secondary",children:[e.discount_percentage,"% ×”× ×—×”"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-muted-foreground",children:"×”×–×× ×•×ª"}),(0,s.jsx)("div",{className:"font-semibold",children:e.total_bookings})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-muted-foreground",children:"×”×•×¦××•×ª"}),(0,s.jsxs)("div",{className:"font-semibold",children:[e.total_spent.toLocaleString(),"â‚ª"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-muted-foreground",children:"× ×§×•×“×•×ª"}),(0,s.jsx)("div",{className:"font-semibold",children:e.points.toLocaleString()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-muted-foreground",children:"×”×–×× ×” ××—×¨×•× ×”"}),(0,s.jsx)("div",{className:"font-semibold text-xs",children:e.last_booking_at?(0,S.format)(new Date(e.last_booking_at),"dd/MM/yy"):"-"})]})]}),t.nextTier&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground mb-1",children:[(0,s.jsxs)("span",{children:["×”×ª×§×“××•×ª ×œ-",t.nextTier]}),(0,s.jsxs)("span",{children:[e.total_spent.toLocaleString()," /"," ",t.nextAmount?.toLocaleString(),"â‚ª"]})]}),(0,s.jsx)("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:`h-full bg-gradient-to-r ${t.gradient}`,style:{width:`${Math.min(a,100)}%`}})})]})]})})},e.id)})}),v&&(0,s.jsx)(r.Dialog,{open:f,onOpenChange:N,children:(0,s.jsxs)(r.DialogContent,{className:"max-w-md",children:[(0,s.jsxs)(r.DialogHeader,{children:[(0,s.jsx)(r.DialogTitle,{children:"×¤×¨×˜×™ ×—×‘×¨ ××•×¢×“×•×Ÿ"}),(0,s.jsxs)(r.DialogDescription,{children:[v.first_name," ",v.last_name]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"××™×“×¢ ××™×©×™"}),(0,s.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"××™××™×™×œ:"}),(0,s.jsx)("span",{children:v.email})]}),v.phone&&(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"×˜×œ×¤×•×Ÿ:"}),(0,s.jsx)("span",{children:v.phone})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"×—×‘×¨ ×××–:"}),(0,s.jsx)("span",{children:(0,S.format)(new Date(v.created_at),"dd/MM/yyyy")})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"×“×¨×’×ª ×—×‘×¨×•×ª"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(m.Badge,{className:M[v.membership_tier].color,children:M[v.membership_tier].label}),(0,s.jsxs)("span",{className:"text-sm",children:[v.discount_percentage,"% ×”× ×—×”"]})]}),(0,s.jsxs)(c.Select,{value:v.membership_tier,onValueChange:e=>b(v.id,e),children:[(0,s.jsx)(c.SelectTrigger,{children:(0,s.jsx)(c.SelectValue,{})}),(0,s.jsxs)(c.SelectContent,{children:[(0,s.jsx)(c.SelectItem,{value:"bronze",children:"ğŸ¥‰ Bronze (5%)"}),(0,s.jsx)(c.SelectItem,{value:"silver",children:"ğŸ¥ˆ Silver (10%)"}),(0,s.jsx)(c.SelectItem,{value:"gold",children:"ğŸ¥‡ Gold (15%)"}),(0,s.jsx)(c.SelectItem,{value:"platinum",children:"ğŸ’ Platinum (20%)"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"×¡×˜×˜×™×¡×˜×™×§×•×ª"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)(x.Card,{className:"p-3",children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"×”×–×× ×•×ª"}),(0,s.jsx)("div",{className:"text-xl font-bold",children:v.total_bookings})]}),(0,s.jsxs)(x.Card,{className:"p-3",children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"× ×§×•×“×•×ª"}),(0,s.jsx)("div",{className:"text-xl font-bold",children:v.points})]}),(0,s.jsxs)(x.Card,{className:"p-3 col-span-2",children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:'×¡×”"×› ×”×•×¦××•×ª'}),(0,s.jsxs)("div",{className:"text-xl font-bold",children:[v.total_spent.toLocaleString(),"â‚ª"]})]})]})]}),(0,s.jsx)(l.Button,{variant:"outline",className:"w-full",onClick:()=>N(!1),children:"×¡×’×•×¨"})]})]})})]})}var O=e.i(475254);let V=(0,O.default)("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),E=(0,O.default)("MousePointer",[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]]);var A=e.i(269638),R=e.i(248256),U=e.i(826707),P=e.i(951445);function G(){let[e,a]=(0,t.useState)([]),[l,i]=(0,t.useState)(!0),[n,r]=(0,t.useState)("7"),[d,o]=(0,t.useState)("all");(0,t.useEffect)(()=>{u()},[n]);let u=async()=>{try{let e=new Date;e.setDate(e.getDate()-parseInt(n));let s=w.from("affiliate_tracking").select("*").gte("created_at",e.toISOString()).order("created_at",{ascending:!1}),{data:t,error:l}=await s;if(l)throw l;a(t||[])}catch(e){console.error("Error loading affiliate tracking:",e)}finally{i(!1)}},h="all"===d?e:e.filter(e=>e.utm_source===d),j={totalVisits:h.length,conversions:h.filter(e=>e.converted).length,conversionRate:h.length>0?h.filter(e=>e.converted).length/h.length*100:0,totalRevenue:h.reduce((e,s)=>e+(s.conversion_value||0),0),totalCommission:h.reduce((e,s)=>e+(s.commission_amount||0),0),avgOrderValue:h.filter(e=>e.converted).length>0?h.reduce((e,s)=>e+(s.conversion_value||0),0)/h.filter(e=>e.converted).length:0},v=h.reduce((e,s)=>{let t=s.utm_source||"direct";return e[t]||(e[t]={visits:0,conversions:0,revenue:0}),e[t].visits++,s.converted&&(e[t].conversions++,e[t].revenue+=s.conversion_value||0),e},{}),g=h.reduce((e,s)=>{let t=s.utm_campaign||"no-campaign";return e[t]||(e[t]={visits:0,conversions:0,revenue:0}),e[t].visits++,s.converted&&(e[t].conversions++,e[t].revenue+=s.conversion_value||0),e},{}),p=h.reduce((e,s)=>{let t=s.device_type||"unknown";return e[t]=(e[t]||0)+1,e},{}),f=Array.from(new Set(e.map(e=>e.utm_source).filter(Boolean)));return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,s.jsx)(V,{className:"h-6 w-6"}),"Affiliate Analytics"]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"××¢×§×‘ ××—×¨ ××§×•×¨×•×ª ×”×¤× ×™×” ×•×”××¨×•×ª"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(c.Select,{value:d,onValueChange:o,children:[(0,s.jsx)(c.SelectTrigger,{className:"w-[150px]",children:(0,s.jsx)(c.SelectValue,{placeholder:"×›×œ ×”××§×•×¨×•×ª"})}),(0,s.jsxs)(c.SelectContent,{children:[(0,s.jsx)(c.SelectItem,{value:"all",children:"×›×œ ×”××§×•×¨×•×ª"}),f.map(e=>(0,s.jsx)(c.SelectItem,{value:e,children:e},e))]})]}),(0,s.jsxs)(c.Select,{value:n,onValueChange:r,children:[(0,s.jsx)(c.SelectTrigger,{className:"w-[150px]",children:(0,s.jsx)(c.SelectValue,{})}),(0,s.jsxs)(c.SelectContent,{children:[(0,s.jsx)(c.SelectItem,{value:"1",children:"24 ×©×¢×•×ª"}),(0,s.jsx)(c.SelectItem,{value:"7",children:"7 ×™××™×"}),(0,s.jsx)(c.SelectItem,{value:"30",children:"30 ×™××™×"}),(0,s.jsx)(c.SelectItem,{value:"90",children:"90 ×™××™×"}),(0,s.jsx)(c.SelectItem,{value:"365",children:"×©× ×”"})]})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[(0,s.jsx)(x.Card,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"×‘×™×§×•×¨×™×"}),(0,s.jsx)("div",{className:"text-2xl font-bold mt-1",children:j.totalVisits})]}),(0,s.jsx)(E,{className:"h-8 w-8 text-muted-foreground/30"})]})}),(0,s.jsx)(x.Card,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"×”××¨×•×ª"}),(0,s.jsx)("div",{className:"text-2xl font-bold mt-1 text-green-600",children:j.conversions})]}),(0,s.jsx)(A.CheckCircle,{className:"h-8 w-8 text-green-600/30"})]})}),(0,s.jsx)(x.Card,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"×©×™×¢×•×¨ ×”××¨×”"}),(0,s.jsxs)("div",{className:"text-2xl font-bold mt-1",children:[j.conversionRate.toFixed(1),"%"]})]}),(0,s.jsx)(L.TrendingUp,{className:"h-8 w-8 text-muted-foreground/30"})]})}),(0,s.jsx)(x.Card,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"×”×›× ×¡×•×ª"}),(0,s.jsxs)("div",{className:"text-2xl font-bold mt-1",children:[j.totalRevenue.toLocaleString(),"â‚ª"]})]}),(0,s.jsx)(D.DollarSign,{className:"h-8 w-8 text-muted-foreground/30"})]})}),(0,s.jsx)(x.Card,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"×¢××œ×•×ª"}),(0,s.jsxs)("div",{className:"text-2xl font-bold mt-1 text-blue-600",children:[j.totalCommission.toLocaleString(),"â‚ª"]})]}),(0,s.jsx)(D.DollarSign,{className:"h-8 w-8 text-blue-600/30"})]})}),(0,s.jsx)(x.Card,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"×××•×¦×¢ ×”×–×× ×”"}),(0,s.jsxs)("div",{className:"text-2xl font-bold mt-1",children:[j.avgOrderValue.toLocaleString(),"â‚ª"]})]}),(0,s.jsx)(T.Users,{className:"h-8 w-8 text-muted-foreground/30"})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)(x.Card,{className:"p-6",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,s.jsx)(R.Globe,{className:"h-5 w-5"}),"××§×•×¨×•×ª ×ª× ×•×¢×” ××•×‘×™×œ×™×"]}),(0,s.jsxs)("div",{className:"space-y-3",children:[Object.entries(v).sort((e,s)=>s[1].visits-e[1].visits).slice(0,5).map(([e,t])=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-medium capitalize",children:e}),(0,s.jsxs)(m.Badge,{variant:"secondary",className:"text-xs",children:[t.visits," ×‘×™×§×•×¨×™×"]})]}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:[t.conversions," ×”××¨×•×ª (",(t.conversions/t.visits*100).toFixed(1),"%)"]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("div",{className:"font-semibold",children:[t.revenue.toLocaleString(),"â‚ª"]}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"×”×›× ×¡×•×ª"})]})]},e)),0===Object.keys(v).length&&(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"××™×Ÿ × ×ª×•× ×™× ×œ×”×¦×’×”"})]})]}),(0,s.jsxs)(x.Card,{className:"p-6",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,s.jsx)(L.TrendingUp,{className:"h-5 w-5"}),"×§××¤×™×™× ×™× ××•×‘×™×œ×™×"]}),(0,s.jsxs)("div",{className:"space-y-3",children:[Object.entries(g).sort((e,s)=>s[1].revenue-e[1].revenue).slice(0,5).map(([e,t])=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-medium",children:"no-campaign"===e?"×œ×œ× ×§××¤×™×™×Ÿ":e}),(0,s.jsx)(m.Badge,{variant:"secondary",className:"text-xs",children:t.visits})]}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:[t.conversions," ×”××¨×•×ª"]})]}),(0,s.jsx)("div",{className:"text-right",children:(0,s.jsxs)("div",{className:"font-semibold",children:[t.revenue.toLocaleString(),"â‚ª"]})})]},e)),0===Object.keys(g).length&&(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"××™×Ÿ × ×ª×•× ×™× ×œ×”×¦×’×”"})]})]})]}),(0,s.jsxs)(x.Card,{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"×¤×™×œ×•×— ×œ×¤×™ ××›×©×™×¨"}),(0,s.jsx)("div",{className:"grid grid-cols-3 gap-4",children:Object.entries(p).map(([e,t])=>{let a=t/j.totalVisits*100;return(0,s.jsxs)("div",{className:"text-center",children:["mobile"===e?(0,s.jsx)(U.Smartphone,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}):(0,s.jsx)(P.Monitor,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),(0,s.jsx)("div",{className:"text-2xl font-bold",children:t}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground capitalize",children:[e," (",a.toFixed(1),"%)"]})]},e)})})]}),(0,s.jsxs)(x.Card,{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"×¤×¢×™×œ×•×ª ××—×¨×•× ×”"}),(0,s.jsx)("div",{className:"space-y-3",children:l?(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"×˜×•×¢×Ÿ..."}):0===h.length?(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"××™×Ÿ × ×ª×•× ×™× ×œ×”×¦×’×”"}):h.slice(0,10).map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,s.jsx)(m.Badge,{variant:"outline",className:"capitalize",children:e.utm_source||"direct"}),e.utm_medium&&(0,s.jsx)(m.Badge,{variant:"secondary",children:e.utm_medium}),e.utm_campaign&&(0,s.jsx)(m.Badge,{variant:"secondary",children:e.utm_campaign}),e.converted&&(0,s.jsx)(m.Badge,{className:"bg-green-600",children:"×”××™×¨ âœ“"})]}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:[(0,S.format)(new Date(e.created_at),"dd/MM/yyyy HH:mm")," â€¢"," ",e.device_type||"unknown"," â€¢ ",e.browser||"unknown"]})]}),e.converted&&e.conversion_value&&(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("div",{className:"font-semibold",children:[e.conversion_value.toLocaleString(),"â‚ª"]}),e.commission_amount&&(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:["×¢××œ×”: ",e.commission_amount.toLocaleString(),"â‚ª"]})]})]},e.id))})]})]})}function F(){let[e,l]=(0,t.useState)("promo");return(0,s.jsxs)("div",{className:"container mx-auto p-6",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"××¢×¨×›×•×ª ×©×™×•×•×§ ×•××›×™×¨×•×ª"}),(0,s.jsx)("p",{className:"text-muted-foreground mt-2",children:"× ×™×”×•×œ ×§×•×“×™ ×¤×¨×•××•, ××•×¢×“×•×Ÿ ×œ×§×•×—×•×ª ×•-Affiliate tracking"})]}),(0,s.jsxs)(a.Tabs,{value:e,onValueChange:l,children:[(0,s.jsxs)(a.TabsList,{className:"grid w-full grid-cols-3 mb-6",children:[(0,s.jsxs)(a.TabsTrigger,{value:"promo",className:"flex items-center gap-2",children:[(0,s.jsx)(p.Tag,{className:"h-4 w-4"}),"×§×•×“×™ ×¤×¨×•××•"]}),(0,s.jsxs)(a.TabsTrigger,{value:"loyalty",className:"flex items-center gap-2",children:[(0,s.jsx)(I.Crown,{className:"h-4 w-4"}),"××•×¢×“×•×Ÿ ×œ×§×•×—×•×ª"]}),(0,s.jsxs)(a.TabsTrigger,{value:"affiliate",className:"flex items-center gap-2",children:[(0,s.jsx)(V,{className:"h-4 w-4"}),"Affiliate"]})]}),(0,s.jsx)(a.TabsContent,{value:"promo",children:(0,s.jsx)(C,{})}),(0,s.jsx)(a.TabsContent,{value:"loyalty",children:(0,s.jsx)(z,{})}),(0,s.jsx)(a.TabsContent,{value:"affiliate",children:(0,s.jsx)(G,{})})]})]})}e.s(["MarketingDashboard",()=>F],2664)}]);