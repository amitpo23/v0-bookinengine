module.exports=[73934,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.VERSION=void 0,r.VERSION="0.37.0"},56665,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setShims=r.isFsReadStream=r.fileFromPath=r.getDefaultAgent=r.getMultipartRequestOptions=r.ReadableStream=r.File=r.Blob=r.FormData=r.Headers=r.Response=r.Request=r.fetch=r.kind=r.auto=void 0,r.auto=!1,r.kind=void 0,r.fetch=void 0,r.Request=void 0,r.Response=void 0,r.Headers=void 0,r.FormData=void 0,r.Blob=void 0,r.File=void 0,r.ReadableStream=void 0,r.getMultipartRequestOptions=void 0,r.getDefaultAgent=void 0,r.fileFromPath=void 0,r.isFsReadStream=void 0,r.setShims=function(e,t={auto:!1}){if(r.auto)throw Error(`you must \`import 'groq-sdk/shims/${e.kind}'\` before importing anything else from groq-sdk`);if(r.kind)throw Error(`can't \`import 'groq-sdk/shims/${e.kind}'\` after \`import 'groq-sdk/shims/${r.kind}'\``);r.auto=t.auto,r.kind=e.kind,r.fetch=e.fetch,r.Request=e.Request,r.Response=e.Response,r.Headers=e.Headers,r.FormData=e.FormData,r.Blob=e.Blob,r.File=e.File,r.ReadableStream=e.ReadableStream,r.getMultipartRequestOptions=e.getMultipartRequestOptions,r.getDefaultAgent=e.getDefaultAgent,r.fileFromPath=e.fileFromPath,r.isFsReadStream=e.isFsReadStream}},82959,(e,t,r)=>{e.e,function(e){"use strict";let t,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol:e=>`Symbol(${e})`;function o(){}function n(e){return"object"==typeof e&&null!==e||"function"==typeof e}function i(e,t){try{Object.defineProperty(e,"name",{value:t,configurable:!0})}catch(e){}}let a=Promise,s=Promise.prototype.then,l=Promise.resolve.bind(a),u=Promise.reject.bind(a);function c(e){return new a(e)}function d(e,t,r){return s.call(e,t,r)}function f(e,t,r){d(d(e,t,r),void 0,o)}function h(e){d(e,void 0,o)}let p=e=>{if("function"==typeof queueMicrotask)p=queueMicrotask;else{let e=l(void 0);p=t=>d(e,t)}return p(e)};function b(e,t,r){if("function"!=typeof e)throw TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,r)}function y(e,t,r){try{var o;return o=b(e,t,r),l(o)}catch(e){return u(e)}}class m{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(e){let t=this._back,r=t;16383===t._elements.length&&(r={_elements:[],_next:void 0}),t._elements.push(e),r!==t&&(this._back=r,t._next=r),++this._size}shift(){let e=this._front,t=e,r=this._cursor,o=r+1,n=e._elements,i=n[r];return 16384===o&&(t=e._next,o=0),--this._size,this._cursor=o,e!==t&&(this._front=t),n[r]=void 0,i}forEach(e){let t=this._cursor,r=this._front,o=r._elements;for(;!(t===o.length&&void 0===r._next||t===o.length&&(o=(r=r._next)._elements,t=0,0===o.length));)e(o[t]),++t}peek(){let e=this._front,t=this._cursor;return e._elements[t]}}let _=r("[[AbortSteps]]"),g=r("[[ErrorSteps]]"),v=r("[[CancelSteps]]"),w=r("[[PullSteps]]"),S=r("[[ReleaseSteps]]");function R(e,t){var r,o;e._ownerReadableStream=t,t._reader=e,"readable"===t._state?T(e):"closed"===t._state?(T(e),j(e)):(r=e,o=t._storedError,T(r),A(r,o))}function P(e,t){return tE(e._ownerReadableStream,t)}function E(e){var t,r;let o=e._ownerReadableStream;"readable"===o._state?A(e,TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):(t=e,r=TypeError("Reader was released and can no longer be used to monitor the stream's closedness"),T(t),A(t,r)),o._readableStreamController[S](),o._reader=void 0,e._ownerReadableStream=void 0}function O(e){return TypeError("Cannot "+e+" a stream using a released reader")}function T(e){e._closedPromise=c((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r})}function A(e,t){void 0!==e._closedPromise_reject&&(h(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function j(e){void 0!==e._closedPromise_resolve&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}let q=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},C=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function k(e,t){var r;if(void 0!==e&&"object"!=typeof(r=e)&&"function"!=typeof r)throw TypeError(`${t} is not an object.`)}function F(e,t){if("function"!=typeof e)throw TypeError(`${t} is not a function.`)}function M(e,t){if(("object"!=typeof e||null===e)&&"function"!=typeof e)throw TypeError(`${t} is not an object.`)}function x(e,t,r){if(void 0===e)throw TypeError(`Parameter ${t} is required in '${r}'.`)}function I(e,t,r){if(void 0===e)throw TypeError(`${t} is required in '${r}'.`)}function B(e){return Number(e)}function L(e,t){var r,o;let n=Number.MAX_SAFE_INTEGER,i=Number(e);if(!q(i=0===(r=i)?0:r))throw TypeError(`${t} is not a finite number`);if((i=0===(o=C(i))?0:o)<0||i>n)throw TypeError(`${t} is outside the accepted range of 0 to ${n}, inclusive`);return q(i)&&0!==i?i:0}function W(e){if(!n(e)||"function"!=typeof e.getReader)return!1;try{return"boolean"==typeof e.locked}catch(e){return!1}}function $(e){if(!n(e)||"function"!=typeof e.getWriter)return!1;try{return"boolean"==typeof e.locked}catch(e){return!1}}function D(e,t){if(!tR(e))throw TypeError(`${t} is not a ReadableStream.`)}function N(e,t){e._reader._readRequests.push(t)}function z(e,t,r){let o=e._reader._readRequests.shift();r?o._closeSteps():o._chunkSteps(t)}function H(e){return e._reader._readRequests.length}function U(e){let t=e._reader;return void 0!==t&&!!G(t)}class V{constructor(e){if(x(e,1,"ReadableStreamDefaultReader"),D(e,"First parameter"),tP(e))throw TypeError("This stream has already been locked for exclusive reading by another reader");R(this,e),this._readRequests=new m}get closed(){return G(this)?this._closedPromise:u(Q("closed"))}cancel(e){return G(this)?void 0===this._ownerReadableStream?u(O("cancel")):P(this,e):u(Q("cancel"))}read(){var e;let t,r,o;if(!G(this))return u(Q("read"));if(void 0===this._ownerReadableStream)return u(O("read from"));let n=c((e,o)=>{t=e,r=o});return e={_chunkSteps:e=>t({value:e,done:!1}),_closeSteps:()=>t({value:void 0,done:!0}),_errorSteps:e=>r(e)},(o=this._ownerReadableStream)._disturbed=!0,"closed"===o._state?e._closeSteps():"errored"===o._state?e._errorSteps(o._storedError):o._readableStreamController[w](e),n}releaseLock(){if(!G(this))throw Q("releaseLock");void 0!==this._ownerReadableStream&&(E(this),X(this,TypeError("Reader was released")))}}function G(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readRequests")&&e instanceof V}function X(e,t){let r=e._readRequests;e._readRequests=new m,r.forEach(e=>{e._errorSteps(t)})}function Q(e){return TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}Object.defineProperties(V.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),i(V.prototype.cancel,"cancel"),i(V.prototype.read,"read"),i(V.prototype.releaseLock,"releaseLock"),"symbol"==typeof r.toStringTag&&Object.defineProperty(V.prototype,r.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});class K{constructor(e,t){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=e,this._preventCancel=t}next(){let e=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?d(this._ongoingPromise,e,e):e(),this._ongoingPromise}return(e){let t=()=>this._returnSteps(e);return this._ongoingPromise?d(this._ongoingPromise,t,t):t()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let e=this._reader;return void 0===e?u(O("iterate")):d(e.read(),e=>{var t;return this._ongoingPromise=void 0,e.done&&(this._isFinished=!0,null==(t=this._reader)||t.releaseLock(),this._reader=void 0),e},e=>{var t;throw this._ongoingPromise=void 0,this._isFinished=!0,null==(t=this._reader)||t.releaseLock(),this._reader=void 0,e})}_returnSteps(e){if(this._isFinished)return Promise.resolve({value:e,done:!0});this._isFinished=!0;let t=this._reader;if(void 0===t)return u(O("finish iterating"));if(this._reader=void 0,!this._preventCancel){let r=t.cancel(e);return t.releaseLock(),d(r,()=>({value:e,done:!0}),void 0)}return t.releaseLock(),l({value:e,done:!0})}}let Y={next(){return J(this)?this._asyncIteratorImpl.next():u(Z("next"))},return(e){return J(this)?this._asyncIteratorImpl.return(e):u(Z("return"))}};function J(e){if(!n(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof K}catch(e){return!1}}function Z(e){return TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}"symbol"==typeof r.asyncIterator&&Object.defineProperty(Y,r.asyncIterator,{value(){return this},writable:!0,configurable:!0});let ee=Number.isNaN||function(e){return e!=e};function et(e,t,r,o,n){new Uint8Array(e).set(new Uint8Array(r,o,n),t)}function er(e){return new Uint8Array(function(e,t,r){if(e.slice)return e.slice(t,r);let o=r-t,n=new ArrayBuffer(o);return et(n,0,e,t,o),n}(e.buffer,e.byteOffset,e.byteOffset+e.byteLength))}function eo(e){let t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function en(e,t,r){if("number"!=typeof r||ee(r)||r<0||r===1/0)throw RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:r}),e._queueTotalSize+=r}function ei(e){e._queue=new m,e._queueTotalSize=0}class ea{constructor(){throw TypeError("Illegal constructor")}get view(){if(!eu(this))throw eA("view");return this._view}respond(e){if(!eu(this))throw eA("respond");if(x(e,1,"respond"),e=L(e,"First parameter"),void 0===this._associatedReadableByteStreamController)throw TypeError("This BYOB request has been invalidated");this._view.buffer,function(e,t){let r=e._pendingPullIntos.peek();if("closed"===e._controlledReadableByteStream._state){if(0!==t)throw TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(0===t)throw TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(r.bytesFilled+t>r.byteLength)throw RangeError("bytesWritten out of range")}r.buffer=r.buffer,eS(e,t)}(this._associatedReadableByteStreamController,e)}respondWithNewView(e){if(!eu(this))throw eA("respondWithNewView");if(x(e,1,"respondWithNewView"),!ArrayBuffer.isView(e))throw TypeError("You can only respond with array buffer views");if(void 0===this._associatedReadableByteStreamController)throw TypeError("This BYOB request has been invalidated");e.buffer,function(e,t){let r=e._pendingPullIntos.peek();if("closed"===e._controlledReadableByteStream._state){if(0!==t.byteLength)throw TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(0===t.byteLength)throw TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(r.byteOffset+r.bytesFilled!==t.byteOffset)throw RangeError("The region specified by view does not match byobRequest");if(r.bufferByteLength!==t.buffer.byteLength)throw RangeError("The buffer of view has different capacity than byobRequest");if(r.bytesFilled+t.byteLength>r.byteLength)throw RangeError("The region specified by view is larger than byobRequest");let o=t.byteLength;r.buffer=t.buffer,eS(e,o)}(this._associatedReadableByteStreamController,e)}}Object.defineProperties(ea.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),i(ea.prototype.respond,"respond"),i(ea.prototype.respondWithNewView,"respondWithNewView"),"symbol"==typeof r.toStringTag&&Object.defineProperty(ea.prototype,r.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class es{constructor(){throw TypeError("Illegal constructor")}get byobRequest(){if(!el(this))throw ej("byobRequest");return function(e){if(null===e._byobRequest&&e._pendingPullIntos.length>0){let t=e._pendingPullIntos.peek(),r=new Uint8Array(t.buffer,t.byteOffset+t.bytesFilled,t.byteLength-t.bytesFilled),o=Object.create(ea.prototype);o._associatedReadableByteStreamController=e,o._view=r,e._byobRequest=o}return e._byobRequest}(this)}get desiredSize(){if(!el(this))throw ej("desiredSize");return eT(this)}close(){if(!el(this))throw ej("close");if(this._closeRequested)throw TypeError("The stream has already been closed; do not close it again!");let e=this._controlledReadableByteStream._state;if("readable"!==e)throw TypeError(`The stream (in ${e} state) is not in the readable state and cannot be closed`);!function(e){let t=e._controlledReadableByteStream;if(!e._closeRequested&&"readable"===t._state){if(e._queueTotalSize>0)return e._closeRequested=!0;if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){let t=TypeError("Insufficient bytes to fill elements in the given buffer");throw eE(e,t),t}eP(e),tO(t)}}(this)}enqueue(e){if(!el(this))throw ej("enqueue");if(x(e,1,"enqueue"),!ArrayBuffer.isView(e))throw TypeError("chunk must be an array buffer view");if(0===e.byteLength)throw TypeError("chunk must have non-zero byteLength");if(0===e.buffer.byteLength)throw TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw TypeError("stream is closed or draining");let t=this._controlledReadableByteStream._state;if("readable"!==t)throw TypeError(`The stream (in ${t} state) is not in the readable state and cannot be enqueued to`);!function(e,t){let r=e._controlledReadableByteStream;if(e._closeRequested||"readable"!==r._state)return;let o=t.buffer,n=t.byteOffset,i=t.byteLength;if(e._pendingPullIntos.length>0){let t=e._pendingPullIntos.peek();t.buffer,ev(e),t.buffer=t.buffer,"none"===t.readerType&&ey(e,t)}U(r)?(function(e){let t=e._controlledReadableByteStream._reader;for(;t._readRequests.length>0;){if(0===e._queueTotalSize)return;eO(e,t._readRequests.shift())}}(e),0===H(r))?ep(e,o,n,i):(e._pendingPullIntos.length>0&&eR(e),z(r,new Uint8Array(o,n,i),!1)):ek(r)?(ep(e,o,n,i),ew(e)):ep(e,o,n,i),ec(e)}(this,e)}error(e){if(!el(this))throw ej("error");eE(this,e)}[v](e){ed(this),ei(this);let t=this._cancelAlgorithm(e);return eP(this),t}[w](e){let t=this._controlledReadableByteStream;if(this._queueTotalSize>0)return void eO(this,e);let r=this._autoAllocateChunkSize;if(void 0!==r){let t;try{t=new ArrayBuffer(r)}catch(t){return void e._errorSteps(t)}let o={buffer:t,bufferByteLength:r,byteOffset:0,byteLength:r,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(o)}N(t,e),ec(this)}[S](){if(this._pendingPullIntos.length>0){let e=this._pendingPullIntos.peek();e.readerType="none",this._pendingPullIntos=new m,this._pendingPullIntos.push(e)}}}function el(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")&&e instanceof es}function eu(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")&&e instanceof ea}function ec(e){let t;if("readable"===(t=e._controlledReadableByteStream)._state&&!e._closeRequested&&e._started&&(U(t)&&H(t)>0||ek(t)&&eC(t)>0||eT(e)>0)){if(e._pulling)return void(e._pullAgain=!0);e._pulling=!0,f(e._pullAlgorithm(),()=>(e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,ec(e)),null),t=>(eE(e,t),null))}}function ed(e){ev(e),e._pendingPullIntos=new m}function ef(e,t){var r;let o,n=!1;"closed"===e._state&&(n=!0);let i=eh(t);"default"===t.readerType?z(e,i,n):(r=n,o=e._reader._readIntoRequests.shift(),r?o._closeSteps(i):o._chunkSteps(i))}function eh(e){let t=e.bytesFilled,r=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/r)}function ep(e,t,r,o){e._queue.push({buffer:t,byteOffset:r,byteLength:o}),e._queueTotalSize+=o}function eb(e,t,r,o){let n;try{n=t.slice(r,r+o)}catch(t){throw eE(e,t),t}ep(e,n,0,o)}function ey(e,t){t.bytesFilled>0&&eb(e,t.buffer,t.byteOffset,t.bytesFilled),eR(e)}function em(e,t){let r=t.elementSize,o=t.bytesFilled-t.bytesFilled%r,n=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),i=t.bytesFilled+n,a=i-i%r,s=n,l=!1;a>o&&(s=a-t.bytesFilled,l=!0);let u=e._queue;for(;s>0;){let r=u.peek(),o=Math.min(s,r.byteLength),n=t.byteOffset+t.bytesFilled;et(t.buffer,n,r.buffer,r.byteOffset,o),r.byteLength===o?u.shift():(r.byteOffset+=o,r.byteLength-=o),e._queueTotalSize-=o,e_(e,o,t),s-=o}return l}function e_(e,t,r){r.bytesFilled+=t}function eg(e){0===e._queueTotalSize&&e._closeRequested?(eP(e),tO(e._controlledReadableByteStream)):ec(e)}function ev(e){null!==e._byobRequest&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function ew(e){for(;e._pendingPullIntos.length>0;){if(0===e._queueTotalSize)return;let t=e._pendingPullIntos.peek();em(e,t)&&(eR(e),ef(e._controlledReadableByteStream,t))}}function eS(e,t){let r=e._pendingPullIntos.peek();ev(e),"closed"===e._controlledReadableByteStream._state?function(e,t){"none"===t.readerType&&eR(e);let r=e._controlledReadableByteStream;if(ek(r))for(;eC(r)>0;)ef(r,eR(e))}(e,r):function(e,t,r){if(e_(0,t,r),"none"===r.readerType)return ey(e,r),ew(e);if(r.bytesFilled<r.elementSize)return;eR(e);let o=r.bytesFilled%r.elementSize;if(o>0){let t=r.byteOffset+r.bytesFilled;eb(e,r.buffer,t-o,o)}r.bytesFilled-=o,ef(e._controlledReadableByteStream,r),ew(e)}(e,t,r),ec(e)}function eR(e){return e._pendingPullIntos.shift()}function eP(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function eE(e,t){let r=e._controlledReadableByteStream;"readable"===r._state&&(ed(e),ei(e),eP(e),tT(r,t))}function eO(e,t){let r=e._queue.shift();e._queueTotalSize-=r.byteLength,eg(e);let o=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);t._chunkSteps(o)}function eT(e){let t=e._controlledReadableByteStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function eA(e){return TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function ej(e){return TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function eq(e,t){e._reader._readIntoRequests.push(t)}function eC(e){return e._reader._readIntoRequests.length}function ek(e){let t=e._reader;return void 0!==t&&!!eM(t)}Object.defineProperties(es.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),i(es.prototype.close,"close"),i(es.prototype.enqueue,"enqueue"),i(es.prototype.error,"error"),"symbol"==typeof r.toStringTag&&Object.defineProperty(es.prototype,r.toStringTag,{value:"ReadableByteStreamController",configurable:!0});class eF{constructor(e){if(x(e,1,"ReadableStreamBYOBReader"),D(e,"First parameter"),tP(e))throw TypeError("This stream has already been locked for exclusive reading by another reader");if(!el(e._readableStreamController))throw TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");R(this,e),this._readIntoRequests=new m}get closed(){return eM(this)?this._closedPromise:u(eI("closed"))}cancel(e){return eM(this)?void 0===this._ownerReadableStream?u(O("cancel")):P(this,e):u(eI("cancel"))}read(e){var t;let r,o,n;if(!eM(this))return u(eI("read"));if(!ArrayBuffer.isView(e))return u(TypeError("view must be an array buffer view"));if(0===e.byteLength)return u(TypeError("view must have non-zero byteLength"));if(0===e.buffer.byteLength)return u(TypeError("view's buffer must have non-zero byteLength"));if(e.buffer,void 0===this._ownerReadableStream)return u(O("read from"));let i=c((e,t)=>{r=e,o=t});return t={_chunkSteps:e=>r({value:e,done:!1}),_closeSteps:e=>r({value:e,done:!0}),_errorSteps:e=>o(e)},(n=this._ownerReadableStream)._disturbed=!0,"errored"===n._state?t._errorSteps(n._storedError):function(e,t,r){let o=e._controlledReadableByteStream,n=1;t.constructor!==DataView&&(n=t.constructor.BYTES_PER_ELEMENT);let i=t.constructor,a=t.buffer,s={buffer:a,bufferByteLength:a.byteLength,byteOffset:t.byteOffset,byteLength:t.byteLength,bytesFilled:0,elementSize:n,viewConstructor:i,readerType:"byob"};if(e._pendingPullIntos.length>0)return e._pendingPullIntos.push(s),eq(o,r);if("closed"!==o._state){if(e._queueTotalSize>0){if(em(e,s)){let t=eh(s);return eg(e),r._chunkSteps(t)}if(e._closeRequested){let t=TypeError("Insufficient bytes to fill elements in the given buffer");return eE(e,t),r._errorSteps(t)}}e._pendingPullIntos.push(s),eq(o,r),ec(e)}else{let e=new i(s.buffer,s.byteOffset,0);r._closeSteps(e)}}(n._readableStreamController,e,t),i}releaseLock(){if(!eM(this))throw eI("releaseLock");void 0!==this._ownerReadableStream&&(E(this),ex(this,TypeError("Reader was released")))}}function eM(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")&&e instanceof eF}function ex(e,t){let r=e._readIntoRequests;e._readIntoRequests=new m,r.forEach(e=>{e._errorSteps(t)})}function eI(e){return TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function eB(e,t){let{highWaterMark:r}=e;if(void 0===r)return t;if(ee(r)||r<0)throw RangeError("Invalid highWaterMark");return r}function eL(e){let{size:t}=e;return t||(()=>1)}function eW(e,t){var r;k(e,t);let o=null==e?void 0:e.highWaterMark,n=null==e?void 0:e.size;return{highWaterMark:void 0===o?void 0:B(o),size:void 0===n?void 0:(F(r=n,`${t} has member 'size' that`),e=>B(r(e)))}}Object.defineProperties(eF.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),i(eF.prototype.cancel,"cancel"),i(eF.prototype.read,"read"),i(eF.prototype.releaseLock,"releaseLock"),"symbol"==typeof r.toStringTag&&Object.defineProperty(eF.prototype,r.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});let e$="function"==typeof AbortController;class eD{constructor(e={},t={}){void 0===e?e=null:M(e,"First parameter");const r=eW(t,"Second parameter"),o=function(e,t){k(e,t);let r=null==e?void 0:e.abort,o=null==e?void 0:e.close,n=null==e?void 0:e.start,i=null==e?void 0:e.type,a=null==e?void 0:e.write;return{abort:void 0===r?void 0:(F(r,`${t} has member 'abort' that`),t=>y(r,e,[t])),close:void 0===o?void 0:(F(o,`${t} has member 'close' that`),()=>y(o,e,[])),start:void 0===n?void 0:(F(n,`${t} has member 'start' that`),t=>b(n,e,[t])),write:void 0===a?void 0:(F(a,`${t} has member 'write' that`),(t,r)=>y(a,e,[t,r])),type:i}}(e,"First parameter");if(this._state="writable",this._storedError=void 0,this._writer=void 0,this._writableStreamController=void 0,this._writeRequests=new m,this._inFlightWriteRequest=void 0,this._closeRequest=void 0,this._inFlightCloseRequest=void 0,this._pendingAbortRequest=void 0,this._backpressure=!1,void 0!==o.type)throw RangeError("Invalid type is specified");const n=eL(r);!function(e,t,r,o){let n,i,a,s,u=Object.create(e4.prototype);n=void 0!==t.start?()=>t.start(u):()=>{},i=void 0!==t.write?e=>t.write(e,u):()=>l(void 0),a=void 0!==t.close?()=>t.close():()=>l(void 0),s=void 0!==t.abort?e=>t.abort(e):()=>l(void 0),u._controlledWritableStream=e,e._writableStreamController=u,u._queue=void 0,u._queueTotalSize=void 0,ei(u),u._abortReason=void 0,u._abortController=function(){if(e$)return new AbortController}(),u._started=!1,u._strategySizeAlgorithm=o,u._strategyHWM=r,u._writeAlgorithm=i,u._closeAlgorithm=a,u._abortAlgorithm=s,eY(e,0>=e6(u)),f(l(n()),()=>(u._started=!0,e9(u),null),t=>(u._started=!0,eV(e,t),null))}(this,o,eB(r,1),n)}get locked(){if(!eN(this))throw e3("locked");return ez(this)}abort(e){return eN(this)?ez(this)?u(TypeError("Cannot abort a stream that already has a writer")):eH(this,e):u(e3("abort"))}close(){return eN(this)?ez(this)?u(TypeError("Cannot close a stream that already has a writer")):eQ(this)?u(TypeError("Cannot close an already-closing stream")):eU(this):u(e3("close"))}getWriter(){if(!eN(this))throw e3("getWriter");return new eJ(this)}}function eN(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")&&e instanceof eD}function ez(e){return void 0!==e._writer}function eH(e,t){var r;if("closed"===e._state||"errored"===e._state)return l(void 0);e._writableStreamController._abortReason=t,null==(r=e._writableStreamController._abortController)||r.abort(t);let o=e._state;if("closed"===o||"errored"===o)return l(void 0);if(void 0!==e._pendingAbortRequest)return e._pendingAbortRequest._promise;let n=!1;"erroring"===o&&(n=!0,t=void 0);let i=c((r,o)=>{e._pendingAbortRequest={_promise:void 0,_resolve:r,_reject:o,_reason:t,_wasAlreadyErroring:n}});return e._pendingAbortRequest._promise=i,n||eG(e,t),i}function eU(e){var t;let r=e._state;if("closed"===r||"errored"===r)return u(TypeError(`The stream (in ${r} state) is not in the writable state and cannot be closed`));let o=c((t,r)=>{e._closeRequest={_resolve:t,_reject:r}}),n=e._writer;return void 0!==n&&e._backpressure&&"writable"===r&&tu(n),en(t=e._writableStreamController,e1,0),e9(t),o}function eV(e,t){"writable"!==e._state?eX(e):eG(e,t)}function eG(e,t){let r=e._writableStreamController;e._state="erroring",e._storedError=t;let o=e._writer;void 0!==o&&e0(o,t),void 0===e._inFlightWriteRequest&&void 0===e._inFlightCloseRequest&&r._started&&eX(e)}function eX(e){e._state="errored",e._writableStreamController[g]();let t=e._storedError;if(e._writeRequests.forEach(e=>{e._reject(t)}),e._writeRequests=new m,void 0===e._pendingAbortRequest)return void eK(e);let r=e._pendingAbortRequest;(e._pendingAbortRequest=void 0,r._wasAlreadyErroring)?(r._reject(t),eK(e)):f(e._writableStreamController[_](r._reason),()=>(r._resolve(),eK(e),null),t=>(r._reject(t),eK(e),null))}function eQ(e){return void 0!==e._closeRequest||void 0!==e._inFlightCloseRequest}function eK(e){void 0!==e._closeRequest&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);let t=e._writer;void 0!==t&&tn(t,e._storedError)}function eY(e,t){let r=e._writer;void 0!==r&&t!==e._backpressure&&(t?ta(r):tu(r)),e._backpressure=t}Object.defineProperties(eD.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),i(eD.prototype.abort,"abort"),i(eD.prototype.close,"close"),i(eD.prototype.getWriter,"getWriter"),"symbol"==typeof r.toStringTag&&Object.defineProperty(eD.prototype,r.toStringTag,{value:"WritableStream",configurable:!0});class eJ{constructor(e){if(x(e,1,"WritableStreamDefaultWriter"),function(e,t){if(!eN(e))throw TypeError(`${t} is not a WritableStream.`)}(e,"First parameter"),ez(e))throw TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=e,e._writer=this;const t=e._state;if("writable"===t)!eQ(e)&&e._backpressure?ta(this):function(e){ta(e),tu(e)}(this),to(this);else if("erroring"===t)ts(this,e._storedError),to(this);else if("closed"===t)(function(e){ta(e),tu(e)})(this),to(this),ti(this);else{const t=e._storedError;ts(this,t),function(e,t){to(e),tn(e,t)}(this,t)}}get closed(){return eZ(this)?this._closedPromise:u(tt("closed"))}get desiredSize(){let e,t;if(!eZ(this))throw tt("desiredSize");if(void 0===this._ownerWritableStream)throw tr("desiredSize");return"errored"===(t=(e=this._ownerWritableStream)._state)||"erroring"===t?null:"closed"===t?0:e6(e._writableStreamController)}get ready(){return eZ(this)?this._readyPromise:u(tt("ready"))}abort(e){return eZ(this)?void 0===this._ownerWritableStream?u(tr("abort")):eH(this._ownerWritableStream,e):u(tt("abort"))}close(){if(!eZ(this))return u(tt("close"));let e=this._ownerWritableStream;return void 0===e?u(tr("close")):eQ(e)?u(TypeError("Cannot close an already-closing stream")):eU(this._ownerWritableStream)}releaseLock(){var e,t;let r,o;if(!eZ(this))throw tt("releaseLock");void 0!==this._ownerWritableStream&&(r=this._ownerWritableStream,e0(this,o=TypeError("Writer was released and can no longer be used to monitor the stream's closedness")),"pending"===this._closedPromiseState?tn(this,o):(e=this,t=o,to(e),tn(e,t)),r._writer=void 0,this._ownerWritableStream=void 0)}write(e){return eZ(this)?void 0===this._ownerWritableStream?u(tr("write to")):function(e,t){let r=e._ownerWritableStream,o=r._writableStreamController,n=function(e,t){try{return e._strategySizeAlgorithm(t)}catch(t){return e8(e,t),1}}(o,t);if(r!==e._ownerWritableStream)return u(tr("write to"));let i=r._state;if("errored"===i)return u(r._storedError);if(eQ(r)||"closed"===i)return u(TypeError("The stream is closing or closed and cannot be written to"));if("erroring"===i)return u(r._storedError);let a=c((e,t)=>{r._writeRequests.push({_resolve:e,_reject:t})});return function(e,t,r){try{en(e,t,r)}catch(t){return void e8(e,t)}let o=e._controlledWritableStream;eQ(o)||"writable"!==o._state||eY(o,0>=e6(e)),e9(e)}(o,t,n),a}(this,e):u(tt("write"))}}function eZ(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")&&e instanceof eJ}function e0(e,t){"pending"===e._readyPromiseState?tl(e,t):ts(e,t)}Object.defineProperties(eJ.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),i(eJ.prototype.abort,"abort"),i(eJ.prototype.close,"close"),i(eJ.prototype.releaseLock,"releaseLock"),i(eJ.prototype.write,"write"),"symbol"==typeof r.toStringTag&&Object.defineProperty(eJ.prototype,r.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});let e1={};class e4{constructor(){throw TypeError("Illegal constructor")}get abortReason(){if(!e5(this))throw te("abortReason");return this._abortReason}get signal(){if(!e5(this))throw te("signal");if(void 0===this._abortController)throw TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(e){if(!e5(this))throw te("error");"writable"===this._controlledWritableStream._state&&e7(this,e)}[_](e){let t=this._abortAlgorithm(e);return e2(this),t}[g](){ei(this)}}function e5(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")&&e instanceof e4}function e2(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function e6(e){return e._strategyHWM-e._queueTotalSize}function e9(e){let t,r,o,n=e._controlledWritableStream;if(!e._started||void 0!==n._inFlightWriteRequest)return;if("erroring"===n._state)return void eX(n);if(0===e._queue.length)return;let i=e._queue.peek().value;i===e1?((t=e._controlledWritableStream)._inFlightCloseRequest=t._closeRequest,t._closeRequest=void 0,eo(e),r=e._closeAlgorithm(),e2(e),f(r,()=>{let e;return t._inFlightCloseRequest._resolve(void 0),t._inFlightCloseRequest=void 0,"erroring"===t._state&&(t._storedError=void 0,void 0!==t._pendingAbortRequest&&(t._pendingAbortRequest._resolve(),t._pendingAbortRequest=void 0)),t._state="closed",void 0!==(e=t._writer)&&ti(e),null},e=>(t._inFlightCloseRequest._reject(e),t._inFlightCloseRequest=void 0,void 0!==t._pendingAbortRequest&&(t._pendingAbortRequest._reject(e),t._pendingAbortRequest=void 0),eV(t,e),null))):((o=e._controlledWritableStream)._inFlightWriteRequest=o._writeRequests.shift(),f(e._writeAlgorithm(i),()=>{o._inFlightWriteRequest._resolve(void 0),o._inFlightWriteRequest=void 0;let t=o._state;return eo(e),eQ(o)||"writable"!==t||eY(o,0>=e6(e)),e9(e),null},t=>("writable"===o._state&&e2(e),o._inFlightWriteRequest._reject(t),o._inFlightWriteRequest=void 0,eV(o,t),null)))}function e8(e,t){"writable"===e._controlledWritableStream._state&&e7(e,t)}function e7(e,t){let r=e._controlledWritableStream;e2(e),eG(r,t)}function e3(e){return TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function te(e){return TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function tt(e){return TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function tr(e){return TypeError("Cannot "+e+" a stream using a released writer")}function to(e){e._closedPromise=c((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r,e._closedPromiseState="pending"})}function tn(e,t){void 0!==e._closedPromise_reject&&(h(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function ti(e){void 0!==e._closedPromise_resolve&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function ta(e){e._readyPromise=c((t,r)=>{e._readyPromise_resolve=t,e._readyPromise_reject=r}),e._readyPromiseState="pending"}function ts(e,t){ta(e),tl(e,t)}function tl(e,t){void 0!==e._readyPromise_reject&&(h(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function tu(e){void 0!==e._readyPromise_resolve&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}Object.defineProperties(e4.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),"symbol"==typeof r.toStringTag&&Object.defineProperty(e4.prototype,r.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});let tc="undefined"!=typeof DOMException?DOMException:void 0,td=!function(e){if("function"!=typeof e&&"object"!=typeof e)return!1;try{return new e,!0}catch(e){return!1}}(tc)?((t=function(e,t){this.message=e||"",this.name=t||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}).prototype=Object.create(Error.prototype),Object.defineProperty(t.prototype,"constructor",{value:t,writable:!0,configurable:!0}),t):tc;function tf(e,t,r,o,n,i){let a=e.getReader(),s=t.getWriter();tR(e)&&(e._disturbed=!0);let b,y,m,_=!1,g=!1,v="readable",w="writable",S=!1,R=!1,P=c(e=>{m=e}),E=Promise.resolve(void 0);return c((O,T)=>{let A;function j(){if(_)return;let e=c((e,t)=>{!function r(o){o?e():d(_?l(!0):d(s.ready,()=>d(a.read(),e=>!!e.done||(h(E=s.write(e.value)),!1))),r,t)}(!1)});h(e)}function q(){return v="closed",r?M():F(()=>(eN(t)&&(S=eQ(t),w=t._state),S||"closed"===w?l(void 0):"erroring"===w||"errored"===w?u(y):(S=!0,s.close())),!1,void 0),null}function C(e){return _||(v="errored",b=e,o?M(!0,e):F(()=>s.abort(e),!0,e)),null}function k(e){return g||(w="errored",y=e,n?M(!0,e):F(()=>a.cancel(e),!0,e)),null}if(void 0!==i&&(A=()=>{let e=void 0!==i.reason?i.reason:new td("Aborted","AbortError"),t=[];o||t.push(()=>"writable"===w?s.abort(e):l(void 0)),n||t.push(()=>"readable"===v?a.cancel(e):l(void 0)),F(()=>Promise.all(t.map(e=>e())),!0,e)},i.aborted?A():i.addEventListener("abort",A)),tR(e)&&(v=e._state,b=e._storedError),eN(t)&&(w=t._state,y=t._storedError,S=eQ(t)),tR(e)&&eN(t)&&(R=!0,m()),"errored"===v)C(b);else if("erroring"===w||"errored"===w)k(y);else if("closed"===v)q();else if(S||"closed"===w){let e=TypeError("the destination writable stream closed before all data could be piped to it");n?M(!0,e):F(()=>a.cancel(e),!0,e)}function F(e,t,r){function o(){let e;return"writable"!==w||S?n():f(l(function t(){if(e!==E)return e=E,d(E,t,t)}()),n),null}function n(){return e?f(e(),()=>x(t,r),e=>x(!0,e)):x(t,r),null}_||(_=!0,R?o():f(P,o))}function M(e,t){F(void 0,e,t)}function x(e,t){return g=!0,s.releaseLock(),a.releaseLock(),void 0!==i&&i.removeEventListener("abort",A),e?T(t):O(void 0),null}_||(f(a.closed,q,C),f(s.closed,function(){return g||(w="closed"),null},k)),R?j():p(()=>{R=!0,m(),j()})})}class th{constructor(){throw TypeError("Illegal constructor")}get desiredSize(){if(!tp(this))throw tv("desiredSize");return t_(this)}close(){if(!tp(this))throw tv("close");if(!tg(this))throw TypeError("The stream is not in a state that permits close");!function(e){if(!tg(e))return;let t=e._controlledReadableStream;e._closeRequested=!0,0===e._queue.length&&(ty(e),tO(t))}(this)}enqueue(e){if(!tp(this))throw tv("enqueue");if(!tg(this))throw TypeError("The stream is not in a state that permits enqueue");if(!tg(this))return;let t=this._controlledReadableStream;if(tP(t)&&H(t)>0)z(t,e,!1);else{let t;try{t=this._strategySizeAlgorithm(e)}catch(e){throw tm(this,e),e}try{en(this,e,t)}catch(e){throw tm(this,e),e}}tb(this)}error(e){if(!tp(this))throw tv("error");tm(this,e)}[v](e){ei(this);let t=this._cancelAlgorithm(e);return ty(this),t}[w](e){let t=this._controlledReadableStream;if(this._queue.length>0){let r=eo(this);this._closeRequested&&0===this._queue.length?(ty(this),tO(t)):tb(this),e._chunkSteps(r)}else N(t,e),tb(this)}[S](){}}function tp(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")&&e instanceof th}function tb(e){let t;if(t=e._controlledReadableStream,tg(e)&&e._started&&(tP(t)&&H(t)>0||t_(e)>0||0)){if(e._pulling)return void(e._pullAgain=!0);e._pulling=!0,f(e._pullAlgorithm(),()=>(e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,tb(e)),null),t=>(tm(e,t),null))}}function ty(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function tm(e,t){let r=e._controlledReadableStream;"readable"===r._state&&(ei(e),ty(e),tT(r,t))}function t_(e){let t=e._controlledReadableStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function tg(e){return!e._closeRequested&&"readable"===e._controlledReadableStream._state}function tv(e){return TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function tw(e,t){k(e,t);let r=null==e?void 0:e.preventAbort,o=null==e?void 0:e.preventCancel,n=null==e?void 0:e.preventClose,i=null==e?void 0:e.signal;return void 0!==i&&function(e,t){if(!function(e){if("object"!=typeof e||null===e)return!1;try{return"boolean"==typeof e.aborted}catch(e){return!1}}(e))throw TypeError(`${t} is not an AbortSignal.`)}(i,`${t} has member 'signal' that`),{preventAbort:!!r,preventCancel:!!o,preventClose:!!n,signal:i}}Object.defineProperties(th.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),i(th.prototype.close,"close"),i(th.prototype.enqueue,"enqueue"),i(th.prototype.error,"error"),"symbol"==typeof r.toStringTag&&Object.defineProperty(th.prototype,r.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});class tS{constructor(e={},t={}){void 0===e?e=null:M(e,"First parameter");const r=eW(t,"Second parameter"),o=function(e,t){k(e,t);let r=null==e?void 0:e.autoAllocateChunkSize,o=null==e?void 0:e.cancel,n=null==e?void 0:e.pull,i=null==e?void 0:e.start,a=null==e?void 0:e.type;return{autoAllocateChunkSize:void 0===r?void 0:L(r,`${t} has member 'autoAllocateChunkSize' that`),cancel:void 0===o?void 0:(F(o,`${t} has member 'cancel' that`),t=>y(o,e,[t])),pull:void 0===n?void 0:(F(n,`${t} has member 'pull' that`),t=>y(n,e,[t])),start:void 0===i?void 0:(F(i,`${t} has member 'start' that`),t=>b(i,e,[t])),type:void 0===a?void 0:function(e,t){if("bytes"!=(e=`${e}`))throw TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}(a,`${t} has member 'type' that`)}}(e,"First parameter");if(this._state="readable",this._reader=void 0,this._storedError=void 0,this._disturbed=!1,"bytes"===o.type){if(void 0!==r.size)throw RangeError("The strategy for a byte stream cannot have a size function");!function(e,t,r){let o,n,i,a=Object.create(es.prototype);o=void 0!==t.start?()=>t.start(a):()=>{},n=void 0!==t.pull?()=>t.pull(a):()=>l(void 0),i=void 0!==t.cancel?e=>t.cancel(e):()=>l(void 0);let s=t.autoAllocateChunkSize;if(0===s)throw TypeError("autoAllocateChunkSize must be greater than 0");a._controlledReadableByteStream=e,a._pullAgain=!1,a._pulling=!1,a._byobRequest=null,a._queue=a._queueTotalSize=void 0,ei(a),a._closeRequested=!1,a._started=!1,a._strategyHWM=r,a._pullAlgorithm=n,a._cancelAlgorithm=i,a._autoAllocateChunkSize=s,a._pendingPullIntos=new m,e._readableStreamController=a,f(l(o()),()=>(a._started=!0,ec(a),null),e=>(eE(a,e),null))}(this,o,eB(r,0))}else{const e=eL(r);!function(e,t,r,o){let n,i,a,s=Object.create(th.prototype);n=void 0!==t.start?()=>t.start(s):()=>{},i=void 0!==t.pull?()=>t.pull(s):()=>l(void 0),a=void 0!==t.cancel?e=>t.cancel(e):()=>l(void 0),s._controlledReadableStream=e,s._queue=void 0,s._queueTotalSize=void 0,ei(s),s._started=!1,s._closeRequested=!1,s._pullAgain=!1,s._pulling=!1,s._strategySizeAlgorithm=o,s._strategyHWM=r,s._pullAlgorithm=i,s._cancelAlgorithm=a,e._readableStreamController=s,f(l(n()),()=>(s._started=!0,tb(s),null),e=>(tm(s,e),null))}(this,o,eB(r,1),e)}}get locked(){if(!tR(this))throw tA("locked");return tP(this)}cancel(e){return tR(this)?tP(this)?u(TypeError("Cannot cancel a stream that already has a reader")):tE(this,e):u(tA("cancel"))}getReader(e){var t;let r;if(!tR(this))throw tA("getReader");return void 0===(k(e,t="First parameter"),{mode:void 0===(r=null==e?void 0:e.mode)?void 0:function(e,t){if("byob"!=(e=`${e}`))throw TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}(r,`${t} has member 'mode' that`)}).mode?new V(this):new eF(this)}pipeThrough(e,t={}){var r;let o,n;if(!W(this))throw tA("pipeThrough");x(e,1,"pipeThrough");let i=(k(e,r="First parameter"),I(o=null==e?void 0:e.readable,"readable","ReadableWritablePair"),function(e,t){if(!W(e))throw TypeError(`${t} is not a ReadableStream.`)}(o,`${r} has member 'readable' that`),I(n=null==e?void 0:e.writable,"writable","ReadableWritablePair"),function(e,t){if(!$(e))throw TypeError(`${t} is not a WritableStream.`)}(n,`${r} has member 'writable' that`),{readable:o,writable:n}),a=tw(t,"Second parameter");if(this.locked)throw TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(i.writable.locked)throw TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");return h(tf(this,i.writable,a.preventClose,a.preventAbort,a.preventCancel,a.signal)),i.readable}pipeTo(e,t={}){let r;if(!W(this))return u(tA("pipeTo"));if(void 0===e)return u("Parameter 1 is required in 'pipeTo'.");if(!$(e))return u(TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));try{r=tw(t,"Second parameter")}catch(e){return u(e)}return this.locked?u(TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):e.locked?u(TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):tf(this,e,r.preventClose,r.preventAbort,r.preventCancel,r.signal)}tee(){if(!W(this))throw tA("tee");if(this.locked)throw TypeError("Cannot tee a stream that already has a reader");return!function(e){try{return e.getReader({mode:"byob"}).releaseLock(),!0}catch(e){return!1}}(this)?function(e,t){let r=e.getReader(),o,n,i,a,s,u=!1,d=!1,h=!1,p=!1,b=c(e=>{s=e});function y(){return u?d=!0:(u=!0,f(r.read(),e=>{if(d=!1,e.done)return h||i.close(),p||a.close(),h&&p||s(void 0),null;let t=e.value;return h||i.enqueue(t),p||a.enqueue(t),u=!1,d&&y(),null},()=>(u=!1,null))),l(void 0)}let m=new tS({start(e){i=e},pull:y,cancel:function(e){if(h=!0,o=e,p){let e=[o,n],t=r.cancel(e);s(t)}return b}}),_=new tS({start(e){a=e},pull:y,cancel:function(e){if(p=!0,n=e,h){let e=[o,n],t=r.cancel(e);s(t)}return b}});return f(r.closed,void 0,e=>(i.error(e),a.error(e),h&&p||s(void 0),null)),[m,_]}(this):function(e){let t,r,o,n,i,a=e.getReader(),s=!1,u=!1,d=!1,h=!1,p=!1,b=!1,y=c(e=>{i=e});function m(e){f(e.closed,void 0,t=>(e!==a||(o.error(t),n.error(t),p&&b||i(void 0)),null))}function _(){s&&(a.releaseLock(),m(a=e.getReader()),s=!1),f(a.read(),e=>{var t,r;if(d=!1,h=!1,e.done)return p||o.close(),b||n.close(),null==(t=o.byobRequest)||t.respond(0),null==(r=n.byobRequest)||r.respond(0),p&&b||i(void 0),null;let s=e.value,l=s;if(!p&&!b)try{l=er(s)}catch(e){return o.error(e),n.error(e),i(a.cancel(e)),null}return p||o.enqueue(s),b||n.enqueue(l),u=!1,d?v():h&&w(),null},()=>(u=!1,null))}function g(t,r){s||(a.releaseLock(),m(a=e.getReader({mode:"byob"})),s=!0);let l=r?n:o,c=r?o:n;f(a.read(t),e=>{var t;d=!1,h=!1;let o=r?b:p,n=r?p:b;if(e.done){o||l.close(),n||c.close();let r=e.value;return void 0!==r&&(o||l.byobRequest.respondWithNewView(r),n||null==(t=c.byobRequest)||t.respond(0)),o&&n||i(void 0),null}let s=e.value;if(n)o||l.byobRequest.respondWithNewView(s);else{let e;try{e=er(s)}catch(e){return l.error(e),c.error(e),i(a.cancel(e)),null}o||l.byobRequest.respondWithNewView(s),c.enqueue(e)}return u=!1,d?v():h&&w(),null},()=>(u=!1,null))}function v(){if(u)return d=!0,l(void 0);u=!0;let e=o.byobRequest;return null===e?_():g(e.view,!1),l(void 0)}function w(){if(u)return h=!0,l(void 0);u=!0;let e=n.byobRequest;return null===e?_():g(e.view,!0),l(void 0)}let S=new tS({type:"bytes",start(e){o=e},pull:v,cancel:function(e){if(p=!0,t=e,b){let e=[t,r],o=a.cancel(e);i(o)}return y}}),R=new tS({type:"bytes",start(e){n=e},pull:w,cancel:function(e){if(b=!0,r=e,p){let e=[t,r],o=a.cancel(e);i(o)}return y}});return m(a),[S,R]}(this)}values(e){var t;let r,o;if(!W(this))throw tA("values");return t=(k(e,"First parameter"),{preventCancel:!!(null==e?void 0:e.preventCancel)}).preventCancel,r=new K(this.getReader(),t),(o=Object.create(Y))._asyncIteratorImpl=r,o}}function tR(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")&&e instanceof tS}function tP(e){return void 0!==e._reader}function tE(e,t){if(e._disturbed=!0,"closed"===e._state)return l(void 0);if("errored"===e._state)return u(e._storedError);tO(e);let r=e._reader;if(void 0!==r&&eM(r)){let e=r._readIntoRequests;r._readIntoRequests=new m,e.forEach(e=>{e._closeSteps(void 0)})}return d(e._readableStreamController[v](t),o,void 0)}function tO(e){e._state="closed";let t=e._reader;if(void 0!==t&&(j(t),G(t))){let e=t._readRequests;t._readRequests=new m,e.forEach(e=>{e._closeSteps()})}}function tT(e,t){e._state="errored",e._storedError=t;let r=e._reader;void 0!==r&&(A(r,t),G(r)?X(r,t):ex(r,t))}function tA(e){return TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function tj(e,t){k(e,t);let r=null==e?void 0:e.highWaterMark;return I(r,"highWaterMark","QueuingStrategyInit"),{highWaterMark:B(r)}}Object.defineProperties(tS.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),i(tS.prototype.cancel,"cancel"),i(tS.prototype.getReader,"getReader"),i(tS.prototype.pipeThrough,"pipeThrough"),i(tS.prototype.pipeTo,"pipeTo"),i(tS.prototype.tee,"tee"),i(tS.prototype.values,"values"),"symbol"==typeof r.toStringTag&&Object.defineProperty(tS.prototype,r.toStringTag,{value:"ReadableStream",configurable:!0}),"symbol"==typeof r.asyncIterator&&Object.defineProperty(tS.prototype,r.asyncIterator,{value:tS.prototype.values,writable:!0,configurable:!0});let tq=e=>e.byteLength;i(tq,"size");class tC{constructor(e){x(e,1,"ByteLengthQueuingStrategy"),e=tj(e,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=e.highWaterMark}get highWaterMark(){if(!tF(this))throw tk("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!tF(this))throw tk("size");return tq}}function tk(e){return TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function tF(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")&&e instanceof tC}Object.defineProperties(tC.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"==typeof r.toStringTag&&Object.defineProperty(tC.prototype,r.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});let tM=()=>1;i(tM,"size");class tx{constructor(e){x(e,1,"CountQueuingStrategy"),e=tj(e,"First parameter"),this._countQueuingStrategyHighWaterMark=e.highWaterMark}get highWaterMark(){if(!tB(this))throw tI("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!tB(this))throw tI("size");return tM}}function tI(e){return TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function tB(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")&&e instanceof tx}Object.defineProperties(tx.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"==typeof r.toStringTag&&Object.defineProperty(tx.prototype,r.toStringTag,{value:"CountQueuingStrategy",configurable:!0});class tL{constructor(e={},t={},r={}){let o;void 0===e&&(e=null);const n=eW(t,"Second parameter"),i=eW(r,"Third parameter"),a=function(e,t){k(e,t);let r=null==e?void 0:e.flush,o=null==e?void 0:e.readableType,n=null==e?void 0:e.start,i=null==e?void 0:e.transform,a=null==e?void 0:e.writableType;return{flush:void 0===r?void 0:(F(r,`${t} has member 'flush' that`),t=>y(r,e,[t])),readableType:o,start:void 0===n?void 0:(F(n,`${t} has member 'start' that`),t=>b(n,e,[t])),transform:void 0===i?void 0:(F(i,`${t} has member 'transform' that`),(t,r)=>y(i,e,[t,r])),writableType:a}}(e,"First parameter");if(void 0!==a.readableType)throw RangeError("Invalid readableType specified");if(void 0!==a.writableType)throw RangeError("Invalid writableType specified");const s=eB(i,0),f=eL(i),h=eB(n,1),p=eL(n);!function(e,t,r,o,n,i){var a,s,u;function c(){return t}e._writableState="writable",e._writableStoredError=void 0,e._writableHasInFlightOperation=!1,e._writableStarted=!1,a=function(t){let r=e._transformStreamController;return e._backpressure?d(e._backpressureChangePromise,()=>{if("erroring"===(eN(e._writable)?e._writable._state:e._writableState))throw eN(e._writable)?e._writable._storedError:e._writableStoredError;return tG(r,t)},void 0):tG(r,t)},s=function(){let t,r;return r=(t=e._transformStreamController)._flushAlgorithm(),tU(t),d(r,()=>{if("errored"===e._readableState)throw e._readableStoredError;tK(e)&&tY(e)},t=>{throw t$(e,t),e._readableStoredError})},e._writable=new eD({start(t){e._writableController=t;try{let r=t.signal;void 0!==r&&r.addEventListener("abort",()=>{"writable"===e._writableState&&(e._writableState="erroring",r.reason&&(e._writableStoredError=r.reason))})}catch(e){}return d(c(),()=>(e._writableStarted=!0,t5(e),null),t=>{throw e._writableStarted=!0,t0(e,t),t})},write:t=>(e._writableHasInFlightOperation=!0,d(a(t),()=>(e._writableHasInFlightOperation=!1,t5(e),null),t=>{throw e._writableHasInFlightOperation=!1,t0(e,t),t})),close:()=>(e._writableHasInFlightOperation=!0,d(s(),()=>(e._writableHasInFlightOperation=!1,"erroring"===e._writableState&&(e._writableStoredError=void 0),e._writableState="closed",null),t=>{throw e._writableHasInFlightOperation=!1,e._writableState,t0(e,t),t})),abort:t=>(e._writableState="errored",e._writableStoredError=t,function(t){return t$(e,t),l(void 0)}(t))},{highWaterMark:r,size:o}),e._readableState="readable",e._readableStoredError=void 0,e._readableCloseRequested=!1,e._readablePulling=!1,u=function(){return tN(e,!1),e._backpressureChangePromise},e._readable=new tS({start:t=>(e._readableController=t,c().catch(t=>{tJ(e,t)})),pull:()=>(e._readablePulling=!0,u().catch(t=>{tJ(e,t)})),cancel:t=>(e._readableState="closed",function(t){return tD(e,t),l(void 0)}(t))},{highWaterMark:n,size:i}),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,tN(e,!0),e._transformStreamController=void 0}(this,c(e=>{o=e}),h,p,s,f),function(e,t){let r,o,n=Object.create(tz.prototype);r=void 0!==t.transform?e=>t.transform(e,n):e=>{try{var t;return tV(n,e),t=void 0,l(t)}catch(e){return u(e)}},o=void 0!==t.flush?()=>t.flush(n):()=>l(void 0),n._controlledTransformStream=e,e._transformStreamController=n,n._transformAlgorithm=r,n._flushAlgorithm=o}(this,a),void 0!==a.start?o(a.start(this._transformStreamController)):o(void 0)}get readable(){if(!tW(this))throw tQ("readable");return this._readable}get writable(){if(!tW(this))throw tQ("writable");return this._writable}}function tW(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")&&e instanceof tL}function t$(e,t){tJ(e,t),tD(e,t)}function tD(e,t){tU(e._transformStreamController),e._writableController.error(t),"writable"===e._writableState&&t1(e,t),e._backpressure&&tN(e,!1)}function tN(e,t){void 0!==e._backpressureChangePromise&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=c(t=>{e._backpressureChangePromise_resolve=t}),e._backpressure=t}Object.defineProperties(tL.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),"symbol"==typeof r.toStringTag&&Object.defineProperty(tL.prototype,r.toStringTag,{value:"TransformStream",configurable:!0});class tz{constructor(){throw TypeError("Illegal constructor")}get desiredSize(){if(!tH(this))throw tX("desiredSize");return tZ(this._controlledTransformStream)}enqueue(e){if(!tH(this))throw tX("enqueue");tV(this,e)}error(e){if(!tH(this))throw tX("error");t$(this._controlledTransformStream,e)}terminate(){let e;if(!tH(this))throw tX("terminate");tK(e=this._controlledTransformStream)&&tY(e),tD(e,TypeError("TransformStream terminated"))}}function tH(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")&&e instanceof tz}function tU(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function tV(e,t){let r=e._controlledTransformStream;if(!tK(r))throw TypeError("Readable side is not in a state that permits enqueue");try{r._readablePulling=!1;try{r._readableController.enqueue(t)}catch(e){throw tJ(r,e),e}}catch(e){throw tD(r,e),r._readableStoredError}!(tK(r)&&(r._readablePulling||tZ(r)>0))!==r._backpressure&&tN(r,!0)}function tG(e,t){return d(e._transformAlgorithm(t),void 0,t=>{throw t$(e._controlledTransformStream,t),t})}function tX(e){return TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function tQ(e){return TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}function tK(e){return!e._readableCloseRequested&&"readable"===e._readableState}function tY(e){e._readableState="closed",e._readableCloseRequested=!0,e._readableController.close()}function tJ(e,t){"readable"===e._readableState&&(e._readableState="errored",e._readableStoredError=t),e._readableController.error(t)}function tZ(e){return e._readableController.desiredSize}function t0(e,t){"writable"!==e._writableState?t4(e):t1(e,t)}function t1(e,t){e._writableState="erroring",e._writableStoredError=t,!e._writableHasInFlightOperation&&e._writableStarted&&t4(e)}function t4(e){e._writableState="errored"}function t5(e){"erroring"===e._writableState&&t4(e)}Object.defineProperties(tz.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),i(tz.prototype.enqueue,"enqueue"),i(tz.prototype.error,"error"),i(tz.prototype.terminate,"terminate"),"symbol"==typeof r.toStringTag&&Object.defineProperty(tz.prototype,r.toStringTag,{value:"TransformStreamDefaultController",configurable:!0}),e.ByteLengthQueuingStrategy=tC,e.CountQueuingStrategy=tx,e.ReadableByteStreamController=es,e.ReadableStream=tS,e.ReadableStreamBYOBReader=eF,e.ReadableStreamBYOBRequest=ea,e.ReadableStreamDefaultController=th,e.ReadableStreamDefaultReader=V,e.TransformStream=tL,e.TransformStreamDefaultController=tz,e.WritableStream=eD,e.WritableStreamDefaultController=e4,e.WritableStreamDefaultWriter=eJ,Object.defineProperty(e,"__esModule",{value:!0})}(r)},17478,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isFunction=void 0,r.isFunction=e=>"function"==typeof e},28550,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.sliceBlob=r.consumeBlobParts=void 0;let o=e.r(17478);async function*n(e){let t=e.byteOffset+e.byteLength,r=e.byteOffset;for(;r!==t;){let o=Math.min(t-r,65536),n=e.buffer.slice(r,r+o);r+=n.byteLength,yield new Uint8Array(n)}}async function*i(e){let t=0;for(;t!==e.size;){let r=e.slice(t,Math.min(e.size,t+65536)),o=await r.arrayBuffer();t+=o.byteLength,yield new Uint8Array(o)}}r.consumeBlobParts=async function*(e,t=!1){for(let r of e)ArrayBuffer.isView(r)?t?yield*n(r):yield r:(0,o.isFunction)(r.stream)?yield*r.stream():yield*i(r)},r.sliceBlob=function*(e,t,r=0,o){null!=o||(o=t);let n=r<0?Math.max(t+r,0):Math.min(r,t),i=o<0?Math.max(t+o,0):Math.min(o,t),a=Math.max(i-n,0),s=0;for(let t of e){if(s>=a)break;let e=ArrayBuffer.isView(t)?t.byteLength:t.size;if(n&&e<=n)n-=e,i-=e;else{let r;ArrayBuffer.isView(t)?s+=(r=t.subarray(n,Math.min(e,i))).byteLength:s+=(r=t.slice(n,Math.min(e,i))).size,i-=e,n=0,yield r}}}},26356,(e,t,r)=>{"use strict";var o,n,i,a=e.e&&e.e.__classPrivateFieldGet||function(e,t,r,o){if("a"===r&&!o)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)},s=e.e&&e.e.__classPrivateFieldSet||function(e,t,r,o,n){if("m"===o)throw TypeError("Private method is not writable");if("a"===o&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,r):n?n.value=r:t.set(e,r),r};Object.defineProperty(r,"__esModule",{value:!0}),r.Blob=void 0;let l=e.r(82959),u=e.r(17478),c=e.r(28550);class d{constructor(e=[],t={}){if(o.set(this,[]),n.set(this,""),i.set(this,0),null!=t||(t={}),"object"!=typeof e||null===e)throw TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(!(0,u.isFunction)(e[Symbol.iterator]))throw TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if("object"!=typeof t&&!(0,u.isFunction)(t))throw TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");const r=new TextEncoder;for(const t of e){let e;e=ArrayBuffer.isView(t)?new Uint8Array(t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)):t instanceof ArrayBuffer?new Uint8Array(t.slice(0)):t instanceof d?t:r.encode(String(t)),s(this,i,a(this,i,"f")+(ArrayBuffer.isView(e)?e.byteLength:e.size),"f"),a(this,o,"f").push(e)}const l=void 0===t.type?"":String(t.type);s(this,n,/^[\x20-\x7E]*$/.test(l)?l:"","f")}static[(o=new WeakMap,n=new WeakMap,i=new WeakMap,Symbol.hasInstance)](e){return!!(e&&"object"==typeof e&&(0,u.isFunction)(e.constructor)&&((0,u.isFunction)(e.stream)||(0,u.isFunction)(e.arrayBuffer))&&/^(Blob|File)$/.test(e[Symbol.toStringTag]))}get type(){return a(this,n,"f")}get size(){return a(this,i,"f")}slice(e,t,r){return new d((0,c.sliceBlob)(a(this,o,"f"),this.size,e,t),{type:r})}async text(){let e=new TextDecoder,t="";for await(let r of(0,c.consumeBlobParts)(a(this,o,"f")))t+=e.decode(r,{stream:!0});return t+e.decode()}async arrayBuffer(){let e=new Uint8Array(this.size),t=0;for await(let r of(0,c.consumeBlobParts)(a(this,o,"f")))e.set(r,t),t+=r.length;return e.buffer}stream(){let e=(0,c.consumeBlobParts)(a(this,o,"f"),!0);return new l.ReadableStream({async pull(t){let{value:r,done:o}=await e.next();if(o)return queueMicrotask(()=>t.close());t.enqueue(r)},async cancel(){await e.return()}})}get[Symbol.toStringTag](){return"Blob"}}r.Blob=d,Object.defineProperties(d.prototype,{type:{enumerable:!0},size:{enumerable:!0},slice:{enumerable:!0},stream:{enumerable:!0},text:{enumerable:!0},arrayBuffer:{enumerable:!0}})},99435,(e,t,r)=>{"use strict";var o,n,i=e.e&&e.e.__classPrivateFieldSet||function(e,t,r,o,n){if("m"===o)throw TypeError("Private method is not writable");if("a"===o&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,r):n?n.value=r:t.set(e,r),r},a=e.e&&e.e.__classPrivateFieldGet||function(e,t,r,o){if("a"===r&&!o)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.File=void 0;let s=e.r(26356);class l extends s.Blob{constructor(e,t,r={}){if(super(e,r),o.set(this,void 0),n.set(this,0),arguments.length<2)throw TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);i(this,o,String(t),"f");const a=void 0===r.lastModified?Date.now():Number(r.lastModified);Number.isNaN(a)||i(this,n,a,"f")}static[(o=new WeakMap,n=new WeakMap,Symbol.hasInstance)](e){return e instanceof s.Blob&&"File"===e[Symbol.toStringTag]&&"string"==typeof e.name}get name(){return a(this,o,"f")}get lastModified(){return a(this,n,"f")}get webkitRelativePath(){return""}get[Symbol.toStringTag](){return"File"}}r.File=l},70578,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isFile=void 0;let o=e.r(99435);r.isFile=e=>e instanceof o.File},15523,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isBlob=void 0;let o=e.r(26356);r.isBlob=e=>e instanceof o.Blob},75688,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.deprecateConstructorEntries=void 0,r.deprecateConstructorEntries=(0,e.r(24361).deprecate)(()=>{},'Constructor "entries" argument is not spec-compliant and will be removed in next major release.')},21501,(e,t,r)=>{"use strict";var o,n,i,a=e.e&&e.e.__classPrivateFieldGet||function(e,t,r,o){if("a"===r&&!o)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.FormData=void 0;let s=e.r(24361),l=e.r(99435),u=e.r(70578),c=e.r(15523),d=e.r(17478),f=e.r(75688);class h{constructor(e){o.add(this),n.set(this,new Map),e&&((0,f.deprecateConstructorEntries)(),e.forEach(({name:e,value:t,fileName:r})=>this.append(e,t,r)))}static[(n=new WeakMap,o=new WeakSet,Symbol.hasInstance)](e){return!!(e&&(0,d.isFunction)(e.constructor)&&"FormData"===e[Symbol.toStringTag]&&(0,d.isFunction)(e.append)&&(0,d.isFunction)(e.set)&&(0,d.isFunction)(e.get)&&(0,d.isFunction)(e.getAll)&&(0,d.isFunction)(e.has)&&(0,d.isFunction)(e.delete)&&(0,d.isFunction)(e.entries)&&(0,d.isFunction)(e.values)&&(0,d.isFunction)(e.keys)&&(0,d.isFunction)(e[Symbol.iterator])&&(0,d.isFunction)(e.forEach))}append(e,t,r){a(this,o,"m",i).call(this,{name:e,fileName:r,append:!0,rawValue:t,argsLength:arguments.length})}set(e,t,r){a(this,o,"m",i).call(this,{name:e,fileName:r,append:!1,rawValue:t,argsLength:arguments.length})}get(e){let t=a(this,n,"f").get(String(e));return t?t[0]:null}getAll(e){let t=a(this,n,"f").get(String(e));return t?t.slice():[]}has(e){return a(this,n,"f").has(String(e))}delete(e){a(this,n,"f").delete(String(e))}*keys(){for(let e of a(this,n,"f").keys())yield e}*entries(){for(let e of this.keys())for(let t of this.getAll(e))yield[e,t]}*values(){for(let[,e]of this)yield e}[(i=function({name:e,rawValue:t,append:r,fileName:o,argsLength:i}){let s,d=r?"append":"set";if(i<2)throw TypeError(`Failed to execute '${d}' on 'FormData': 2 arguments required, but only ${i} present.`);if(e=String(e),(0,u.isFile)(t))s=void 0===o?t:new l.File([t],o,{type:t.type,lastModified:t.lastModified});else if((0,c.isBlob)(t))s=new l.File([t],void 0===o?"blob":o,{type:t.type});else if(o)throw TypeError(`Failed to execute '${d}' on 'FormData': parameter 2 is not of type 'Blob'.`);else s=String(t);let f=a(this,n,"f").get(e);f&&r?f.push(s):a(this,n,"f").set(e,[s])},Symbol.iterator)](){return this.entries()}forEach(e,t){for(let[r,o]of this)e.call(t,o,r,this)}get[Symbol.toStringTag](){return"FormData"}[s.inspect.custom](){return this[Symbol.toStringTag]}}r.FormData=h},96961,(e,t,r)=>{"use strict";var o=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),n(e.r(21501),r),n(e.r(26356),r),n(e.r(99435),r)},13676,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let o="abcdefghijklmnopqrstuvwxyz0123456789";r.default=function(){let e=16,t="";for(;e--;)t+=o[Math.random()*o.length|0];return t}},11670,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){if("object"!==Object.prototype.toString.call(e).slice(8,-1).toLowerCase())return!1;let t=Object.getPrototypeOf(e);return null==t||(t.constructor&&t.constructor.toString())===Object.toString()}},75710,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=e=>String(e).replace(/\r|\n/g,(e,t,r)=>"\r"===e&&"\n"!==r[t+1]||"\n"===e&&"\r"!==r[t-1]?"\r\n":e)},52068,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=e=>String(e).replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/"/g,"%22")},59460,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=e=>"function"==typeof e},21631,(e,t,r)=>{"use strict";var o=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.isFileLike=void 0;let n=o(e.r(59460));r.isFileLike=e=>!!(e&&"object"==typeof e&&(0,n.default)(e.constructor)&&"File"===e[Symbol.toStringTag]&&(0,n.default)(e.stream)&&null!=e.name&&null!=e.size&&null!=e.lastModified)},22246,(e,t,r)=>{"use strict";var o=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.isFormDataLike=r.isFormData=void 0;let n=o(e.r(59460));r.isFormData=e=>!!(e&&(0,n.default)(e.constructor)&&"FormData"===e[Symbol.toStringTag]&&(0,n.default)(e.append)&&(0,n.default)(e.getAll)&&(0,n.default)(e.entries)&&(0,n.default)(e[Symbol.iterator])),r.isFormDataLike=r.isFormData},74145,(e,t,r)=>{"use strict";var o,n,i,a,s,l,u,c,d,f,h=e.e&&e.e.__classPrivateFieldSet||function(e,t,r,o,n){if("m"===o)throw TypeError("Private method is not writable");if("a"===o&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,r):n?n.value=r:t.set(e,r),r},p=e.e&&e.e.__classPrivateFieldGet||function(e,t,r,o){if("a"===r&&!o)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)},b=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.Encoder=r.FormDataEncoder=void 0;let y=b(e.r(13676)),m=b(e.r(11670)),_=b(e.r(75710)),g=b(e.r(52068)),v=e.r(21631),w=e.r(22246),S={enableAdditionalHeaders:!1};class R{constructor(e,t,r){let f;if(o.add(this),n.set(this,"\r\n"),i.set(this,void 0),a.set(this,void 0),s.set(this,"-".repeat(2)),l.set(this,new TextEncoder),u.set(this,void 0),c.set(this,void 0),d.set(this,void 0),!(0,w.isFormData)(e))throw TypeError("Expected first argument to be a FormData instance.");if((0,m.default)(t)?r=t:f=t,f||(f=(0,y.default)()),"string"!=typeof f)throw TypeError("Expected boundary argument to be a string.");if(r&&!(0,m.default)(r))throw TypeError("Expected options argument to be an object.");h(this,c,e,"f"),h(this,d,{...S,...r},"f"),h(this,i,p(this,l,"f").encode(p(this,n,"f")),"f"),h(this,a,p(this,i,"f").byteLength,"f"),this.boundary=`form-data-boundary-${f}`,this.contentType=`multipart/form-data; boundary=${this.boundary}`,h(this,u,p(this,l,"f").encode(`${p(this,s,"f")}${this.boundary}${p(this,s,"f")}${p(this,n,"f").repeat(2)}`),"f"),this.contentLength=String(this.getContentLength()),this.headers=Object.freeze({"Content-Type":this.contentType,"Content-Length":this.contentLength}),Object.defineProperties(this,{boundary:{writable:!1,configurable:!1},contentType:{writable:!1,configurable:!1},contentLength:{writable:!1,configurable:!1},headers:{writable:!1,configurable:!1}})}getContentLength(){let e=0;for(let[t,r]of p(this,c,"f")){let n=(0,v.isFileLike)(r)?r:p(this,l,"f").encode((0,_.default)(r));e+=p(this,o,"m",f).call(this,t,n).byteLength,e+=(0,v.isFileLike)(n)?n.size:n.byteLength,e+=p(this,a,"f")}return e+p(this,u,"f").byteLength}*values(){for(let[e,t]of p(this,c,"f").entries()){let r=(0,v.isFileLike)(t)?t:p(this,l,"f").encode((0,_.default)(t));yield p(this,o,"m",f).call(this,e,r),yield r,yield p(this,i,"f")}yield p(this,u,"f")}async *encode(){for(let e of this.values())(0,v.isFileLike)(e)?yield*e.stream():yield e}[(n=new WeakMap,i=new WeakMap,a=new WeakMap,s=new WeakMap,l=new WeakMap,u=new WeakMap,c=new WeakMap,d=new WeakMap,o=new WeakSet,f=function(e,t){let r="";return r+=`${p(this,s,"f")}${this.boundary}${p(this,n,"f")}Content-Disposition: form-data; name="${(0,g.default)(e)}"`,(0,v.isFileLike)(t)&&(r+=`; filename="${(0,g.default)(t.name)}"${p(this,n,"f")}Content-Type: ${t.type||"application/octet-stream"}`),!0===p(this,d,"f").enableAdditionalHeaders&&(r+=`${p(this,n,"f")}Content-Length: ${(0,v.isFileLike)(t)?t.size:t.byteLength}`),p(this,l,"f").encode(`${r}${p(this,n,"f").repeat(2)}`)},Symbol.iterator)](){return this.values()}[Symbol.asyncIterator](){return this.encode()}}r.FormDataEncoder=R,r.Encoder=R},34621,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},60358,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},33352,(e,t,r)=>{"use strict";var o=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),n(e.r(74145),r),n(e.r(34621),r),n(e.r(60358),r),n(e.r(21631),r),n(e.r(22246),r)},74798,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.MultipartBody=void 0;class o{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}r.MultipartBody=o},46706,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){if("object"!==Object.prototype.toString.call(e).slice(8,-1).toLowerCase())return!1;let t=Object.getPrototypeOf(e);return null==t||(t.constructor&&t.constructor.toString())===Object.toString()}},79895,(e,t,r)=>{"use strict";var o,n,i=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),a=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)},s=e.e&&e.e.__classPrivateFieldSet||function(e,t,r,o,n){if("m"===o)throw TypeError("Private method is not writable");if("a"===o&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,r):n?n.value=r:t.set(e,r),r},l=e.e&&e.e.__classPrivateFieldGet||function(e,t,r,o){if("a"===r&&!o)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)},u=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.fileFromPath=r.fileFromPathSync=void 0;let c=e.r(22734),d=e.r(14747),f=u(e.r(79556)),h=e.r(99435),p=u(e.r(46706));a(e.r(70578),r);class b{constructor(e){o.set(this,void 0),n.set(this,void 0),s(this,o,e.path,"f"),s(this,n,e.start||0,"f"),this.name=(0,d.basename)(l(this,o,"f")),this.size=e.size,this.lastModified=e.lastModified}slice(e,t){return new b({path:l(this,o,"f"),lastModified:this.lastModified,size:t-e,start:e})}async *stream(){let{mtimeMs:e}=await c.promises.stat(l(this,o,"f"));if(e>this.lastModified)throw new f.default("The requested file could not be read, typically due to permission problems that have occurred after a reference to a file was acquired.","NotReadableError");this.size&&(yield*(0,c.createReadStream)(l(this,o,"f"),{start:l(this,n,"f"),end:l(this,n,"f")+this.size-1}))}get[(o=new WeakMap,n=new WeakMap,Symbol.toStringTag)](){return"File"}}function y(e,{mtimeMs:t,size:r},o,n={}){let i;(0,p.default)(o)?[n,i]=[o,void 0]:i=o;let a=new b({path:e,size:r,lastModified:t});return i||(i=a.name),new h.File([a],i,{...n,lastModified:a.lastModified})}r.fileFromPathSync=function(e,t,r={}){let o=(0,c.statSync)(e);return y(e,o,t,r)},r.fileFromPath=async function(e,t,r){let o=await c.promises.stat(e);return y(e,o,t,r)}},5800,(e,t,r)=>{"use strict";var o=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return n(t,e),t},a=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.getRuntime=void 0;let s=i(e.r(49514)),l=i(e.r(96961)),u=a(e.r(34502)),c=e.r(6983),d=e.r(2157),f=e.r(33352),h=e.r(81111),p=e.r(74798),b=e.r(18352),y=!1;async function m(t,...r){let{fileFromPath:o}=await Promise.resolve().then(()=>i(e.r(79895)));return y||(console.warn(`fileFromPath is deprecated; use fs.createReadStream(${JSON.stringify(t)}) instead`),y=!0),await o(t,...r)}let _=new u.default({keepAlive:!0,timeout:3e5}),g=new u.default.HttpsAgent({keepAlive:!0,timeout:3e5});async function v(e,t){let r=new f.FormDataEncoder(e),o=h.Readable.from(r),n=new p.MultipartBody(o),i={...t.headers,...r.headers,"Content-Length":r.contentLength};return{...t,body:n,headers:i}}r.getRuntime=function(){return"undefined"==typeof AbortController&&(globalThis.AbortController=c.AbortController),{kind:"node",fetch:s.default,Request:s.Request,Response:s.Response,Headers:s.Headers,FormData:l.FormData,Blob:l.Blob,File:l.File,ReadableStream:b.ReadableStream,getMultipartRequestOptions:v,getDefaultAgent:e=>e.startsWith("https")?g:_,fileFromPath:m,isFsReadStream:e=>e instanceof d.ReadStream}}},76737,(e,t,r)=>{"use strict";var o=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),n(e.r(5800),r)},28573,(e,t,r)=>{let o=e.r(56665),n=e.r(76737);for(let e of(r.init=()=>{o.kind||o.setShims(n.getRuntime(),{auto:!0})},Object.keys(o)))Object.defineProperty(r,e,{get:()=>o[e]});r.init()},89601,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.InternalServerError=r.RateLimitError=r.UnprocessableEntityError=r.ConflictError=r.NotFoundError=r.PermissionDeniedError=r.AuthenticationError=r.BadRequestError=r.APIConnectionTimeoutError=r.APIConnectionError=r.APIUserAbortError=r.APIError=r.GroqError=void 0;let o=e.r(63575);class n extends Error{}r.GroqError=n;class i extends n{constructor(e,t,r,o){super(`${i.makeMessage(e,t,r)}`),this.status=e,this.headers=o,this.error=t}static makeMessage(e,t,r){let o=t?.message?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&o?`${e} ${o}`:e?`${e} status code (no body)`:o||"(no status code or body)"}static generate(e,t,r,n){return e&&n?400===e?new s(e,t,r,n):401===e?new l(e,t,r,n):403===e?new u(e,t,r,n):404===e?new c(e,t,r,n):409===e?new d(e,t,r,n):422===e?new f(e,t,r,n):429===e?new h(e,t,r,n):e>=500?new p(e,t,r,n):new i(e,t,r,n):new a({message:r,cause:(0,o.castToError)(t)})}}r.APIError=i,r.APIUserAbortError=class extends i{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}};class a extends i{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}r.APIConnectionError=a,r.APIConnectionTimeoutError=class extends a{constructor({message:e}={}){super({message:e??"Request timed out."})}};class s extends i{}r.BadRequestError=s;class l extends i{}r.AuthenticationError=l;class u extends i{}r.PermissionDeniedError=u;class c extends i{}r.NotFoundError=c;class d extends i{}r.ConflictError=d;class f extends i{}r.UnprocessableEntityError=f;class h extends i{}r.RateLimitError=h;class p extends i{}r.InternalServerError=p},95997,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.readableStreamAsyncIterable=r.Stream=void 0;let o=e.r(28573),n=e.r(89601),i=e.r(89601);class a{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let r=!1,o=new s;async function*c(){if(!e.body)throw t.abort(),new n.GroqError("Attempted to iterate over a response with no body");let r=new l;for await(let t of u(e.body))for(let e of r.decode(t)){let t=o.decode(e);t&&(yield t)}for(let e of r.flush()){let t=o.decode(e);t&&(yield t)}}return new a(async function*(){if(r)throw Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let e=!1;try{for await(let t of c())if(!e){if(t.data.startsWith("[DONE]")){e=!0;continue}if(null===t.event||"error"===t.event){let e;try{e=JSON.parse(t.data)}catch(e){throw console.error("Could not parse message into JSON:",t.data),console.error("From chunk:",t.raw),e}if(e&&e.error)throw new i.APIError(e.error.status_code,e.error,e.error.message,void 0);yield e}}e=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{e||t.abort()}},t)}static fromReadableStream(e,t){let r=!1;async function*o(){let t=new l;for await(let r of u(e))for(let e of t.decode(r))yield e;for(let e of t.flush())yield e}return new a(async function*(){if(r)throw Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let e=!1;try{for await(let t of o())!e&&t&&(yield JSON.parse(t));e=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{e||t.abort()}},t)}[Symbol.asyncIterator](){return this.iterator()}tee(){let e=[],t=[],r=this.iterator(),o=o=>({next:()=>{if(0===o.length){let o=r.next();e.push(o),t.push(o)}return o.shift()}});return[new a(()=>o(e),this.controller),new a(()=>o(t),this.controller)]}toReadableStream(){let e,t=this,r=new TextEncoder;return new o.ReadableStream({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{let{value:o,done:n}=await e.next();if(n)return t.close();let i=r.encode(JSON.stringify(o)+"\n");t.enqueue(i)}catch(e){t.error(e)}},async cancel(){await e.return?.()}})}}r.Stream=a;class s{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){var t;let r;if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[o,n,i]=-1!==(r=(t=e).indexOf(":"))?[t.substring(0,r),":",t.substring(r+1)]:[t,"",""];return i.startsWith(" ")&&(i=i.substring(1)),"event"===o?this.event=i:"data"===o&&this.data.push(i),null}}class l{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];let r=l.NEWLINE_CHARS.has(t[t.length-1]||""),o=t.split(l.NEWLINE_REGEXP);return 1!==o.length||r?(this.buffer.length>0&&(o=[this.buffer.join("")+o[0],...o.slice(1)],this.buffer=[]),r||(this.buffer=[o.pop()||""]),o):(this.buffer.push(o[0]),[])}decodeText(e){if(null==e)return"";if("string"==typeof e)return e;if("undefined"!=typeof Buffer){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new n.GroqError(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new n.GroqError(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new n.GroqError("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];let e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}function u(e){if(e[Symbol.asyncIterator])return e;let t=e.getReader();return{async next(){try{let e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){let e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}l.NEWLINE_CHARS=new Set(["\n","\r","\v","\f","\x1c","\x1d","\x1e","","\u2028","\u2029"]),l.NEWLINE_REGEXP=/\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g,r.readableStreamAsyncIterable=u},59110,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createForm=r.multipartFormRequestOptions=r.maybeMultipartFormRequestOptions=r.isMultipartBody=r.toFile=r.isUploadable=r.isBlobLike=r.isFileLike=r.isResponseLike=r.fileFromPath=void 0;let o=e.r(28573);var n=e.r(28573);async function i(e,t,n){var i;if(e=await e,(0,r.isFileLike)(e))return e;if((0,r.isResponseLike)(e)){let i=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");let a=(0,r.isBlobLike)(i)?[await i.arrayBuffer()]:[i];return new o.File(a,t,n)}let l=await a(e);if(t||(t=(s((i=e).name)||s(i.filename)||s(i.path)?.split(/[\\/]/).pop())??"unknown_file"),!n?.type){let e=l[0]?.type;"string"==typeof e&&(n={...n,type:e})}return new o.File(l,t,n)}async function a(e){let t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if((0,r.isBlobLike)(e))t.push(await e.arrayBuffer());else if(l(e))for await(let r of e)t.push(r);else{let t;throw Error(`Unexpected data type: ${typeof e}; constructor: ${e?.constructor?.name}; props: ${(t=Object.getOwnPropertyNames(e),`[${t.map(e=>`"${e}"`).join(", ")}]`)}`)}return t}Object.defineProperty(r,"fileFromPath",{enumerable:!0,get:function(){return n.fileFromPath}}),r.isResponseLike=e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob,r.isFileLike=e=>null!=e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&(0,r.isBlobLike)(e),r.isBlobLike=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer,r.isUploadable=e=>(0,r.isFileLike)(e)||(0,r.isResponseLike)(e)||(0,o.isFsReadStream)(e),r.toFile=i;let s=e=>"string"==typeof e?e:"undefined"!=typeof Buffer&&e instanceof Buffer?String(e):void 0,l=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator];r.isMultipartBody=e=>e&&"object"==typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag];let u=async e=>{if(!d(e.body))return e;let t=await (0,r.createForm)(e.body);return(0,o.getMultipartRequestOptions)(t,e)};r.maybeMultipartFormRequestOptions=u;let c=async e=>{let t=await (0,r.createForm)(e.body);return(0,o.getMultipartRequestOptions)(t,e)};r.multipartFormRequestOptions=c,r.createForm=async e=>{let t=new o.FormData;return await Promise.all(Object.entries(e||{}).map(([e,r])=>f(t,e,r))),t};let d=e=>{if((0,r.isUploadable)(e))return!0;if(Array.isArray(e))return e.some(d);if(e&&"object"==typeof e){for(let t in e)if(d(e[t]))return!0}return!1},f=async(e,t,o)=>{if(void 0!==o){if(null==o)throw TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof o||"number"==typeof o||"boolean"==typeof o)e.append(t,String(o));else if((0,r.isUploadable)(o)){let r=await i(o);e.append(t,r)}else if(Array.isArray(o))await Promise.all(o.map(r=>f(e,t+"[]",r)));else if("object"==typeof o)await Promise.all(Object.entries(o).map(([r,o])=>f(e,`${t}[${r}]`,o)));else throw TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${o} instead`)}}},63575,(e,t,r)=>{"use strict";let o;var n,i,a=e.e&&e.e.__classPrivateFieldSet||function(e,t,r,o,n){if("m"===o)throw TypeError("Private method is not writable");if("a"===o&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,r):n?n.value=r:t.set(e,r),r},s=e.e&&e.e.__classPrivateFieldGet||function(e,t,r,o){if("a"===r&&!o)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.isObj=r.toBase64=r.getHeader=r.getRequiredHeader=r.isHeadersProtocol=r.isRunningInBrowser=r.debug=r.hasOwn=r.isEmptyObj=r.maybeCoerceBoolean=r.maybeCoerceFloat=r.maybeCoerceInteger=r.coerceBoolean=r.coerceFloat=r.coerceInteger=r.readEnv=r.ensurePresent=r.castToError=r.sleep=r.safeJSON=r.isRequestOptions=r.createResponseHeaders=r.PagePromise=r.AbstractPage=r.APIClient=r.APIPromise=r.createForm=r.multipartFormRequestOptions=r.maybeMultipartFormRequestOptions=void 0;let l=e.r(73934),u=e.r(95997),c=e.r(89601),d=e.r(28573);(0,d.init)();let f=e.r(59110);var h=e.r(59110);async function p(e){let{response:t}=e;if(e.options.stream)return(A("response",t.status,t.url,t.headers,t.body),e.options.__streamClass)?e.options.__streamClass.fromSSEResponse(t,e.controller):u.Stream.fromSSEResponse(t,e.controller);if(204===t.status)return null;if(e.options.__binaryResponse)return t;let r=t.headers.get("content-type"),o=r?.split(";")[0]?.trim();if(o?.includes("application/json")||o?.endsWith("+json")){let e=await t.json();return A("response",t.status,t.url,t.headers,e),e}let n=await t.text();return A("response",t.status,t.url,t.headers,n),n}Object.defineProperty(r,"maybeMultipartFormRequestOptions",{enumerable:!0,get:function(){return h.maybeMultipartFormRequestOptions}}),Object.defineProperty(r,"multipartFormRequestOptions",{enumerable:!0,get:function(){return h.multipartFormRequestOptions}}),Object.defineProperty(r,"createForm",{enumerable:!0,get:function(){return h.createForm}});class b extends Promise{constructor(e,t=p){super(e=>{e(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new b(this.responsePromise,async t=>e(await this.parseResponse(t),t))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}r.APIPromise=b,r.APIClient=class{constructor({baseURL:e,baseURLOverridden:t,maxRetries:r=2,timeout:o=6e4,httpAgent:i,fetch:s}){n.set(this,void 0),this.baseURL=e,a(this,n,t,"f"),this.maxRetries=P("maxRetries",r),this.timeout=P("timeout",o),this.httpAgent=i,this.fetch=s??d.fetch}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json",...["head","get"].includes(e.method)?{}:{"Content-Type":"application/json"},"User-Agent":this.getUserAgent(),...w(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${j()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(async r=>{let o=r&&(0,f.isBlobLike)(r?.body)?new DataView(await r.body.arrayBuffer()):r?.body instanceof DataView?r.body:r?.body instanceof ArrayBuffer?new DataView(r.body):r&&ArrayBuffer.isView(r?.body)?new DataView(r.body.buffer):r?.body;return{method:e,path:t,...r,body:o}}))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if("string"==typeof e){if("undefined"!=typeof Buffer)return Buffer.byteLength(e,"utf8").toString();if("undefined"!=typeof TextEncoder)return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}async buildRequest(e,{retryCount:t=0}={}){let r={...e},{method:o,path:n,query:i,defaultBaseURL:a,headers:s={}}=r,l=ArrayBuffer.isView(r.body)||r.__binaryRequest&&"string"==typeof r.body?r.body:(0,f.isMultipartBody)(r.body)?r.body.body:r.body?JSON.stringify(r.body,null,2):null,u=this.calculateContentLength(l),c=this.buildURL(n,i,a);"timeout"in r&&P("timeout",r.timeout),r.timeout=r.timeout??this.timeout;let h=r.httpAgent??this.httpAgent??(0,d.getDefaultAgent)(c),p=r.timeout+1e3;"number"==typeof h?.options?.timeout&&p>(h.options.timeout??0)&&(h.options.timeout=p),this.idempotencyHeader&&"get"!==o&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=e.idempotencyKey);let b=this.buildHeaders({options:r,headers:s,contentLength:u,retryCount:t});return{req:{method:o,...l&&{body:l},headers:b,...h&&{agent:h},signal:r.signal??null},url:c,timeout:r.timeout}}buildHeaders({options:e,headers:t,contentLength:o,retryCount:n}){let i={};o&&(i["content-length"]=o);let a=this.defaultHeaders(e);return T(i,a),T(i,t),(0,f.isMultipartBody)(e.body)&&"node"!==d.kind&&delete i["content-type"],void 0===(0,r.getHeader)(a,"x-stainless-retry-count")&&void 0===(0,r.getHeader)(t,"x-stainless-retry-count")&&(i["x-stainless-retry-count"]=String(n)),void 0===(0,r.getHeader)(a,"x-stainless-timeout")&&void 0===(0,r.getHeader)(t,"x-stainless-timeout")&&e.timeout&&(i["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(i,t),i}async prepareOptions(e){}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(e=>[...e])):{...e}:{}}makeStatusError(e,t,r,o){return c.APIError.generate(e,t,r,o)}request(e,t=null){return new b(this.makeRequest(e,t))}async makeRequest(e,t){let o=await e,n=o.maxRetries??this.maxRetries;null==t&&(t=n),await this.prepareOptions(o);let{req:i,url:a,timeout:s}=await this.buildRequest(o,{retryCount:n-t});if(await this.prepareRequest(i,{url:a,options:o}),A("request",a,o,i.headers),o.signal?.aborted)throw new c.APIUserAbortError;let l=new AbortController,u=await this.fetchWithTimeout(a,i,s,l).catch(r.castToError);if(u instanceof Error){if(o.signal?.aborted)throw new c.APIUserAbortError;if(t)return this.retryRequest(o,t);if("AbortError"===u.name)throw new c.APIConnectionTimeoutError;throw new c.APIConnectionError({cause:u})}let d=(0,r.createResponseHeaders)(u.headers);if(!u.ok){if(t&&this.shouldRetry(u)){let e=`retrying, ${t} attempts remaining`;return A(`response (error; ${e})`,u.status,a,d),this.retryRequest(o,t,d)}let e=await u.text().catch(e=>(0,r.castToError)(e).message),n=(0,r.safeJSON)(e),i=n?void 0:e,s=t?"(error; no more retries left)":"(error; not retryable)";throw A(`response (error; ${s})`,u.status,a,d,i),this.makeStatusError(u.status,n,i,d)}return{response:u,options:o,controller:l}}requestAPIList(e,t){return new m(this,this.makeRequest(t,null),e)}buildURL(e,t,r){let o=!s(this,n,"f")&&r||this.baseURL,i=new URL(R(e)?e:o+(o.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),a=this.defaultQuery();return E(a)||(t={...a,...t}),"object"==typeof t&&t&&!Array.isArray(t)&&(i.search=this.stringifyQuery(t)),i.toString()}stringifyQuery(e){return Object.entries(e).filter(([e,t])=>void 0!==t).map(([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new c.GroqError(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,r,o){let{signal:n,...i}=t||{};n&&n.addEventListener("abort",()=>o.abort());let a=setTimeout(()=>o.abort(),r),s={signal:o.signal,...i};return s.method&&(s.method=s.method.toUpperCase()),this.fetch.call(void 0,e,s).finally(()=>{clearTimeout(a)})}shouldRetry(e){let t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||409===e.status||429===e.status||!!(e.status>=500))}async retryRequest(e,t,o){let n,i=o?.["retry-after-ms"];if(i){let e=parseFloat(i);Number.isNaN(e)||(n=e)}let a=o?.["retry-after"];if(a&&!n){let e=parseFloat(a);n=Number.isNaN(e)?Date.parse(a)-Date.now():1e3*e}if(!(n&&0<=n&&n<6e4)){let r=e.maxRetries??this.maxRetries;n=this.calculateDefaultRetryTimeoutMillis(t,r)}return await (0,r.sleep)(n),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){return Math.min(.5*Math.pow(2,t-e),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS ${l.VERSION}`}},n=new WeakMap;class y{constructor(e,t,r,o){i.set(this,void 0),a(this,i,e,"f"),this.options=o,this.response=t,this.body=r}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){let e=this.nextPageInfo();if(!e)throw new c.GroqError("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");let t={...this.options};if("params"in e&&"object"==typeof t.query)t.query={...t.query,...e.params};else if("url"in e){for(let[r,o]of[...Object.entries(t.query||{}),...e.url.searchParams.entries()])e.url.searchParams.set(r,o);t.query=void 0,t.path=e.url.toString()}return await s(this,i,"f").requestAPIList(this.constructor,t)}async *iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async *[(i=new WeakMap,Symbol.asyncIterator)](){for await(let e of this.iterPages())for(let t of e.getPaginatedItems())yield t}}r.AbstractPage=y;class m extends b{constructor(e,t,r){super(t,async t=>new r(e,t.response,await p(t),t.options))}async *[Symbol.asyncIterator](){for await(let e of(await this))yield e}}r.PagePromise=m,r.createResponseHeaders=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){let r=t.toString();return e[r.toLowerCase()]||e[r]}});let _={method:!0,path:!0,query:!0,body:!0,headers:!0,defaultBaseURL:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0};r.isRequestOptions=e=>"object"==typeof e&&null!==e&&!E(e)&&Object.keys(e).every(e=>O(_,e));let g=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",v=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown",w=()=>o??(o=(()=>{if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":l.VERSION,"X-Stainless-OS":v(Deno.build.os),"X-Stainless-Arch":g(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":l.VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if("[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":l.VERSION,"X-Stainless-OS":v(process.platform),"X-Stainless-Arch":g(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};let e=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:e,pattern:t}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let r=t.exec(navigator.userAgent);if(r){let t=r[1]||0,o=r[2]||0,n=r[3]||0;return{browser:e,version:`${t}.${o}.${n}`}}}return null}();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":l.VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":l.VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}})());r.safeJSON=e=>{try{return JSON.parse(e)}catch(e){return}};let S=/^[a-z][a-z0-9+.-]*:/i,R=e=>S.test(e);r.sleep=e=>new Promise(t=>setTimeout(t,e));let P=(e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new c.GroqError(`${e} must be an integer`);if(t<0)throw new c.GroqError(`${e} must be a positive integer`);return t};function E(e){if(!e)return!0;for(let t in e)return!1;return!0}function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function T(e,t){for(let r in t){if(!O(t,r))continue;let o=r.toLowerCase();if(!o)continue;let n=t[r];null===n?delete e[o]:void 0!==n&&(e[o]=n)}}function A(e,...t){"undefined"!=typeof process&&process?.env?.DEBUG==="true"&&console.log(`Groq:DEBUG:${e}`,...t)}r.castToError=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e)try{return Error(JSON.stringify(e))}catch{}return Error(e)},r.ensurePresent=e=>{if(null==e)throw new c.GroqError(`Expected a value to be given but received ${e} instead.`);return e},r.readEnv=e=>"undefined"!=typeof process?process.env?.[e]?.trim()??void 0:"undefined"!=typeof Deno?Deno.env?.get?.(e)?.trim():void 0,r.coerceInteger=e=>{if("number"==typeof e)return Math.round(e);if("string"==typeof e)return parseInt(e,10);throw new c.GroqError(`Could not coerce ${e} (type: ${typeof e}) into a number`)},r.coerceFloat=e=>{if("number"==typeof e)return e;if("string"==typeof e)return parseFloat(e);throw new c.GroqError(`Could not coerce ${e} (type: ${typeof e}) into a number`)},r.coerceBoolean=e=>"boolean"==typeof e?e:"string"==typeof e?"true"===e:!!e,r.maybeCoerceInteger=e=>{if(null!=e)return(0,r.coerceInteger)(e)},r.maybeCoerceFloat=e=>{if(null!=e)return(0,r.coerceFloat)(e)},r.maybeCoerceBoolean=e=>{if(null!=e)return(0,r.coerceBoolean)(e)},r.isEmptyObj=E,r.hasOwn=O,r.debug=A;let j=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)});r.isRunningInBrowser=()=>!1,r.isHeadersProtocol=e=>"function"==typeof e?.get,r.getRequiredHeader=(e,t)=>{let o=(0,r.getHeader)(e,t);if(void 0===o)throw Error(`Could not find ${t} header`);return o},r.getHeader=(e,t)=>{let o=t.toLowerCase();if((0,r.isHeadersProtocol)(e)){let r=t[0]?.toUpperCase()+t.substring(1).replace(/([^\w])(\w)/g,(e,t,r)=>t+r.toUpperCase());for(let n of[t,o,t.toUpperCase(),r]){let t=e.get(n);if(t)return t}}for(let[r,n]of Object.entries(e))if(r.toLowerCase()===o){if(Array.isArray(n)){if(n.length<=1)return n[0];return console.warn(`Received ${n.length} entries for the ${t} header, using the first entry.`),n[0]}return n}},r.toBase64=e=>{if(!e)return"";if("undefined"!=typeof Buffer)return Buffer.from(e).toString("base64");if("undefined"!=typeof btoa)return btoa(e);throw new c.GroqError("Cannot generate b64 string; Expected `Buffer` or `btoa` to be defined")},r.isObj=function(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)}},66306,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},25944,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.APIResource=void 0,r.APIResource=class{constructor(e){this._client=e}}},5195,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Speech=void 0;let o=e.r(25944);class n extends o.APIResource{create(e,t){return this._client.post("/openai/v1/audio/speech",{body:e,...t,headers:{Accept:"audio/wav",...t?.headers},__binaryResponse:!0})}}r.Speech=n},68498,(e,t,r)=>{"use strict";var o=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return n(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.Transcriptions=void 0;let a=e.r(25944),s=i(e.r(63575));class l extends a.APIResource{create(e,t){return this._client.post("/openai/v1/audio/transcriptions",s.multipartFormRequestOptions({body:e,...t}))}}r.Transcriptions=l},26709,(e,t,r)=>{"use strict";var o=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return n(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.Translations=void 0;let a=e.r(25944),s=i(e.r(63575));class l extends a.APIResource{create(e,t){return this._client.post("/openai/v1/audio/translations",s.multipartFormRequestOptions({body:e,...t}))}}r.Translations=l},92082,(e,t,r)=>{"use strict";var o=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return n(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.Audio=void 0;let a=e.r(25944),s=i(e.r(5195)),l=e.r(5195),u=i(e.r(68498)),c=e.r(68498),d=i(e.r(26709)),f=e.r(26709);class h extends a.APIResource{constructor(){super(...arguments),this.speech=new s.Speech(this._client),this.transcriptions=new u.Transcriptions(this._client),this.translations=new d.Translations(this._client)}}r.Audio=h,h.Speech=l.Speech,h.Transcriptions=c.Transcriptions,h.Translations=f.Translations},46451,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Batches=void 0;let o=e.r(25944);class n extends o.APIResource{create(e,t){return this._client.post("/openai/v1/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/openai/v1/batches/${e}`,t)}list(e){return this._client.get("/openai/v1/batches",e)}cancel(e,t){return this._client.post(`/openai/v1/batches/${e}/cancel`,t)}}r.Batches=n},70924,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Completions=void 0;let o=e.r(25944);class n extends o.APIResource{create(e,t){return this._client.post("/openai/v1/chat/completions",{body:e,...t,stream:e.stream??!1})}}r.Completions=n},47822,(e,t,r)=>{"use strict";var o=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return n(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.Chat=void 0;let a=e.r(25944),s=i(e.r(70924)),l=e.r(70924);class u extends a.APIResource{constructor(){super(...arguments),this.completions=new s.Completions(this._client)}}r.Chat=u,u.Completions=l.Completions},29240,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Completions=void 0;let o=e.r(25944);class n extends o.APIResource{}r.Completions=n},93994,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Embeddings=void 0;let o=e.r(25944);class n extends o.APIResource{create(e,t){return this._client.post("/openai/v1/embeddings",{body:e,...t})}}r.Embeddings=n},23236,(e,t,r)=>{"use strict";var o=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return n(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.Files=void 0;let a=e.r(25944),s=i(e.r(63575));class l extends a.APIResource{create(e,t){return this._client.post("/openai/v1/files",s.multipartFormRequestOptions({body:e,...t}))}list(e){return this._client.get("/openai/v1/files",e)}delete(e,t){return this._client.delete(`/openai/v1/files/${e}`,t)}content(e,t){return this._client.get(`/openai/v1/files/${e}/content`,{...t,headers:{Accept:"application/octet-stream",...t?.headers},__binaryResponse:!0})}info(e,t){return this._client.get(`/openai/v1/files/${e}`,t)}}r.Files=l},96546,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Models=void 0;let o=e.r(25944);class n extends o.APIResource{retrieve(e,t){return this._client.get(`/openai/v1/models/${e}`,t)}list(e){return this._client.get("/openai/v1/models",e)}delete(e,t){return this._client.delete(`/openai/v1/models/${e}`,t)}}r.Models=n},86223,(e,t,r)=>{"use strict";var o=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=e.e&&e.e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.Models=r.Files=r.Embeddings=r.Completions=r.Chat=r.Batches=r.Audio=void 0,n(e.r(66306),r);var i=e.r(92082);Object.defineProperty(r,"Audio",{enumerable:!0,get:function(){return i.Audio}});var a=e.r(46451);Object.defineProperty(r,"Batches",{enumerable:!0,get:function(){return a.Batches}});var s=e.r(47822);Object.defineProperty(r,"Chat",{enumerable:!0,get:function(){return s.Chat}});var l=e.r(29240);Object.defineProperty(r,"Completions",{enumerable:!0,get:function(){return l.Completions}});var u=e.r(93994);Object.defineProperty(r,"Embeddings",{enumerable:!0,get:function(){return u.Embeddings}});var c=e.r(23236);Object.defineProperty(r,"Files",{enumerable:!0,get:function(){return c.Files}});var d=e.r(96546);Object.defineProperty(r,"Models",{enumerable:!0,get:function(){return d.Models}})},97091,(e,t,r)=>{"use strict";var o,n=e.e&&e.e.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),i=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.UnprocessableEntityError=r.PermissionDeniedError=r.InternalServerError=r.AuthenticationError=r.BadRequestError=r.RateLimitError=r.ConflictError=r.NotFoundError=r.APIUserAbortError=r.APIConnectionTimeoutError=r.APIConnectionError=r.APIError=r.GroqError=r.fileFromPath=r.toFile=r.Groq=void 0;let s=a(e.r(63575)),l=a(e.r(89601)),u=a(e.r(59110)),c=a(e.r(86223)),d=e.r(46451),f=e.r(29240),h=e.r(93994),p=e.r(23236),b=e.r(96546),y=e.r(92082),m=e.r(47822);class _ extends s.APIClient{constructor({baseURL:e=s.readEnv("GROQ_BASE_URL"),apiKey:t=s.readEnv("GROQ_API_KEY"),...r}={}){if(void 0===t)throw new l.GroqError("The GROQ_API_KEY environment variable is missing or empty; either provide it, or instantiate the Groq client with an apiKey option, like new Groq({ apiKey: 'My API Key' }).");const n={apiKey:t,...r,baseURL:e||"https://api.groq.com"};if(!n.dangerouslyAllowBrowser&&s.isRunningInBrowser())throw new l.GroqError("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew Groq({ apiKey, dangerouslyAllowBrowser: true })");super({baseURL:n.baseURL,baseURLOverridden:!!e&&"https://api.groq.com"!==e,timeout:n.timeout??6e4,httpAgent:n.httpAgent,maxRetries:n.maxRetries,fetch:n.fetch}),o.add(this),this.completions=new c.Completions(this),this.chat=new c.Chat(this),this.embeddings=new c.Embeddings(this),this.audio=new c.Audio(this),this.models=new c.Models(this),this.batches=new c.Batches(this),this.files=new c.Files(this),this._options=n,this.apiKey=t}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}}r.Groq=_,o=new WeakSet,_.Groq=_,_.DEFAULT_TIMEOUT=6e4,_.GroqError=l.GroqError,_.APIError=l.APIError,_.APIConnectionError=l.APIConnectionError,_.APIConnectionTimeoutError=l.APIConnectionTimeoutError,_.APIUserAbortError=l.APIUserAbortError,_.NotFoundError=l.NotFoundError,_.ConflictError=l.ConflictError,_.RateLimitError=l.RateLimitError,_.BadRequestError=l.BadRequestError,_.AuthenticationError=l.AuthenticationError,_.InternalServerError=l.InternalServerError,_.PermissionDeniedError=l.PermissionDeniedError,_.UnprocessableEntityError=l.UnprocessableEntityError,_.toFile=u.toFile,_.fileFromPath=u.fileFromPath,_.Completions=f.Completions,_.Chat=m.Chat,_.Embeddings=h.Embeddings,_.Audio=y.Audio,_.Models=b.Models,_.Batches=d.Batches,_.Files=p.Files;var g=e.r(59110);Object.defineProperty(r,"toFile",{enumerable:!0,get:function(){return g.toFile}}),Object.defineProperty(r,"fileFromPath",{enumerable:!0,get:function(){return g.fileFromPath}});var v=e.r(89601);Object.defineProperty(r,"GroqError",{enumerable:!0,get:function(){return v.GroqError}}),Object.defineProperty(r,"APIError",{enumerable:!0,get:function(){return v.APIError}}),Object.defineProperty(r,"APIConnectionError",{enumerable:!0,get:function(){return v.APIConnectionError}}),Object.defineProperty(r,"APIConnectionTimeoutError",{enumerable:!0,get:function(){return v.APIConnectionTimeoutError}}),Object.defineProperty(r,"APIUserAbortError",{enumerable:!0,get:function(){return v.APIUserAbortError}}),Object.defineProperty(r,"NotFoundError",{enumerable:!0,get:function(){return v.NotFoundError}}),Object.defineProperty(r,"ConflictError",{enumerable:!0,get:function(){return v.ConflictError}}),Object.defineProperty(r,"RateLimitError",{enumerable:!0,get:function(){return v.RateLimitError}}),Object.defineProperty(r,"BadRequestError",{enumerable:!0,get:function(){return v.BadRequestError}}),Object.defineProperty(r,"AuthenticationError",{enumerable:!0,get:function(){return v.AuthenticationError}}),Object.defineProperty(r,"InternalServerError",{enumerable:!0,get:function(){return v.InternalServerError}}),Object.defineProperty(r,"PermissionDeniedError",{enumerable:!0,get:function(){return v.PermissionDeniedError}}),Object.defineProperty(r,"UnprocessableEntityError",{enumerable:!0,get:function(){return v.UnprocessableEntityError}}),(r=t.exports=_).default=_},67756,e=>{"use strict";var t=e.i(74119),r=e.i(74815),o=e.i(66969),n=e.i(8984),i=e.i(80568),a=e.i(85983),s=e.i(51311),l=e.i(48892),u=e.i(16339),c=e.i(34600),d=e.i(71794),f=e.i(4358),h=e.i(80603),p=e.i(79181),b=e.i(53442),y=e.i(70798),m=e.i(93695);e.i(51004);var _=e.i(64291),g=e.i(14539),v=e.i(91275);e.i(8559),e.i(36794),e.i(105);let w={"lib/ai-engines/handlers/booking.searchHotels":async(t,r)=>{let{searchHotels:o}=await e.A(24498);return o(t,r)},"lib/ai-engines/handlers/booking.prebookRoom":async(t,r)=>{let{prebookRoom:o}=await e.A(24498);return o(t,r)},"lib/ai-engines/handlers/booking.bookRoom":async(t,r)=>{let{bookRoom:o}=await e.A(24498);return o(t,r)},"lib/ai-engines/handlers/booking.cancelBooking":async(t,r)=>{let{cancelBooking:o}=await e.A(24498);return o(t,r)},"lib/ai-engines/handlers/booking.getCancellationPolicy":async(t,r)=>{let{getCancellationPolicy:o}=await e.A(24498);return o(t,r)},"lib/ai-engines/handlers/voice.initiateCall":async(t,r)=>{let{initiateCall:o}=await e.A(78761);return o(t,r)},"lib/ai-engines/handlers/voice.transferToHuman":async(t,r)=>{let{transferToHuman:o}=await e.A(78761);return o(t,r)},"lib/ai-engines/handlers/voice.sendCallSummarySms":async(t,r)=>{let{sendCallSummarySms:o}=await e.A(78761);return o(t,r)},"lib/ai-engines/handlers/monitoring.trackHotelPrice":async(t,r)=>{let{trackHotelPrice:o}=await e.A(50524);return o(t,r)},"lib/ai-engines/handlers/monitoring.getPriceHistory":async(t,r)=>{let{getPriceHistory:o}=await e.A(50524);return o(t,r)},"lib/ai-engines/handlers/monitoring.analyzePriceTrends":async(t,r)=>{let{analyzePriceTrends:o}=await e.A(50524);return o(t,r)}};async function S(e,t,r){let o=w[e];if(!o)throw Error(`Handler not found: ${e}`);return o(t,r)}let R=null;function P(){return!R&&process.env.GROQ_API_KEY&&(R=new(e.r(97091)).default({apiKey:process.env.GROQ_API_KEY})),R}async function E(e){try{let t,{conversationId:r,message:o,engineId:n,userId:i,language:a="he"}=await e.json(),s=(0,v.getAIEngineManager)(),l=r?s.getConversation(r):null;if(!l&&n&&(l=s.startConversation(n,i)),!l)return g.NextResponse.json({success:!1,error:"No active conversation. Please start a conversation first."},{status:400});let u=s.getEngine(l.engineInstanceId);if(!u)return g.NextResponse.json({success:!1,error:"Engine not found"},{status:404});let c=s.shouldTriggerHandoff(o,l);if(c.shouldHandoff&&c.targetEngine){let e=await s.executeHandoff(l.conversationId,c.targetEngine);e.success&&e.newContext&&(l=e.newContext)}let d="he"===a&&u.template.prompts.systemPromptHe||u.template.prompts.systemPrompt,f=s.formatToolsForLLM(u.instanceId),h=[{role:"system",content:d}];l.metadata?.history&&h.push(...l.metadata.history),h.push({role:"user",content:o});let p=u.template.modelConfig,b=P();if(!b)return g.NextResponse.json({success:!1,error:"GROQ_API_KEY not configured. Please add it to environment variables."},{status:500});try{t=await b.chat.completions.create({model:p.model,messages:h,tools:f.length>0?f:void 0,tool_choice:f.length>0?"auto":void 0,temperature:p.temperature,max_tokens:p.maxTokens})}catch(e){return console.error("[Chat API] LLM error:",e),g.NextResponse.json({success:!1,error:"Failed to process message"},{status:500})}let y=t.choices[0]?.message,m=y?.content||"",_=[];if(y?.tool_calls&&y.tool_calls.length>0){for(let e of y.tool_calls){let t=e.function.name,r=JSON.parse(e.function.arguments);console.log(`[Chat API] Executing tool: ${t}`,r);try{let o={search_hotels:"lib/ai-engines/handlers/booking.searchHotels",prebook_room:"lib/ai-engines/handlers/booking.prebookRoom",book_room:"lib/ai-engines/handlers/booking.bookRoom",cancel_booking:"lib/ai-engines/handlers/booking.cancelBooking",get_cancellation_policy:"lib/ai-engines/handlers/booking.getCancellationPolicy",initiate_call:"lib/ai-engines/handlers/voice.initiateCall",transfer_to_human:"lib/ai-engines/handlers/voice.transferToHuman",send_call_summary_sms:"lib/ai-engines/handlers/voice.sendCallSummarySms",track_hotel_price:"lib/ai-engines/handlers/monitoring.trackHotelPrice",get_price_history:"lib/ai-engines/handlers/monitoring.getPriceHistory",analyze_price_trends:"lib/ai-engines/handlers/monitoring.analyzePriceTrends"}[t];if(o){let n=await S(o,r,l);_.push({toolCallId:e.id,toolName:t,result:n})}else _.push({toolCallId:e.id,toolName:t,result:{error:"Tool handler not found"}})}catch(r){console.error("[Chat API] Tool execution error:",r),_.push({toolCallId:e.id,toolName:t,error:r.message})}}if(_.length>0){let e=_.map(e=>({role:"tool",tool_call_id:e.toolCallId,content:JSON.stringify(e.result||e.error)}));try{let t=P(),r=await t.chat.completions.create({model:p.model,messages:[...h,y,...e],temperature:p.temperature,max_tokens:p.maxTokens});m=r.choices[0]?.message?.content||m}catch(e){console.error("[Chat API] Final completion error:",e)}}}return s.updateConversation(l.conversationId,{messageCount:l.messageCount+1,metadata:{...l.metadata,history:[...l.metadata?.history||[],{role:"user",content:o},{role:"assistant",content:m}].slice(-20)}}),g.NextResponse.json({success:!0,conversationId:l.conversationId,response:m,toolsExecuted:_.map(e=>({name:e.toolName,success:!e.error})),engine:{id:u.instanceId,name:u.template.name,persona:u.template.persona?.name}})}catch(e){return console.error("[Chat API] Error:",e),g.NextResponse.json({success:!1,error:e.message},{status:500})}}e.s(["POST",()=>E],74055);var O=e.i(74055);let T=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/ai-engines/chat/route",pathname:"/api/ai-engines/chat",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/v0-bookinengine/app/api/ai-engines/chat/route.ts",nextConfigOutput:"",userland:O}),{workAsyncStorage:A,workUnitAsyncStorage:j,serverHooks:q}=T;function C(){return(0,o.patchFetch)({workAsyncStorage:A,workUnitAsyncStorage:j})}async function k(e,t,o){T.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let g="/api/ai-engines/chat/route";g=g.replace(/\/index$/,"")||"/";let v=await T.prepare(e,t,{srcPage:g,multiZoneDraftMode:!1});if(!v)return t.statusCode=400,t.end("Bad Request"),null==o.waitUntil||o.waitUntil.call(o,Promise.resolve()),null;let{buildId:w,params:S,nextConfig:R,parsedUrl:P,isDraftMode:E,prerenderManifest:O,routerServerContext:A,isOnDemandRevalidate:j,revalidateOnlyGenerated:q,resolvedPathname:C,clientReferenceManifest:k,serverActionsManifest:F}=v,M=(0,l.normalizeAppPath)(g),x=!!(O.dynamicRoutes[M]||O.routes[C]),I=async()=>((null==A?void 0:A.render404)?await A.render404(e,t,P,!1):t.end("This page could not be found"),null);if(x&&!E){let e=!!O.routes[C],t=O.dynamicRoutes[M];if(t&&!1===t.fallback&&!e){if(R.experimental.adapterPath)return await I();throw new m.NoFallbackError}}let B=null;!x||T.isDev||E||(B="/index"===(B=C)?"/":B);let L=!0===T.isDev||!x,W=x&&!L;F&&k&&(0,a.setReferenceManifestsSingleton)({page:g,clientReferenceManifest:k,serverActionsManifest:F,serverModuleMap:(0,s.createServerModuleMap)({serverActionsManifest:F})});let $=e.method||"GET",D=(0,i.getTracer)(),N=D.getActiveScopeSpan(),z={params:S,prerenderManifest:O,renderOpts:{experimental:{authInterrupts:!!R.experimental.authInterrupts},cacheComponents:!!R.cacheComponents,supportsDynamicResponse:L,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:R.cacheLife,waitUntil:o.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,o)=>T.onRequestError(e,t,o,A)},sharedContext:{buildId:w}},H=new u.NodeNextRequest(e),U=new u.NodeNextResponse(t),V=c.NextRequestAdapter.fromNodeNextRequest(H,(0,c.signalFromNodeResponse)(t));try{let a=async e=>T.handle(V,z).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=D.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let o=r.get("next.route");if(o){let t=`${$} ${o}`;e.setAttributes({"next.route":o,"http.route":o,"next.span_name":t}),e.updateName(t)}else e.updateName(`${$} ${g}`)}),s=!!(0,n.getRequestMeta)(e,"minimalMode"),l=async n=>{var i,l;let u=async({previousCacheEntry:r})=>{try{if(!s&&j&&q&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await a(n);e.fetchMetrics=z.renderOpts.fetchMetrics;let l=z.renderOpts.pendingWaitUntil;l&&o.waitUntil&&(o.waitUntil(l),l=void 0);let u=z.renderOpts.collectedTags;if(!x)return await (0,h.sendResponse)(H,U,i,z.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,p.toNodeOutgoingHttpHeaders)(i.headers);u&&(t[y.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==z.renderOpts.collectedRevalidate&&!(z.renderOpts.collectedRevalidate>=y.INFINITE_CACHE)&&z.renderOpts.collectedRevalidate,o=void 0===z.renderOpts.collectedExpire||z.renderOpts.collectedExpire>=y.INFINITE_CACHE?void 0:z.renderOpts.collectedExpire;return{value:{kind:_.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:o}}}}catch(t){throw(null==r?void 0:r.isStale)&&await T.onRequestError(e,t,{routerKind:"App Router",routePath:g,routeType:"route",revalidateReason:(0,f.getRevalidateReason)({isStaticGeneration:W,isOnDemandRevalidate:j})},A),t}},c=await T.handleResponse({req:e,nextConfig:R,cacheKey:B,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:O,isRoutePPREnabled:!1,isOnDemandRevalidate:j,revalidateOnlyGenerated:q,responseGenerator:u,waitUntil:o.waitUntil,isMinimalMode:s});if(!x)return null;if((null==c||null==(i=c.value)?void 0:i.kind)!==_.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(l=c.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",j?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),E&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let d=(0,p.fromNodeOutgoingHttpHeaders)(c.value.headers);return s&&x||d.delete(y.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||d.get("Cache-Control")||d.set("Cache-Control",(0,b.getCacheControlHeader)(c.cacheControl)),await (0,h.sendResponse)(H,U,new Response(c.value.body,{headers:d,status:c.value.status||200})),null};N?await l(N):await D.withPropagatedContext(e.headers,()=>D.trace(d.BaseServerSpan.handleRequest,{spanName:`${$} ${g}`,kind:i.SpanKind.SERVER,attributes:{"http.method":$,"http.target":e.url}},l))}catch(t){if(t instanceof m.NoFallbackError||await T.onRequestError(e,t,{routerKind:"App Router",routePath:M,routeType:"route",revalidateReason:(0,f.getRevalidateReason)({isStaticGeneration:W,isOnDemandRevalidate:j})}),x)throw t;return await (0,h.sendResponse)(H,U,new Response(null,{status:500})),null}}e.s(["handler",()=>k,"patchFetch",()=>C,"routeModule",()=>T,"serverHooks",()=>q,"workAsyncStorage",()=>A,"workUnitAsyncStorage",()=>j],67756)}];

//# sourceMappingURL=52597_b06a4b4c._.js.map