{"version":3,"sources":["../../../../app/admin/upload-images/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { createClient } from '@supabase/supabase-js';\r\n\r\n// Initialize Supabase client lazily\r\nconst getSupabaseClient = () => {\r\n  const url = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\n  const key = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\r\n  \r\n  if (!url || !key) {\r\n    throw new Error('Supabase credentials not configured');\r\n  }\r\n  \r\n  return createClient(url, key);\r\n};\r\n\r\nexport default function UploadImagesPage() {\r\n  const [hotelId, setHotelId] = useState('scarlet-hotel');\r\n  const [roomType, setRoomType] = useState('');\r\n  const [selectedFiles, setSelectedFiles] = useState<File[]>([]);\r\n  const [uploading, setUploading] = useState(false);\r\n  const [uploadedUrls, setUploadedUrls] = useState<string[]>([]);\r\n  const [error, setError] = useState('');\r\n\r\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.files) {\r\n      setSelectedFiles(Array.from(e.target.files));\r\n    }\r\n  };\r\n\r\n  const handleUpload = async () => {\r\n    if (selectedFiles.length === 0) {\r\n      setError('אנא בחר קבצים להעלאה');\r\n      return;\r\n    }\r\n\r\n    setUploading(true);\r\n    setError('');\r\n    const urls: string[] = [];\r\n\r\n    try {\r\n      const supabase = getSupabaseClient();\r\n      \r\n      for (const file of selectedFiles) {\r\n        // Generate unique filename\r\n      const fileExt = file.name.split('.').pop();\r\n      const fileName = `${Date.now()}-${Math.random().toString(36).substring(7)}.${fileExt}`;\r\n      const filePath = `${hotelId}/${roomType || 'general'}/${fileName}`;\r\n\r\n      // Upload directly to Supabase Storage\r\n      const { data, error } = await supabase.storage\r\n        .from('hotel-assets')\r\n        .upload(filePath, file, {\r\n          cacheControl: '3600',\r\n          upsert: false\r\n        });\r\n\r\n      if (error) {\r\n        throw new Error(error.message || 'שגיאה בהעלאת קובץ');\r\n      }\r\n\r\n      // Get public URL\r\n      const { data: { publicUrl } } = supabase.storage\r\n        .from('hotel-assets')\r\n        .getPublicUrl(filePath);\r\n\r\n      urls.push(publicUrl);\r\n      }\r\n\r\n      setUploadedUrls(urls);\r\n      setSelectedFiles([]);\r\n    } catch (err: any) {\r\n      setError(err.message || 'שגיאה בהעלאת התמונות');\r\n    } finally {\r\n      setUploading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"container mx-auto py-10\">\r\n      <Card className=\"max-w-2xl mx-auto\">\r\n        <CardHeader>\r\n          <CardTitle>העלאת תמונות חדרים</CardTitle>\r\n          <CardDescription>\r\n            העלה תמונות של חדרים למלון שיישמרו ב-Supabase Storage\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"hotelId\">מזהה מלון</Label>\r\n            <Input\r\n              id=\"hotelId\"\r\n              value={hotelId}\r\n              onChange={(e) => setHotelId(e.target.value)}\r\n              placeholder=\"scarlet-hotel\"\r\n            />\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"roomType\">סוג חדר</Label>\r\n            <Input\r\n              id=\"roomType\"\r\n              value={roomType}\r\n              onChange={(e) => setRoomType(e.target.value)}\r\n              placeholder=\"deluxe-suite, standard-room, etc.\"\r\n            />\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"files\">תמונות</Label>\r\n            <Input\r\n              id=\"files\"\r\n              type=\"file\"\r\n              multiple\r\n              accept=\"image/*\"\r\n              onChange={handleFileChange}\r\n            />\r\n            {selectedFiles.length > 0 && (\r\n              <p className=\"text-sm text-gray-600\">\r\n                נבחרו {selectedFiles.length} קבצים\r\n              </p>\r\n            )}\r\n          </div>\r\n\r\n          {error && (\r\n            <div className=\"p-3 bg-red-50 border border-red-200 rounded text-red-700\">\r\n              {error}\r\n            </div>\r\n          )}\r\n\r\n          <Button\r\n            onClick={handleUpload}\r\n            disabled={uploading || selectedFiles.length === 0}\r\n            className=\"w-full\"\r\n          >\r\n            {uploading ? 'מעלה...' : 'העלה תמונות'}\r\n          </Button>\r\n\r\n          {uploadedUrls.length > 0 && (\r\n            <div className=\"space-y-2\">\r\n              <h3 className=\"font-semibold\">תמונות שהועלו בהצלחה:</h3>\r\n              <div className=\"space-y-2\">\r\n                {uploadedUrls.map((url, index) => (\r\n                  <div key={index} className=\"flex items-center gap-2\">\r\n                    <img\r\n                      src={url}\r\n                      alt={`Uploaded ${index + 1}`}\r\n                      className=\"w-20 h-20 object-cover rounded\"\r\n                    />\r\n                    <a\r\n                      href={url}\r\n                      target=\"_blank\"\r\n                      rel=\"noopener noreferrer\"\r\n                      className=\"text-sm text-blue-600 hover:underline break-all\"\r\n                    >\r\n                      {url}\r\n                    </a>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"0DAEA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAce,SAAS,IACtB,GAAM,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,iBACjC,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACnC,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,EAAE,EACvD,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACrC,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAW,EAAE,EACvD,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAQ7B,EAAe,UACnB,GAA6B,IAAzB,EAAc,MAAM,CAAQ,YAC9B,EAAS,wBAIX,GAAa,GACb,EAAS,IACT,IAAM,EAAiB,EAAE,CAEzB,GAAI,CACF,IAAM,EAAW,CApCG,KACxB,IAAM,EAAM,QAAQ,GAAG,CAAC,wBAAwB,CAC1C,EAAM,QAAQ,GAAG,CAAC,6BAA6B,CAErD,GAAI,CAAC,GAAO,CAAC,EACX,GADgB,GACV,AAAI,MAAM,uCAGlB,MAAO,CAAA,EAAA,EAAA,YAAA,AAAY,EAAC,EAAK,EAC3B,KA6BM,IAAK,IAAM,KAAQ,EAAe,CAElC,IAAM,EAAU,EAAK,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,GAClC,EAAW,CAAA,EAAG,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,SAAS,CAAC,GAAG,CAAC,EAAE,EAAA,CAAS,CAChF,EAAW,CAAA,EAAG,EAAQ,CAAC,EAAE,GAAY,UAAU,CAAC,EAAE,EAAA,CAAU,CAG5D,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,MAAM,EAAS,OAAO,CAC3C,IAAI,CAAC,gBACL,MAAM,CAAC,EAAU,EAAM,CACtB,aAAc,OACd,OAAQ,EACV,GAEF,GAAI,EACF,KADS,CACH,AAAI,MAAM,EAAM,OAAO,EAAI,qBAInC,GAAM,CAAE,KAAM,WAAE,CAAS,CAAE,CAAE,CAAG,EAAS,OAAO,CAC7C,IAAI,CAAC,gBACL,YAAY,CAAC,GAEhB,EAAK,IAAI,CAAC,EACV,CAEA,EAAgB,GAChB,EAAiB,EAAE,CACrB,CAAE,MAAO,EAAU,CACjB,EAAS,EAAI,OAAO,EAAI,uBAC1B,QAAU,CACR,GAAa,EACf,CACF,EAEA,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,8BACd,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,WACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,uBACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UAAC,6DAInB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,sBACrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,mBAAU,cACzB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,UACH,MAAO,EACP,SAAU,AAAC,GAAM,EAAW,EAAE,MAAM,CAAC,KAAK,EAC1C,YAAY,qBAIhB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,oBAAW,YAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,WACH,MAAO,EACP,SAAU,AAAC,GAAM,EAAY,EAAE,MAAM,CAAC,KAAK,EAC3C,YAAY,yCAIhB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,iBAAQ,WACvB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,QACH,KAAK,OACL,QAAQ,CAAA,CAAA,EACR,OAAO,UACP,SA3Fa,AAAC,CA2FJ,GA1FhB,EAAE,MAAM,CAAC,KAAK,EAAE,AAClB,EAAiB,MAAM,IAAI,CAAC,EAAE,MAAM,CAAC,KAAK,EAE9C,IAyFW,EAAc,MAAM,CAAG,GACtB,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,kCAAwB,SAC5B,EAAc,MAAM,CAAC,eAKjC,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oEACZ,IAIL,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAS,EACT,SAAU,GAAsC,IAAzB,EAAc,MAAM,CAC3C,UAAU,kBAET,EAAY,UAAY,gBAG1B,EAAa,MAAM,CAAG,GACrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,yBAAgB,0BAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACZ,EAAa,GAAG,CAAC,CAAC,EAAK,IACtB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAgB,UAAU,oCACzB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,IAAK,EACL,IAAK,CAAC,SAAS,EAAE,EAAQ,EAAA,CAAG,CAC5B,UAAU,mCAEZ,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CACC,KAAM,EACN,OAAO,SACP,IAAI,sBACJ,UAAU,2DAET,MAZK,gBAuB5B"}