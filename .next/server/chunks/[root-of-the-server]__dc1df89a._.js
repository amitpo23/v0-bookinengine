module.exports=[18622,(e,r,o)=>{r.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,r,o)=>{r.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,r,o)=>{r.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,r,o)=>{r.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},93695,(e,r,o)=>{r.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},44098,(e,r,o)=>{"use strict";r.exports=e.r(18622)},23223,(e,r,o)=>{"use strict";r.exports=e.r(44098).vendored["react-rsc"].React},24361,(e,r,o)=>{r.exports=e.x("util",()=>require("util"))},14747,(e,r,o)=>{r.exports=e.x("path",()=>require("path"))},21517,(e,r,o)=>{r.exports=e.x("http",()=>require("http"))},24836,(e,r,o)=>{r.exports=e.x("https",()=>require("https"))},92509,(e,r,o)=>{r.exports=e.x("url",()=>require("url"))},6461,(e,r,o)=>{r.exports=e.x("zlib",()=>require("zlib"))},81111,(e,r,o)=>{r.exports=e.x("node:stream",()=>require("node:stream"))},88947,(e,r,o)=>{r.exports=e.x("stream",()=>require("stream"))},22734,(e,r,o)=>{r.exports=e.x("fs",()=>require("fs"))},37702,(e,r,o)=>{r.exports=e.x("worker_threads",()=>require("worker_threads"))},79556,(e,r,o)=>{if(!globalThis.DOMException)try{let{MessageChannel:r}=e.r(37702),o=new r().port1,t=new ArrayBuffer;o.postMessage(t,[t,t])}catch(e){"DOMException"===e.constructor.name&&(globalThis.DOMException=e.constructor)}r.exports=globalThis.DOMException},36794,e=>{"use strict";process.env.ACS_CONNECTION_STRING;let r=process.env.ACS_PHONE_NUMBER||"";async function o(e,o){console.log(`[VoiceHandler] Initiating call to ${e.phoneNumber}`);try{if(!/^\+[1-9]\d{1,14}$/.test(e.phoneNumber))throw Error("Invalid phone number format. Use E.164 format (e.g., +972501234567)");let t=`call-${Date.now()}-${Math.random().toString(36).substr(2,8)}`;return o&&(o.metadata={...o.metadata,activeCall:{callId:t,phoneNumber:e.phoneNumber,purpose:e.purpose,language:e.language||"he-IL",startedAt:new Date}}),{success:!0,callId:t,status:"initiated",fromNumber:r||"+972-XX-XXXXXXX",toNumber:e.phoneNumber,startedAt:new Date}}catch(e){throw console.error("[VoiceHandler] Call initiation error:",e),Error(`Failed to initiate call: ${e.message}`)}}async function t(e,r){console.log("[VoiceHandler] Transferring to human agent:",e);try{let o,t=e.agentQueue||((o=e.reason.toLowerCase()).includes("billing")||o.includes("payment")||o.includes("refund")?"billing-support":o.includes("cancel")||o.includes("modify")||o.includes("change")?"booking-modifications":o.includes("complaint")||o.includes("problem")||o.includes("issue")?"customer-care":o.includes("group")||o.includes("corporate")||o.includes("business")?"corporate-sales":"general-support"),a=Math.floor(5*Math.random())+1,n=`xfer-${Date.now()}-${Math.random().toString(36).substr(2,6)}`;return r&&(r.metadata={...r.metadata,transferredToHuman:{transferId:n,reason:e.reason,queue:t,transferredAt:new Date}}),{success:!0,transferId:n,targetQueue:t,estimatedWaitTime:a,message:`Transferring you to our ${t} team. Estimated wait time: ${a} minutes.`}}catch(e){throw console.error("[VoiceHandler] Transfer error:",e),Error(`Transfer failed: ${e.message}`)}}async function a(e,r){console.log(`[VoiceHandler] Sending call summary SMS to ${e.phoneNumber}`);try{if(!/^\+[1-9]\d{1,14}$/.test(e.phoneNumber))throw Error("Invalid phone number format");e.summary.length>480?e.summary.substring(0,477):e.summary;let r=`sms-${Date.now()}-${Math.random().toString(36).substr(2,8)}`;return{success:!0,messageId:r,to:e.phoneNumber,status:"sent",sentAt:new Date}}catch(e){throw console.error("[VoiceHandler] SMS error:",e),Error(`Failed to send SMS: ${e.message}`)}}async function n(e,r){console.log("[VoiceHandler] Converting text to speech:",e.text.substring(0,50));try{e.voice,e.speed;let r=.4*e.text.split(" ").length;return{success:!0,audioUrl:`/api/tts/audio-${Date.now()}.mp3`,duration:r,format:"audio/mpeg"}}catch(e){throw console.error("[VoiceHandler] TTS error:",e),Error(`Text-to-speech failed: ${e.message}`)}}async function i(e,r){console.log("[VoiceHandler] Converting speech to text");try{let r=e.language||"he-IL";return{success:!0,text:"אני רוצה להזמין חדר במלון בדובאי לשלושה לילות",confidence:.95,language:r,duration:3.2,alternatives:[{text:"אני רוצה להזמין חדר במלון בדובאי לשלושה לילות",confidence:.95},{text:"אני רוצה להזמין חדר במלון ב-דובאי ל-3 לילות",confidence:.88}]}}catch(e){throw console.error("[VoiceHandler] STT error:",e),Error(`Speech-to-text failed: ${e.message}`)}}async function s(e,r){return{isSpeaking:Math.random()>(e.sensitivity||.5),confidence:.85+.15*Math.random()}}function c(e,r){let o=!1;return{async start(){console.log(`[VoiceHandler] Starting realtime audio stream for call ${e.callId}`),o=!0},async stop(){console.log("[VoiceHandler] Stopping realtime audio stream"),o=!1,r.onCallEnded("stream_stopped")},sendAudio(e){if(!o)return},async sendResponse(r){o&&(await n({text:r,voice:e.ttsVoice},{}),console.log(`[VoiceHandler] Playing TTS response: ${r.substring(0,50)}...`))}}}process.env.AZURE_SPEECH_KEY,process.env.AZURE_SPEECH_REGION,e.s(["createRealtimeAudioStream",()=>c,"detectVoiceActivity",()=>s,"initiateCall",()=>o,"sendCallSummarySms",()=>a,"speechToText",()=>i,"textToSpeech",()=>n,"transferToHuman",()=>t,"voiceHandlers",0,{initiateCall:o,transferToHuman:t,sendCallSummarySms:a,textToSpeech:n,speechToText:i,detectVoiceActivity:s,createRealtimeAudioStream:c}])},105,e=>{"use strict";async function r(e,r){console.log("[MonitoringHandler] Starting price tracking for:",e.hotelUrl);try{if(!e.hotelUrl.includes("booking.com"))throw Error("Currently only Booking.com URLs are supported");let t=o(e.hotelUrl),a=`track-${Date.now()}-${Math.random().toString(36).substr(2,8)}`,n=Math.floor(300*Math.random())+100,i={success:!0,trackingId:a,hotelName:t,currentPrice:n,currency:"USD",targetPrice:e.targetPrice,checkInterval:"Every 6 hours",notificationSettings:{email:e.notifyEmail,priceDropThreshold:10*!e.targetPrice},nextCheck:new Date(Date.now()+216e5)};return r&&(r.metadata={...r.metadata,priceTracking:[...r.metadata?.priceTracking||[],{trackingId:a,hotelUrl:e.hotelUrl,hotelName:t,startedAt:new Date}]}),i}catch(e){throw console.error("[MonitoringHandler] Track price error:",e),Error(`Failed to start price tracking: ${e.message}`)}}function o(e){try{let r=e.match(/hotel\/([^/]+)/);if(r)return r[1].replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase())}catch{}return"Unknown Hotel"}async function t(e,r){console.log("[MonitoringHandler] Getting price history for hotel:",e.hotelId);try{let r=new Date(e.dateFrom),o=new Date(e.dateTo),t=Math.ceil((o.getTime()-r.getTime())/864e5),a=[];for(let e=0;e<=t;e++){let o=new Date(r);o.setDate(o.getDate()+e);let t=(Math.random()-.5)*40,n=5===o.getDay()||6===o.getDay()?1.2:1,i=Math.round((250+t)*n);a.push({date:o.toISOString().split("T")[0],price:i,currency:"USD",availability:i<300?"available":i<350?"limited":"sold_out",source:"booking.com"})}let n=a.map(e=>e.price),i=Math.min(...n),s=Math.max(...n),c=Math.round(n.reduce((e,r)=>e+r,0)/n.length),l=n[n.length-1],u=n[0];return{hotelId:e.hotelId,hotelName:"Sample Hotel Dubai",dateRange:{from:e.dateFrom,to:e.dateTo},history:a,statistics:{minPrice:i,maxPrice:s,avgPrice:c,currentPrice:l,priceChange:l-u,priceChangePercent:Math.round((l-u)/u*100)}}}catch(e){throw console.error("[MonitoringHandler] Price history error:",e),Error(`Failed to get price history: ${e.message}`)}}async function a(e,r){console.log("[MonitoringHandler] Analyzing price trends for:",e.hotelId);try{let r=new Date(e.travelDates.from);r.getTime(),Date.now();let o=["rising","falling","stable"][Math.floor(3*Math.random())],t=Math.floor(60*Math.random())+20,a=[],n=[];"falling"===o?(a.push("Prices have dropped 12% over the past 2 weeks"),a.push("Historically, prices for these dates bottom out 3 weeks before check-in"),n.push("Wait 1-2 more weeks before booking to catch the lowest price")):"rising"===o?(a.push("Prices have increased 8% in the last week"),a.push("There's an event in the area driving up demand"),n.push("Book soon to lock in current prices"),n.push("Consider flexible dates 1 week earlier for better rates")):(a.push("Prices have remained stable for the past month"),a.push("Current price is close to the 90-day average"),n.push("This is a good time to book - prices are fair"));let i=r.getDay();(5===i||6===i)&&(a.push("Weekend check-in typically costs 15-20% more"),n.push("Consider Thursday or Sunday check-in for savings"));let s=r.getMonth();return(s>=10||s<=2)&&a.push("This is high season in Dubai - expect premium pricing"),{hotelId:e.hotelId,hotelName:"Sample Hotel Dubai",travelDates:e.travelDates,currentTrend:o,trendStrength:t,prediction:{direction:"rising"===o?"up":"falling"===o?"down":"stable",confidence:t+20,expectedChange:"rising"===o?8:"falling"===o?-10:0,optimalBookingWindow:{from:new Date(Date.now()+6048e5).toISOString().split("T")[0],to:new Date(Date.now()+12096e5).toISOString().split("T")[0]}},insights:a,recommendations:n,competitorComparison:[{hotelName:"Similar Hotel A",priceDifference:-25,rating:8.7},{hotelName:"Similar Hotel B",priceDifference:40,rating:9.1},{hotelName:"Similar Hotel C",priceDifference:-10,rating:8.5}]}}catch(e){throw console.error("[MonitoringHandler] Trend analysis error:",e),Error(`Failed to analyze price trends: ${e.message}`)}}async function n(e,r,t,a){return console.log(`[MonitoringHandler] Scraping prices from: ${e}`),[{hotelName:o(e),roomType:"Deluxe Room",price:289,currency:"USD",originalPrice:340,discount:15,cancellationPolicy:"Free cancellation",boardType:"Breakfast included",scrapedAt:new Date},{hotelName:o(e),roomType:"Suite",price:489,currency:"USD",cancellationPolicy:"Non-refundable",boardType:"Room only",scrapedAt:new Date}]}e.s(["analyzePriceTrends",()=>a,"getPriceHistory",()=>t,"monitoringHandlers",0,{trackHotelPrice:r,getPriceHistory:t,analyzePriceTrends:a,scrapeBookingComPrices:n},"scrapeBookingComPrices",()=>n,"trackHotelPrice",()=>r])},8559,e=>{"use strict";async function r(e,r){console.log("[BookingHandler] Searching hotels:",e);try{e.destination,e.checkIn,e.checkOut,e.adults,e.children?.map(e=>({age:e})),e.stars,e.maxPrice,e.amenities;let o=[{hotelId:"htl-dubai-001",name:"Burj Al Arab Jumeirah",stars:5,address:"Jumeirah Beach Road, Dubai, UAE",imageUrl:"/hotels/burj-al-arab.jpg",rating:9.4,reviewCount:12543,amenities:["Spa","Pool","WiFi","Beach Access","Restaurant","Butler Service"],rooms:[{roomCode:"room-001",roomName:"Deluxe Suite",boardType:"Breakfast Included",price:2500,originalPrice:2800,currency:"USD",cancellationPolicy:"Free cancellation until 24h before",maxOccupancy:2,available:3},{roomCode:"room-002",roomName:"Panoramic Suite",boardType:"Half Board",price:3800,currency:"USD",cancellationPolicy:"Non-refundable",maxOccupancy:3,available:1}]},{hotelId:"htl-dubai-002",name:"Atlantis The Palm",stars:5,address:"Crescent Road, The Palm, Dubai, UAE",imageUrl:"/hotels/atlantis.jpg",rating:8.9,reviewCount:28912,amenities:["Waterpark","Pool","WiFi","Beach","Aquarium","Kids Club"],rooms:[{roomCode:"room-003",roomName:"Palm Beach Room",boardType:"Room Only",price:450,originalPrice:520,currency:"USD",cancellationPolicy:"Free cancellation until 48h before",maxOccupancy:2,available:8}]},{hotelId:"htl-dubai-003",name:"Four Seasons Resort Dubai",stars:5,address:"Jumeirah Beach, Dubai, UAE",imageUrl:"/hotels/four-seasons.jpg",rating:9.2,reviewCount:8234,amenities:["Spa","Pool","WiFi","Beach","Golf","Tennis"],rooms:[{roomCode:"room-004",roomName:"Premier Room",boardType:"Breakfast Included",price:680,currency:"USD",cancellationPolicy:"Free cancellation until 72h before",maxOccupancy:2,available:5}]}];return r&&(r.bookingData={...r.bookingData,lastSearch:{params:e,timestamp:new Date,results:o.map(e=>({hotelId:e.hotelId,name:e.name}))}}),{hotels:o,searchId:`search-${Date.now()}`,totalResults:o.length}}catch(e){throw console.error("[BookingHandler] Search error:",e),Error(`Hotel search failed: ${e.message}`)}}async function o(e,r){console.log("[BookingHandler] Pre-booking room:",e);try{let o=new Date(e.checkIn),t=new Date(e.checkOut),a=Math.ceil((t.getTime()-o.getTime())/864e5),n={success:!0,token:`prebook-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,expiresAt:new Date(Date.now()+18e5),pricing:{roomRate:680*a,taxes:68*a,fees:25,total:748*a+25,currency:"USD"},cancellationPolicy:{freeCancellationUntil:new Date(o.getTime()-2592e5),penalties:[{from:new Date(o.getTime()-2592e5),amount:680},{from:new Date(o.getTime()-864e5),amount:680*a}]},hotelDetails:{hotelId:e.hotelId,name:"Four Seasons Resort Dubai",roomName:"Premier Room",checkIn:e.checkIn,checkOut:e.checkOut,nights:a}};return r&&(r.bookingData={...r.bookingData,prebook:{token:n.token,expiresAt:n.expiresAt,hotelId:e.hotelId,roomCode:e.roomCode,pricing:n.pricing}}),n}catch(e){throw console.error("[BookingHandler] Prebook error:",e),Error(`Pre-booking failed: ${e.message}`)}}async function t(e,r){console.log("[BookingHandler] Completing booking:",e);try{if(!r?.bookingData?.prebook?.token||r.bookingData.prebook.token!==e.token)throw Error("Invalid or expired prebook token");if(new Date>new Date(r.bookingData.prebook.expiresAt))throw Error("Prebook token has expired. Please search again.");let o=`BK-${Date.now()}-${Math.random().toString(36).substr(2,6).toUpperCase()}`,t=`CNF-${Math.random().toString(36).substr(2,8).toUpperCase()}`,a={success:!0,bookingId:o,confirmationNumber:t,status:"confirmed",hotelConfirmation:`HC-${Math.random().toString(36).substr(2,6).toUpperCase()}`,totalPaid:r.bookingData.prebook.pricing.total,currency:r.bookingData.prebook.pricing.currency,bookingDetails:{hotelName:"Four Seasons Resort Dubai",roomName:"Premier Room",checkIn:r.bookingData.prebook.checkIn||"2024-03-15",checkOut:r.bookingData.prebook.checkOut||"2024-03-18",guests:e.guests.map(e=>`${e.firstName} ${e.lastName}`),specialRequests:e.specialRequests},paymentDetails:{method:e.paymentMethod||"card",last4:"4242",transactionId:`txn-${Date.now()}`},cancellationPolicy:"Free cancellation until 72 hours before check-in"};return r&&(r.bookingData={...r.bookingData,confirmedBooking:{bookingId:o,confirmationNumber:t,status:"confirmed",bookedAt:new Date}}),a}catch(e){throw console.error("[BookingHandler] Booking error:",e),Error(`Booking failed: ${e.message}`)}}async function a(e,r){console.log("[BookingHandler] Cancelling booking:",e);try{let e=Math.random()>.3,r=680*!e;return{success:!0,cancellationId:`CAN-${Date.now()}-${Math.random().toString(36).substr(2,6).toUpperCase()}`,refundAmount:2244-r,refundCurrency:"USD",penaltyApplied:r,refundMethod:"Original payment method",refundEta:"5-7 business days",message:e?"Your booking has been cancelled with a full refund.":`Your booking has been cancelled. A cancellation fee of $${r} was applied.`}}catch(e){throw console.error("[BookingHandler] Cancellation error:",e),Error(`Cancellation failed: ${e.message}`)}}async function n(e,r){console.log("[BookingHandler] Getting cancellation policy:",e);let o=new Date("2024-03-15"),t=new Date(o.getTime()-2592e5),a=new Date<t;return{bookingId:e.bookingId,hotelName:"Four Seasons Resort Dubai",checkIn:"2024-03-15",currentStatus:"confirmed",policy:{freeCancellationUntil:t.toISOString(),isWithinFreePeriod:a,penalties:[{fromDate:t.toISOString(),amount:680,currency:"USD",description:"First night penalty (72-24 hours before check-in)"},{fromDate:new Date(o.getTime()-864e5).toISOString(),amount:2244,currency:"USD",description:"Full booking amount (less than 24 hours)"}]},recommendation:a?"You can cancel now for a full refund!":"Cancellation will incur a penalty. Consider rescheduling instead."}}process.env.MEDICI_API_URL,process.env.MEDICI_API_KEY,e.s(["bookRoom",()=>t,"bookingHandlers",0,{searchHotels:r,prebookRoom:o,bookRoom:t,cancelBooking:a,getCancellationPolicy:n},"cancelBooking",()=>a,"getCancellationPolicy",()=>n,"prebookRoom",()=>o,"searchHotels",()=>r])},24498,e=>{e.v(e=>Promise.resolve().then(()=>e(8559)))},78761,e=>{e.v(e=>Promise.resolve().then(()=>e(36794)))},50524,e=>{e.v(e=>Promise.resolve().then(()=>e(105)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__dc1df89a._.js.map