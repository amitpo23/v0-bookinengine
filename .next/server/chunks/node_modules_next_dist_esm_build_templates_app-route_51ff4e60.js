module.exports=[16526,e=>{"use strict";var t=e.i(47909),r=e.i(74017),a=e.i(96250),o=e.i(59756),i=e.i(61916),s=e.i(14444),n=e.i(37092),l=e.i(69741),c=e.i(16795),d=e.i(87718),u=e.i(95169),p=e.i(47587),m=e.i(66012),h=e.i(70101),g=e.i(26937),y=e.i(10372),f=e.i(93695);e.i(52474);var v=e.i(5232),b=e.i(89171),R=e.i(69492);async function w(e,t,r){let a={},o=!r?.description||r.description.length<50,i=!r?.images||0===r.images.length,s=!r?.facilities||0===r.facilities.length;if(!o&&!i&&!s)return a;try{var n,l,c;let d,u,p=await I(e,t);if(p&&(o&&p.description&&(a.description=p.description),i&&p.images&&(a.images=p.images),s&&p.facilities&&(a.facilities=p.facilities),a.rating=p.rating,a.reviews=p.reviews),o&&!a.description){let r=await x(e,t);r?.description&&(a.description=r.description)}return o&&!a.description&&r?.facilities&&r.facilities.length>0&&(n=e,l=r.facilities,d=(c=t)?` in ${c}`:"",u=l.slice(0,5).join(", "),a.description=`${n}${d} offers modern accommodations with excellent facilities including ${u}. The hotel provides comfortable rooms and quality services for both leisure and business travelers.`),a}catch(e){return console.error("Hotel enrichment error:",e),a}}async function I(e,t){let r=process.env.GOOGLE_PLACES_API_KEY;if(!r)return null;try{let a=t?`${e} ${t}`:e,o=`https://maps.googleapis.com/maps/api/place/findplacefromtext/json?input=${encodeURIComponent(a)}&inputtype=textquery&fields=place_id&key=${r}`,i=await fetch(o),s=await i.json();if(!s.candidates||0===s.candidates.length)return null;let n=s.candidates[0].place_id,l=`https://maps.googleapis.com/maps/api/place/details/json?place_id=${n}&fields=name,formatted_address,formatted_phone_number,website,rating,user_ratings_total,photos,editorial_summary,types,business_status&key=${r}`,c=await fetch(l),d=await c.json();if(!d.result)return null;let u=d.result,p=[];if(u.photos)for(let e of u.photos.slice(0,10)){let t=`https://maps.googleapis.com/maps/api/place/photo?maxwidth=1200&photo_reference=${e.photo_reference}&key=${r}`;p.push(t)}return{description:u.editorial_summary?.overview||u.name,images:p,rating:u.rating,address:u.formatted_address,phone:u.formatted_phone_number,website:u.website,reviews:[{rating:u.rating||0,count:u.user_ratings_total||0,source:"Google"}]}}catch(e){return console.error("Google Places API error:",e),null}}async function x(e,t){let r=process.env.BING_SEARCH_API_KEY;if(!r)return null;try{let a=t?`${e} hotel ${t}`:`${e} hotel`,o=`https://api.bing.microsoft.com/v7.0/search?q=${encodeURIComponent(a)}&count=3`,i=await fetch(o,{headers:{"Ocp-Apim-Subscription-Key":r}}),s=await i.json();if(s.webPages?.value&&s.webPages.value.length>0)return{description:s.webPages.value[0].snippet||""};return null}catch(e){return console.error("Bing Search API error:",e),null}}e.i(23502);var E=e.i(82109);let C=[{hotelId:1001,hotelName:"Royal Beach Tel Aviv",hotelImage:"/luxury-beach-hotel-tel-aviv.jpg",images:["/luxury-hotel-lobby.png","/hotel-pool-sunset.jpg","/hotel-spa-relaxation.png"],location:"Herbert Samuel Promenade",city:"Tel Aviv",stars:5,address:"19 Herbert Samuel St, Tel Aviv",description:" 拽 拽专转 注 祝  转  转 . 专 注爪, 住驻 驻拽 住注 专.",facilities:["WiFi ","专","住驻","住注","","专 砖专"],rooms:[{code:"ROYAL_DELUXE_001",roomId:"101",roomName:"专 拽住 注 祝 ",roomCategory:"Deluxe",categoryId:3,roomImage:"/deluxe-hotel-room-sea-view.jpg",images:[],bedding:" 转 King",board:"专 ",boardId:1,boardType:"RO",maxOccupancy:2,size:35,view:"祝 ",amenities:["",""," 专","专驻住转"],price:1200,buyPrice:1200,originalPrice:1500,currency:"ILS",cancellationPolicy:"  注 24 砖注转 驻 注",available:3},{code:"ROYAL_SUITE_002",roomId:"102",roomName:"住 专 注 '拽",roomCategory:"Suite",categoryId:4,roomImage:"/luxury-hotel-suite-jacuzzi.jpg",images:[],bedding:" 转 King + 住驻",board:" 专转 拽专",boardId:2,boardType:"BB",maxOccupancy:4,size:60,view:"祝 驻专 ",amenities:["",""," 专","专驻住转","'拽","住"],price:2400,buyPrice:2400,originalPrice:3e3,currency:"ILS",cancellationPolicy:"  注 48 砖注转 驻 注",available:2}],requestJson:'{"demo":"true"}',responseJson:{}},{hotelId:1002,hotelName:"David Tower Jerusalem",hotelImage:"/luxury-hotel-jerusalem.jpg",images:["/jerusalem-hotel-night.jpg","/luxury-hotel-restaurant.png"],location:"King David Street",city:"Jerusalem",stars:5,address:"23 King David St, Jerusalem",description:" 拽  专砖 注 祝 专 转. 砖 砖 砖 住专转 拽专 专转.",facilities:["WiFi ","专 拽专","住驻","3 住注转","","专 砖专",""],rooms:[{code:"DAVID_CLASSIC_001",roomId:"201",roomName:"专 拽住",roomCategory:"Standard",categoryId:1,roomImage:"/classic-hotel-room.jpg",images:[],bedding:"2 转 ",board:"专 ",boardId:1,boardType:"RO",maxOccupancy:2,size:28,view:"祝 注专",amenities:["",""," 专","住驻转"],price:950,buyPrice:950,originalPrice:1200,currency:"ILS",cancellationPolicy:"  注 24 砖注转 驻 注",available:5}]},{hotelId:1003,hotelName:"Carmel Forest Spa Resort",hotelImage:"/spa-resort-forest.jpg",images:[],location:"Carmel Mountains",city:"Haifa",stars:5,address:"Carmel Forest, Haifa",description:"转专 驻砖 拽专转 注专 专. 砖 专 专转  驻砖 砖驻转转 专注转.",facilities:["WiFi ","住驻 ","专转 转","住注 专转",""," 注"],rooms:[{code:"CARMEL_FOREST_001",roomId:"301",roomName:"拽转 注专",roomCategory:"Superior",categoryId:2,roomImage:"/forest-cabin-room.jpg",images:[],bedding:" 转 Queen",board:"爪 驻住",boardId:3,boardType:"HB",maxOccupancy:2,size:40,view:"祝 注专",amenities:["","拽","专驻住转 驻专转"," "],price:1800,buyPrice:1800,originalPrice:2200,currency:"ILS",cancellationPolicy:"  注 72 砖注转 驻 注",available:4}]}];async function P(e){try{let t=await e.json(),{hotelName:r,city:a,adults:o,children:i,stars:s,limit:n}=t,l=t.dateFrom||t.checkIn,c=t.dateTo||t.checkOut,d=t.city||t.destination;if(t.pax||(t.adults,t.children,t.rooms),!l||!c)return b.NextResponse.json({error:"dateFrom and dateTo are required"},{status:400});if(!r&&!d)return b.NextResponse.json({error:"Either hotelName or city is required"},{status:400});if(E.DEMO_MODE){console.log(" DEMO MODE: Using mock hotel data"),await new Promise(e=>setTimeout(e,800));let e=C.map(e=>({hotelId:e.hotelId,hotelName:e.hotelName,city:e.city,stars:e.stars,address:e.address,imageUrl:e.hotelImage,images:e.images,description:e.description,facilities:e.facilities,rooms:e.rooms,requestJson:e.requestJson,responseJson:e.responseJson}));return b.NextResponse.json({success:!0,data:e,count:e.length})}let u=await R.mediciApi.searchHotels({dateFrom:l,dateTo:c,hotelName:r||void 0,city:a||void 0,adults:o||2,children:i||[],stars:s?Number(s):void 0,limit:n?Number(n):20}),p=await Promise.all(u.map(async e=>{let t=0;"number"==typeof e.hotelId&&e.hotelId>0?t=e.hotelId:"string"==typeof e.hotelId&&e.hotelId&&(t=Number.parseInt(e.hotelId,10)||0);let r=(e.rooms||[]).map((e,t)=>{var r,a;return{code:e.code||e.rateKey||e.roomCode||"",roomId:String(e.roomId||e.id||t+1),roomName:e.roomName||e.name||"Standard Room",roomCategory:e.roomCategory||e.roomType||e.category||"standard",categoryId:e.categoryId||(r=e.roomCategory||e.roomType,({standard:1,superior:2,deluxe:3,suite:4,"junior suite":5,family:6})[r?.toLowerCase()]||1),boardId:e.boardId||(a=e.board||e.boardType,({ro:1,bb:2,hb:3,fb:4,ai:5})[a?.toLowerCase()]||1),boardType:e.boardType||e.board||"RO",buyPrice:Number(e.buyPrice)||Number(e.price)||0,originalPrice:Number(e.originalPrice)||0,currency:e.currency||"ILS",maxOccupancy:e.maxOccupancy||e.pax?.adults||2,size:e.size||e.roomSize||0,view:e.view||"",bedding:e.bedding||"",amenities:e.amenities||e.facilities||[],images:e.images||[],cancellationPolicy:e.cancellationPolicy||"free",available:e.available||e.quantity?.max||1}}),a=e.description||"",o=e.images||[],i=e.facilities||e.amenities||[];if(!a||a.length<50||0===o.length||0===i.length)try{let t=await w(e.hotelName||e.name||"Unknown Hotel",e.city,{description:a,images:o,facilities:i,address:e.address});t.description&&!a&&(a=t.description),t.images&&0===o.length&&(o=t.images),t.facilities&&0===i.length&&(i=t.facilities)}catch(t){console.error("Enrichment failed for hotel:",e.hotelName,t)}return{hotelId:t,hotelName:e.hotelName||e.name||"Unknown Hotel",city:e.city||"",stars:e.stars||e.rating||0,address:e.address||e.location||"",imageUrl:e.hotelImage||e.imageUrl||o[0]||"",images:o,description:a,facilities:i,rooms:r,requestJson:e.requestJson,responseJson:e.responseJson}}));return b.NextResponse.json({success:!0,data:p,count:p.length})}catch(e){return console.error("Search API Error:",e.message),b.NextResponse.json({error:e.message||"Failed to search hotels"},{status:500})}}e.s(["POST",()=>P],95099);var _=e.i(95099);let N=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/hotels/search/route",pathname:"/api/hotels/search",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/hotels/search/route.ts",nextConfigOutput:"",userland:_}),{workAsyncStorage:S,workUnitAsyncStorage:A,serverHooks:T}=N;function O(){return(0,a.patchFetch)({workAsyncStorage:S,workUnitAsyncStorage:A})}async function j(e,t,a){N.isDev&&(0,o.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let b="/api/hotels/search/route";b=b.replace(/\/index$/,"")||"/";let R=await N.prepare(e,t,{srcPage:b,multiZoneDraftMode:!1});if(!R)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:w,params:I,nextConfig:x,parsedUrl:E,isDraftMode:C,prerenderManifest:P,routerServerContext:_,isOnDemandRevalidate:S,revalidateOnlyGenerated:A,resolvedPathname:T,clientReferenceManifest:O,serverActionsManifest:j}=R,H=(0,l.normalizeAppPath)(b),U=!!(P.dynamicRoutes[H]||P.routes[T]),q=async()=>((null==_?void 0:_.render404)?await _.render404(e,t,E,!1):t.end("This page could not be found"),null);if(U&&!C){let e=!!P.routes[T],t=P.dynamicRoutes[H];if(t&&!1===t.fallback&&!e){if(x.experimental.adapterPath)return await q();throw new f.NoFallbackError}}let $=null;!U||N.isDev||C||($="/index"===($=T)?"/":$);let D=!0===N.isDev||!U,M=U&&!D;j&&O&&(0,s.setReferenceManifestsSingleton)({page:b,clientReferenceManifest:O,serverActionsManifest:j,serverModuleMap:(0,n.createServerModuleMap)({serverActionsManifest:j})});let k=e.method||"GET",L=(0,i.getTracer)(),F=L.getActiveScopeSpan(),K={params:I,prerenderManifest:P,renderOpts:{experimental:{authInterrupts:!!x.experimental.authInterrupts},cacheComponents:!!x.cacheComponents,supportsDynamicResponse:D,incrementalCache:(0,o.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:x.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>N.onRequestError(e,t,a,_)},sharedContext:{buildId:w}},J=new c.NodeNextRequest(e),B=new c.NodeNextResponse(t),z=d.NextRequestAdapter.fromNodeNextRequest(J,(0,d.signalFromNodeResponse)(t));try{let s=async e=>N.handle(z,K).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=L.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${k} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${k} ${b}`)}),n=!!(0,o.getRequestMeta)(e,"minimalMode"),l=async o=>{var i,l;let c=async({previousCacheEntry:r})=>{try{if(!n&&S&&A&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await s(o);e.fetchMetrics=K.renderOpts.fetchMetrics;let l=K.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let c=K.renderOpts.collectedTags;if(!U)return await (0,m.sendResponse)(J,B,i,K.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(i.headers);c&&(t[y.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==K.renderOpts.collectedRevalidate&&!(K.renderOpts.collectedRevalidate>=y.INFINITE_CACHE)&&K.renderOpts.collectedRevalidate,a=void 0===K.renderOpts.collectedExpire||K.renderOpts.collectedExpire>=y.INFINITE_CACHE?void 0:K.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await N.onRequestError(e,t,{routerKind:"App Router",routePath:b,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:S})},_),t}},d=await N.handleResponse({req:e,nextConfig:x,cacheKey:$,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:P,isRoutePPREnabled:!1,isOnDemandRevalidate:S,revalidateOnlyGenerated:A,responseGenerator:c,waitUntil:a.waitUntil,isMinimalMode:n});if(!U)return null;if((null==d||null==(i=d.value)?void 0:i.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(l=d.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});n||t.setHeader("x-nextjs-cache",S?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),C&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let u=(0,h.fromNodeOutgoingHttpHeaders)(d.value.headers);return n&&U||u.delete(y.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||u.get("Cache-Control")||u.set("Cache-Control",(0,g.getCacheControlHeader)(d.cacheControl)),await (0,m.sendResponse)(J,B,new Response(d.value.body,{headers:u,status:d.value.status||200})),null};F?await l(F):await L.withPropagatedContext(e.headers,()=>L.trace(u.BaseServerSpan.handleRequest,{spanName:`${k} ${b}`,kind:i.SpanKind.SERVER,attributes:{"http.method":k,"http.target":e.url}},l))}catch(t){if(t instanceof f.NoFallbackError||await N.onRequestError(e,t,{routerKind:"App Router",routePath:H,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:S})}),U)throw t;return await (0,m.sendResponse)(J,B,new Response(null,{status:500})),null}}e.s(["handler",()=>j,"patchFetch",()=>O,"routeModule",()=>N,"serverHooks",()=>T,"workAsyncStorage",()=>S,"workUnitAsyncStorage",()=>A],16526)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_51ff4e60.js.map