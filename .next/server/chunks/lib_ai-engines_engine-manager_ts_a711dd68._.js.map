{"version":3,"sources":["../../../lib/ai-engines/skills.ts","../../../lib/ai-engines/templates.ts","../../../lib/ai-engines/engine-manager.ts"],"sourcesContent":["/**\r\n * AI Skills Library\r\n * Collection of skills for AI Booking Engines\r\n * Based on capabilities from: skills, openai-agents-python, ai-travel-agent-platform\r\n */\r\n\r\nimport type { AISkill, AITool } from './types';\r\n\r\n// ========================================\r\n// BOOKING SKILLS\r\n// ========================================\r\n\r\nexport const hotelSearchSkill: AISkill = {\r\n  id: 'hotel-search',\r\n  name: 'Hotel Search',\r\n  nameHe: 'חיפוש מלונות',\r\n  description: 'Search for available hotels with real-time pricing and availability',\r\n  descriptionHe: 'חיפוש מלונות זמינים עם תמחור וזמינות בזמן אמת',\r\n  category: 'booking',\r\n  capabilities: ['search'],\r\n  isEnabled: true,\r\n  priority: 1,\r\n  requiredPermissions: ['booking:read'],\r\n  tools: [\r\n    {\r\n      name: 'search_hotels',\r\n      description: 'Search for available hotel rooms with pricing. Use when user asks about hotel availability, prices, or wants to find accommodation.',\r\n      parameters: [\r\n        { name: 'destination', type: 'string', description: 'City or destination name', required: true },\r\n        { name: 'checkIn', type: 'date', description: 'Check-in date (YYYY-MM-DD)', required: true },\r\n        { name: 'checkOut', type: 'date', description: 'Check-out date (YYYY-MM-DD)', required: true },\r\n        { name: 'adults', type: 'number', description: 'Number of adults', required: true, default: 2 },\r\n        { name: 'children', type: 'array', description: 'Array of children ages', required: false, default: [] },\r\n        { name: 'stars', type: 'array', description: 'Filter by star rating (1-5)', required: false },\r\n        { name: 'maxPrice', type: 'number', description: 'Maximum price per night', required: false },\r\n        { name: 'amenities', type: 'array', description: 'Required amenities', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/booking.searchHotels',\r\n      isAsync: true,\r\n      timeout: 30000,\r\n      retryConfig: { maxRetries: 3, delayMs: 1000, exponentialBackoff: true }\r\n    }\r\n  ]\r\n};\r\n\r\nexport const hotelPrebookSkill: AISkill = {\r\n  id: 'hotel-prebook',\r\n  name: 'Hotel Pre-booking',\r\n  nameHe: 'הזמנה מוקדמת',\r\n  description: 'Pre-book a room to confirm availability and lock the price',\r\n  descriptionHe: 'הזמנה מוקדמת לחדר לאישור זמינות ונעילת מחיר',\r\n  category: 'booking',\r\n  capabilities: ['prebook'],\r\n  isEnabled: true,\r\n  priority: 2,\r\n  requiredPermissions: ['booking:write'],\r\n  tools: [\r\n    {\r\n      name: 'prebook_room',\r\n      description: 'Pre-book a room to confirm availability before final booking. Use after user selects a specific room.',\r\n      parameters: [\r\n        { name: 'roomCode', type: 'string', description: 'Room code from search results', required: true },\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID from search results', required: true },\r\n        { name: 'checkIn', type: 'date', description: 'Check-in date', required: true },\r\n        { name: 'checkOut', type: 'date', description: 'Check-out date', required: true },\r\n        { name: 'guests', type: 'object', description: 'Guest configuration { adults, children }', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/booking.prebookRoom',\r\n      isAsync: true,\r\n      timeout: 30000\r\n    }\r\n  ]\r\n};\r\n\r\nexport const hotelBookingSkill: AISkill = {\r\n  id: 'hotel-booking',\r\n  name: 'Hotel Booking',\r\n  nameHe: 'הזמנת מלון',\r\n  description: 'Complete hotel booking with customer details and payment',\r\n  descriptionHe: 'השלמת הזמנת מלון עם פרטי לקוח ותשלום',\r\n  category: 'booking',\r\n  capabilities: ['booking'],\r\n  isEnabled: true,\r\n  priority: 3,\r\n  requiredPermissions: ['booking:write', 'payment:process'],\r\n  tools: [\r\n    {\r\n      name: 'book_room',\r\n      description: 'Complete the booking with customer details. Use only after pre-booking and when you have all customer information.',\r\n      parameters: [\r\n        { name: 'token', type: 'string', description: 'Token from pre-book response', required: true },\r\n        { name: 'roomCode', type: 'string', description: 'Room code', required: true },\r\n        { name: 'customer', type: 'object', description: 'Customer details { firstName, lastName, email, phone, address }', required: true },\r\n        { name: 'guests', type: 'array', description: 'Guest list with names', required: true },\r\n        { name: 'specialRequests', type: 'string', description: 'Special requests', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/booking.bookRoom',\r\n      isAsync: true,\r\n      timeout: 60000\r\n    }\r\n  ]\r\n};\r\n\r\nexport const bookingCancellationSkill: AISkill = {\r\n  id: 'booking-cancellation',\r\n  name: 'Booking Cancellation',\r\n  nameHe: 'ביטול הזמנה',\r\n  description: 'Cancel existing bookings with policy information',\r\n  descriptionHe: 'ביטול הזמנות קיימות עם מידע על מדיניות הביטול',\r\n  category: 'booking',\r\n  capabilities: ['cancellation'],\r\n  isEnabled: true,\r\n  priority: 4,\r\n  requiredPermissions: ['booking:cancel'],\r\n  tools: [\r\n    {\r\n      name: 'cancel_booking',\r\n      description: 'Cancel an existing booking. Requires confirmation from customer.',\r\n      parameters: [\r\n        { name: 'bookingId', type: 'string', description: 'Booking confirmation number', required: true },\r\n        { name: 'reason', type: 'string', description: 'Cancellation reason', required: false },\r\n        { name: 'force', type: 'boolean', description: 'Force cancellation even with penalties', required: false, default: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/booking.cancelBooking',\r\n      isAsync: true,\r\n      timeout: 30000\r\n    },\r\n    {\r\n      name: 'get_cancellation_policy',\r\n      description: 'Get cancellation policy and potential penalties for a booking.',\r\n      parameters: [\r\n        { name: 'bookingId', type: 'string', description: 'Booking confirmation number', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/booking.getCancellationPolicy',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\n// ========================================\r\n// PRICE MONITORING SKILLS\r\n// ========================================\r\n\r\nexport const priceMonitoringSkill: AISkill = {\r\n  id: 'price-monitoring',\r\n  name: 'Price Monitoring',\r\n  nameHe: 'מעקב מחירים',\r\n  description: 'Monitor and track hotel prices over time, detect price drops',\r\n  descriptionHe: 'מעקב אחר מחירי מלונות לאורך זמן, זיהוי ירידות מחירים',\r\n  category: 'analysis',\r\n  capabilities: ['price-monitoring', 'analytics'],\r\n  isEnabled: true,\r\n  priority: 5,\r\n  requiredPermissions: ['monitoring:read', 'monitoring:write'],\r\n  tools: [\r\n    {\r\n      name: 'track_hotel_price',\r\n      description: 'Start tracking price for a specific hotel and date range.',\r\n      parameters: [\r\n        { name: 'hotelUrl', type: 'string', description: 'Hotel URL (Booking.com)', required: true },\r\n        { name: 'checkIn', type: 'date', description: 'Check-in date', required: true },\r\n        { name: 'checkOut', type: 'date', description: 'Check-out date', required: true },\r\n        { name: 'targetPrice', type: 'number', description: 'Alert when price drops below', required: false },\r\n        { name: 'notifyEmail', type: 'string', description: 'Email for price alerts', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/monitoring.trackHotelPrice',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_price_history',\r\n      description: 'Get historical price data for a hotel.',\r\n      parameters: [\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\r\n        { name: 'dateFrom', type: 'date', description: 'Start date for history', required: true },\r\n        { name: 'dateTo', type: 'date', description: 'End date for history', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/monitoring.getPriceHistory',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'analyze_price_trends',\r\n      description: 'Analyze price trends and predict best booking time.',\r\n      parameters: [\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\r\n        { name: 'travelDates', type: 'object', description: 'Travel date range { from, to }', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/monitoring.analyzePriceTrends',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\n// ========================================\r\n// COMMUNICATION SKILLS\r\n// ========================================\r\n\r\nexport const voiceInteractionSkill: AISkill = {\r\n  id: 'voice-interaction',\r\n  name: 'Voice Interaction',\r\n  nameHe: 'אינטראקציה קולית',\r\n  description: 'Handle voice calls with speech-to-text and text-to-speech',\r\n  descriptionHe: 'טיפול בשיחות קוליות עם המרת דיבור לטקסט וטקסט לדיבור',\r\n  category: 'communication',\r\n  capabilities: ['voice-interaction', 'real-time-streaming'],\r\n  isEnabled: true,\r\n  priority: 1,\r\n  requiredPermissions: ['voice:read', 'voice:write'],\r\n  tools: [\r\n    {\r\n      name: 'initiate_call',\r\n      description: 'Initiate an outbound phone call to customer.',\r\n      parameters: [\r\n        { name: 'phoneNumber', type: 'string', description: 'Phone number to call (E.164 format)', required: true },\r\n        { name: 'purpose', type: 'string', description: 'Call purpose/script', required: true },\r\n        { name: 'language', type: 'string', description: 'Call language', required: false, default: 'he-IL' }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/voice.initiateCall',\r\n      isAsync: true,\r\n      timeout: 120000\r\n    },\r\n    {\r\n      name: 'transfer_to_human',\r\n      description: 'Transfer the call to a human agent.',\r\n      parameters: [\r\n        { name: 'reason', type: 'string', description: 'Transfer reason', required: true },\r\n        { name: 'agentQueue', type: 'string', description: 'Target agent queue', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/voice.transferToHuman',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'send_call_summary_sms',\r\n      description: 'Send SMS summary after call ends.',\r\n      parameters: [\r\n        { name: 'phoneNumber', type: 'string', description: 'Phone number', required: true },\r\n        { name: 'summary', type: 'string', description: 'Call summary text', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/voice.sendCallSummarySms',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const smsIntegrationSkill: AISkill = {\r\n  id: 'sms-integration',\r\n  name: 'SMS Integration',\r\n  nameHe: 'אינטגרציית SMS',\r\n  description: 'Send and receive SMS messages for booking confirmations and updates',\r\n  descriptionHe: 'שליחה וקבלת הודעות SMS לאישורי הזמנות ועדכונים',\r\n  category: 'communication',\r\n  capabilities: ['sms-integration'],\r\n  isEnabled: true,\r\n  priority: 2,\r\n  requiredPermissions: ['sms:send'],\r\n  tools: [\r\n    {\r\n      name: 'send_sms',\r\n      description: 'Send SMS message to customer.',\r\n      parameters: [\r\n        { name: 'phoneNumber', type: 'string', description: 'Phone number (E.164)', required: true },\r\n        { name: 'message', type: 'string', description: 'Message content', required: true },\r\n        { name: 'template', type: 'string', description: 'Template ID', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/sms.sendSms',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'send_booking_confirmation_sms',\r\n      description: 'Send booking confirmation SMS with details.',\r\n      parameters: [\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'phoneNumber', type: 'string', description: 'Phone number', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/sms.sendBookingConfirmation',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const emailIntegrationSkill: AISkill = {\r\n  id: 'email-integration',\r\n  name: 'Email Integration',\r\n  nameHe: 'אינטגרציית אימייל',\r\n  description: 'Send booking confirmations and marketing emails',\r\n  descriptionHe: 'שליחת אישורי הזמנות ואימיילים שיווקיים',\r\n  category: 'communication',\r\n  capabilities: ['email-integration'],\r\n  isEnabled: true,\r\n  priority: 3,\r\n  requiredPermissions: ['email:send'],\r\n  tools: [\r\n    {\r\n      name: 'send_booking_email',\r\n      description: 'Send booking confirmation email.',\r\n      parameters: [\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'recipientEmail', type: 'string', description: 'Recipient email', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/email.sendBookingEmail',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'send_cancellation_email',\r\n      description: 'Send cancellation confirmation email.',\r\n      parameters: [\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'recipientEmail', type: 'string', description: 'Recipient email', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/email.sendCancellationEmail',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\n// ========================================\r\n// RESEARCH & ANALYSIS SKILLS\r\n// ========================================\r\n\r\nexport const webSearchSkill: AISkill = {\r\n  id: 'web-search',\r\n  name: 'Web Search',\r\n  nameHe: 'חיפוש באינטרנט',\r\n  description: 'Search the web for travel information, reviews, and recommendations',\r\n  descriptionHe: 'חיפוש באינטרנט למידע על נסיעות, ביקורות והמלצות',\r\n  category: 'research',\r\n  capabilities: ['web-search'],\r\n  isEnabled: true,\r\n  priority: 1,\r\n  requiredPermissions: ['search:web'],\r\n  tools: [\r\n    {\r\n      name: 'search_web',\r\n      description: 'Search the web for travel-related information.',\r\n      parameters: [\r\n        { name: 'query', type: 'string', description: 'Search query', required: true },\r\n        { name: 'type', type: 'string', description: 'Search type: general, news, reviews', required: false, default: 'general' },\r\n        { name: 'limit', type: 'number', description: 'Number of results', required: false, default: 5 }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/research.searchWeb',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_destination_info',\r\n      description: 'Get comprehensive information about a travel destination.',\r\n      parameters: [\r\n        { name: 'destination', type: 'string', description: 'Destination name', required: true },\r\n        { name: 'topics', type: 'array', description: 'Topics: weather, attractions, safety, cuisine', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/research.getDestinationInfo',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const knowledgeBaseSkill: AISkill = {\r\n  id: 'knowledge-base',\r\n  name: 'Knowledge Base',\r\n  nameHe: 'בסיס ידע',\r\n  description: 'Retrieve information from internal knowledge base using RAG',\r\n  descriptionHe: 'אחזור מידע מבסיס ידע פנימי באמצעות RAG',\r\n  category: 'research',\r\n  capabilities: ['rag-retrieval', 'knowledge-base'],\r\n  isEnabled: true,\r\n  priority: 2,\r\n  requiredPermissions: ['knowledge:read'],\r\n  tools: [\r\n    {\r\n      name: 'search_knowledge_base',\r\n      description: 'Search internal knowledge base for relevant information.',\r\n      parameters: [\r\n        { name: 'query', type: 'string', description: 'Search query', required: true },\r\n        { name: 'category', type: 'string', description: 'Knowledge category', required: false },\r\n        { name: 'topK', type: 'number', description: 'Number of results', required: false, default: 5 }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/knowledge.searchKnowledgeBase',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_faq_answer',\r\n      description: 'Get answer to frequently asked question.',\r\n      parameters: [\r\n        { name: 'question', type: 'string', description: 'The question', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/knowledge.getFaqAnswer',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const marketAnalysisSkill: AISkill = {\r\n  id: 'market-analysis',\r\n  name: 'Market Analysis',\r\n  nameHe: 'ניתוח שוק',\r\n  description: 'Analyze hotel market, competition, and pricing trends',\r\n  descriptionHe: 'ניתוח שוק מלונות, תחרות ומגמות תמחור',\r\n  category: 'analysis',\r\n  capabilities: ['analytics'],\r\n  isEnabled: true,\r\n  priority: 3,\r\n  requiredPermissions: ['analytics:read'],\r\n  tools: [\r\n    {\r\n      name: 'analyze_competition',\r\n      description: 'Analyze competitor hotels and their pricing.',\r\n      parameters: [\r\n        { name: 'hotelId', type: 'string', description: 'Target hotel ID', required: true },\r\n        { name: 'radius', type: 'number', description: 'Radius in km', required: false, default: 5 }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/analysis.analyzeCompetition',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_seasonality_insights',\r\n      description: 'Get seasonality and demand insights for a destination.',\r\n      parameters: [\r\n        { name: 'destination', type: 'string', description: 'Destination', required: true },\r\n        { name: 'year', type: 'number', description: 'Year', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/analysis.getSeasonalityInsights',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_upcoming_events',\r\n      description: 'Get upcoming events that may affect hotel demand.',\r\n      parameters: [\r\n        { name: 'destination', type: 'string', description: 'Destination', required: true },\r\n        { name: 'dateRange', type: 'object', description: 'Date range { from, to }', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/analysis.getUpcomingEvents',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\n// ========================================\r\n// PERSONALIZATION SKILLS\r\n// ========================================\r\n\r\nexport const userPreferencesSkill: AISkill = {\r\n  id: 'user-preferences',\r\n  name: 'User Preferences',\r\n  nameHe: 'העדפות משתמש',\r\n  description: 'Learn and apply user preferences for personalized recommendations',\r\n  descriptionHe: 'לימוד ויישום העדפות משתמש להמלצות מותאמות אישית',\r\n  category: 'personalization',\r\n  capabilities: ['analytics'],\r\n  isEnabled: true,\r\n  priority: 1,\r\n  requiredPermissions: ['user:read', 'user:write'],\r\n  tools: [\r\n    {\r\n      name: 'get_user_preferences',\r\n      description: 'Get stored user preferences.',\r\n      parameters: [\r\n        { name: 'userId', type: 'string', description: 'User ID', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/personalization.getUserPreferences',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'update_user_preferences',\r\n      description: 'Update user preferences based on interactions.',\r\n      parameters: [\r\n        { name: 'userId', type: 'string', description: 'User ID', required: true },\r\n        { name: 'preferences', type: 'object', description: 'Preferences to update', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/personalization.updateUserPreferences',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_personalized_recommendations',\r\n      description: 'Get hotel recommendations based on user preferences and history.',\r\n      parameters: [\r\n        { name: 'userId', type: 'string', description: 'User ID', required: true },\r\n        { name: 'destination', type: 'string', description: 'Destination', required: true },\r\n        { name: 'dates', type: 'object', description: 'Travel dates', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/personalization.getRecommendations',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const loyaltyProgramSkill: AISkill = {\r\n  id: 'loyalty-program',\r\n  name: 'Loyalty Program',\r\n  nameHe: 'תוכנית נאמנות',\r\n  description: 'Manage loyalty points, rewards, and member benefits',\r\n  descriptionHe: 'ניהול נקודות נאמנות, תגמולים והטבות חברים',\r\n  category: 'personalization',\r\n  capabilities: ['analytics'],\r\n  isEnabled: true,\r\n  priority: 2,\r\n  requiredPermissions: ['loyalty:read', 'loyalty:write'],\r\n  tools: [\r\n    {\r\n      name: 'get_loyalty_balance',\r\n      description: 'Get loyalty points balance and tier status.',\r\n      parameters: [\r\n        { name: 'userId', type: 'string', description: 'User ID', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/loyalty.getLoyaltyBalance',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'redeem_points',\r\n      description: 'Redeem loyalty points for rewards.',\r\n      parameters: [\r\n        { name: 'userId', type: 'string', description: 'User ID', required: true },\r\n        { name: 'points', type: 'number', description: 'Points to redeem', required: true },\r\n        { name: 'rewardType', type: 'string', description: 'Reward type', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/loyalty.redeemPoints',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'apply_member_discount',\r\n      description: 'Apply member discount to booking.',\r\n      parameters: [\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'userId', type: 'string', description: 'User ID', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/loyalty.applyMemberDiscount',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\n// ========================================\r\n// EXPORT ALL SKILLS\r\n// ========================================\r\n\r\n// ========================================\r\n// NEW ADVANCED SKILLS (V2)\r\n// ========================================\r\n\r\nexport const promoCodeSkill: AISkill = {\r\n  id: 'promo-code',\r\n  name: 'Promo Code Manager',\r\n  nameHe: 'ניהול קודי קופון',\r\n  description: 'Validate and apply promotional codes to bookings',\r\n  descriptionHe: 'אימות והחלת קודי קופון על הזמנות',\r\n  category: 'booking',\r\n  capabilities: ['promo', 'discount'],\r\n  isEnabled: true,\r\n  priority: 5,\r\n  requiredPermissions: ['promo:read', 'promo:apply'],\r\n  tools: [\r\n    {\r\n      name: 'validate_promo_code',\r\n      description: 'Check if a promo code is valid and get discount details.',\r\n      parameters: [\r\n        { name: 'code', type: 'string', description: 'Promotional code to validate', required: true },\r\n        { name: 'totalPrice', type: 'number', description: 'Total booking price for percentage calculation', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/promo.validatePromoCode',\r\n      isAsync: true,\r\n      timeout: 5000\r\n    },\r\n    {\r\n      name: 'apply_promo_code',\r\n      description: 'Apply a validated promo code to a booking.',\r\n      parameters: [\r\n        { name: 'code', type: 'string', description: 'Promotional code', required: true },\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID to apply discount', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/promo.applyPromoCode',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_available_promos',\r\n      description: 'Get all currently available promotions for the user.',\r\n      parameters: [\r\n        { name: 'userId', type: 'string', description: 'User ID for personalized promos', required: false },\r\n        { name: 'isMobile', type: 'boolean', description: 'Is mobile device', required: false, default: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/promo.getAvailablePromos',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const smartDateSuggestionSkill: AISkill = {\r\n  id: 'smart-date-suggestion',\r\n  name: 'Smart Date Suggestion',\r\n  nameHe: 'הצעת תאריכים חכמה',\r\n  description: 'Suggest optimal dates based on price, availability, and demand patterns',\r\n  descriptionHe: 'הצעת תאריכים אופטימליים על בסיס מחיר, זמינות ודפוסי ביקוש',\r\n  category: 'analysis',\r\n  capabilities: ['recommendation', 'optimization'],\r\n  isEnabled: true,\r\n  priority: 6,\r\n  requiredPermissions: ['booking:read', 'analytics:read'],\r\n  tools: [\r\n    {\r\n      name: 'suggest_cheaper_dates',\r\n      description: 'Find cheaper dates near the requested dates for the same hotel.',\r\n      parameters: [\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\r\n        { name: 'requestedCheckIn', type: 'date', description: 'Originally requested check-in', required: true },\r\n        { name: 'requestedCheckOut', type: 'date', description: 'Originally requested check-out', required: true },\r\n        { name: 'flexibility', type: 'number', description: 'Days of flexibility (e.g., 3 = ±3 days)', required: false, default: 3 },\r\n        { name: 'adults', type: 'number', description: 'Number of adults', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/dates.suggestCheaperDates',\r\n      isAsync: true,\r\n      timeout: 30000\r\n    },\r\n    {\r\n      name: 'get_price_calendar',\r\n      description: 'Get a calendar view of prices for a hotel over a date range.',\r\n      parameters: [\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\r\n        { name: 'startDate', type: 'date', description: 'Calendar start date', required: true },\r\n        { name: 'endDate', type: 'date', description: 'Calendar end date', required: true },\r\n        { name: 'nights', type: 'number', description: 'Number of nights per stay', required: false, default: 1 }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/dates.getPriceCalendar',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const roomComparisonSkill: AISkill = {\r\n  id: 'room-comparison',\r\n  name: 'Room Comparison',\r\n  nameHe: 'השוואת חדרים',\r\n  description: 'Compare multiple rooms side-by-side with detailed analysis',\r\n  descriptionHe: 'השוואת מספר חדרים זה מול זה עם ניתוח מפורט',\r\n  category: 'analysis',\r\n  capabilities: ['comparison', 'recommendation'],\r\n  isEnabled: true,\r\n  priority: 7,\r\n  requiredPermissions: ['booking:read'],\r\n  tools: [\r\n    {\r\n      name: 'compare_rooms',\r\n      description: 'Compare selected rooms with detailed feature comparison.',\r\n      parameters: [\r\n        { name: 'roomCodes', type: 'array', description: 'Array of room codes to compare (2-5 rooms)', required: true },\r\n        { name: 'priorityFactors', type: 'array', description: 'What to prioritize: price, size, view, amenities', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/rooms.compareRooms',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'recommend_best_room',\r\n      description: 'Recommend the best room based on user preferences.',\r\n      parameters: [\r\n        { name: 'searchResults', type: 'object', description: 'Search results with rooms', required: true },\r\n        { name: 'preferences', type: 'object', description: 'User preferences { budget, roomSize, view, amenities }', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/rooms.recommendBestRoom',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const bundleDealsSkill: AISkill = {\r\n  id: 'bundle-deals',\r\n  name: 'Bundle Deals',\r\n  nameHe: 'חבילות משולבות',\r\n  description: 'Create and suggest hotel + flight bundles, packages, and combo deals',\r\n  descriptionHe: 'יצירה והצעת חבילות מלון + טיסה, פקג\\'ים ומבצעים משולבים',\r\n  category: 'booking',\r\n  capabilities: ['bundling', 'upsell'],\r\n  isEnabled: true,\r\n  priority: 8,\r\n  requiredPermissions: ['booking:read', 'flights:read'],\r\n  tools: [\r\n    {\r\n      name: 'search_flight_hotel_bundle',\r\n      description: 'Search for combined flight + hotel packages.',\r\n      parameters: [\r\n        { name: 'origin', type: 'string', description: 'Origin city/airport code', required: true },\r\n        { name: 'destination', type: 'string', description: 'Destination city', required: true },\r\n        { name: 'departureDate', type: 'date', description: 'Outbound flight date', required: true },\r\n        { name: 'returnDate', type: 'date', description: 'Return flight date', required: true },\r\n        { name: 'adults', type: 'number', description: 'Number of adults', required: true },\r\n        { name: 'children', type: 'array', description: 'Children ages', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/bundles.searchFlightHotelBundle',\r\n      isAsync: true,\r\n      timeout: 60000\r\n    },\r\n    {\r\n      name: 'suggest_add_ons',\r\n      description: 'Suggest add-ons for a booking (transfers, tours, insurance).',\r\n      parameters: [\r\n        { name: 'bookingDetails', type: 'object', description: 'Current booking details', required: true },\r\n        { name: 'destination', type: 'string', description: 'Destination city', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/bundles.suggestAddOns',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const waitlistSkill: AISkill = {\r\n  id: 'waitlist',\r\n  name: 'Waitlist Manager',\r\n  nameHe: 'ניהול רשימת המתנה',\r\n  description: 'Manage waitlists for sold-out dates, notify when available',\r\n  descriptionHe: 'ניהול רשימות המתנה לתאריכים אזלו, הודעה בזמינות',\r\n  category: 'booking',\r\n  capabilities: ['waitlist', 'notification'],\r\n  isEnabled: true,\r\n  priority: 9,\r\n  requiredPermissions: ['booking:read', 'notification:send'],\r\n  tools: [\r\n    {\r\n      name: 'join_waitlist',\r\n      description: 'Add user to waitlist for sold-out dates.',\r\n      parameters: [\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\r\n        { name: 'roomCategory', type: 'string', description: 'Room category', required: true },\r\n        { name: 'checkIn', type: 'date', description: 'Requested check-in', required: true },\r\n        { name: 'checkOut', type: 'date', description: 'Requested check-out', required: true },\r\n        { name: 'email', type: 'string', description: 'Email for notification', required: true },\r\n        { name: 'phone', type: 'string', description: 'Phone for SMS notification', required: false },\r\n        { name: 'maxPrice', type: 'number', description: 'Maximum price willing to pay', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/waitlist.joinWaitlist',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'check_waitlist_status',\r\n      description: 'Check current position in waitlist.',\r\n      parameters: [\r\n        { name: 'waitlistId', type: 'string', description: 'Waitlist entry ID', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/waitlist.checkStatus',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const groupBookingSkill: AISkill = {\r\n  id: 'group-booking',\r\n  name: 'Group Booking',\r\n  nameHe: 'הזמנות קבוצתיות',\r\n  description: 'Handle group bookings with multiple rooms and special pricing',\r\n  descriptionHe: 'טיפול בהזמנות קבוצתיות עם מספר חדרים ותמחור מיוחד',\r\n  category: 'booking',\r\n  capabilities: ['group', 'bulk'],\r\n  isEnabled: true,\r\n  priority: 10,\r\n  requiredPermissions: ['booking:write', 'group:manage'],\r\n  tools: [\r\n    {\r\n      name: 'create_group_booking',\r\n      description: 'Create a group booking with multiple rooms.',\r\n      parameters: [\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\r\n        { name: 'checkIn', type: 'date', description: 'Check-in date', required: true },\r\n        { name: 'checkOut', type: 'date', description: 'Check-out date', required: true },\r\n        { name: 'rooms', type: 'array', description: 'Array of room requirements [{ type, count, guests }]', required: true },\r\n        { name: 'groupName', type: 'string', description: 'Group/event name', required: true },\r\n        { name: 'contactPerson', type: 'object', description: 'Main contact details', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/groups.createGroupBooking',\r\n      isAsync: true,\r\n      timeout: 60000\r\n    },\r\n    {\r\n      name: 'get_group_pricing',\r\n      description: 'Get special pricing for group bookings.',\r\n      parameters: [\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\r\n        { name: 'roomCount', type: 'number', description: 'Number of rooms needed', required: true },\r\n        { name: 'nights', type: 'number', description: 'Number of nights', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/groups.getGroupPricing',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const affiliateSkill: AISkill = {\r\n  id: 'affiliate',\r\n  name: 'Affiliate Management',\r\n  nameHe: 'ניהול שותפים',\r\n  description: 'Track and manage affiliate referrals and commissions',\r\n  descriptionHe: 'מעקב וניהול הפניות שותפים ועמלות',\r\n  category: 'marketing',\r\n  capabilities: ['affiliate', 'tracking'],\r\n  isEnabled: true,\r\n  priority: 11,\r\n  requiredPermissions: ['affiliate:read', 'affiliate:write'],\r\n  tools: [\r\n    {\r\n      name: 'track_affiliate_click',\r\n      description: 'Track an affiliate referral click.',\r\n      parameters: [\r\n        { name: 'affiliateCode', type: 'string', description: 'Affiliate code', required: true },\r\n        { name: 'hotelId', type: 'string', description: 'Hotel viewed', required: false },\r\n        { name: 'source', type: 'string', description: 'Traffic source', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/affiliate.trackClick',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'convert_affiliate',\r\n      description: 'Record an affiliate conversion (booking completed).',\r\n      parameters: [\r\n        { name: 'affiliateCode', type: 'string', description: 'Affiliate code', required: true },\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'amount', type: 'number', description: 'Booking amount', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/affiliate.convertAffiliate',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\n// ========================================\r\n// ADVANCED RESEARCH & INTELLIGENCE SKILLS (V3)\r\n// ========================================\r\n\r\nexport const destinationInfoSkill: AISkill = {\r\n  id: 'destination-info',\r\n  name: 'Destination Intelligence',\r\n  nameHe: 'מודיעין יעדים',\r\n  description: 'Real-time destination information including weather, events, attractions, safety and local tips using Tavily AI search',\r\n  descriptionHe: 'מידע יעדים בזמן אמת כולל מזג אוויר, אירועים, אטרקציות, בטיחות וטיפים מקומיים',\r\n  category: 'research',\r\n  capabilities: ['web-search', 'destination-info', 'real-time'],\r\n  isEnabled: true,\r\n  priority: 12,\r\n  requiredPermissions: ['search:web', 'destination:read'],\r\n  tools: [\r\n    {\r\n      name: 'get_destination_info',\r\n      description: 'Get comprehensive destination information including weather, events, attractions, safety and local tips.',\r\n      parameters: [\r\n        { name: 'destination', type: 'string', description: 'Destination city or area name', required: true },\r\n        { name: 'travelDates', type: 'object', description: 'Travel dates { checkIn, checkOut }', required: false },\r\n        { name: 'interests', type: 'array', description: 'User interests: culture, food, nightlife, nature, family, etc.', required: false }\r\n      ],\r\n      handler: 'lib/services/destination-info-service.getDestinationInfo',\r\n      isAsync: true,\r\n      timeout: 30000\r\n    },\r\n    {\r\n      name: 'get_destination_weather',\r\n      description: 'Get weather forecast and climate info for a destination.',\r\n      parameters: [\r\n        { name: 'destination', type: 'string', description: 'Destination name', required: true },\r\n        { name: 'dates', type: 'object', description: 'Date range { from, to }', required: false }\r\n      ],\r\n      handler: 'lib/services/destination-info-service.getDestinationWeather',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_destination_events',\r\n      description: 'Get upcoming events, festivals, and happenings at destination.',\r\n      parameters: [\r\n        { name: 'destination', type: 'string', description: 'Destination name', required: true },\r\n        { name: 'dateRange', type: 'object', description: 'Date range { from, to }', required: true },\r\n        { name: 'eventTypes', type: 'array', description: 'Event types: music, sports, culture, food, etc.', required: false }\r\n      ],\r\n      handler: 'lib/services/destination-info-service.getDestinationEvents',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_destination_attractions',\r\n      description: 'Get top attractions and things to do at destination.',\r\n      parameters: [\r\n        { name: 'destination', type: 'string', description: 'Destination name', required: true },\r\n        { name: 'limit', type: 'number', description: 'Number of attractions', required: false, default: 10 },\r\n        { name: 'categories', type: 'array', description: 'Attraction categories: museums, nature, landmarks, etc.', required: false }\r\n      ],\r\n      handler: 'lib/services/destination-info-service.getDestinationAttractions',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const customerMemorySkill: AISkill = {\r\n  id: 'customer-memory',\r\n  name: 'Customer Memory',\r\n  nameHe: 'זיכרון לקוח',\r\n  description: 'Long-term customer memory for preferences, history, and personalized recommendations using intelligent profile learning',\r\n  descriptionHe: 'זיכרון לקוח ארוך טווח להעדפות, היסטוריה והמלצות מותאמות אישית',\r\n  category: 'personalization',\r\n  capabilities: ['memory', 'personalization', 'learning'],\r\n  isEnabled: true,\r\n  priority: 13,\r\n  requiredPermissions: ['user:read', 'user:write', 'memory:read', 'memory:write'],\r\n  tools: [\r\n    {\r\n      name: 'get_customer_profile',\r\n      description: 'Get complete customer profile including preferences, history, and inferred insights.',\r\n      parameters: [\r\n        { name: 'customerId', type: 'string', description: 'Customer ID', required: true }\r\n      ],\r\n      handler: 'lib/services/customer-memory-service.getCustomerProfile',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'save_preference',\r\n      description: 'Save a customer preference learned from interaction.',\r\n      parameters: [\r\n        { name: 'customerId', type: 'string', description: 'Customer ID', required: true },\r\n        { name: 'category', type: 'string', description: 'Preference category: accommodation, dining, activities, travel_style, budget', required: true },\r\n        { name: 'key', type: 'string', description: 'Preference key (e.g., \"preferred_room_type\")', required: true },\r\n        { name: 'value', type: 'string', description: 'Preference value', required: true },\r\n        { name: 'confidence', type: 'number', description: 'Confidence score 0-1', required: false, default: 0.8 }\r\n      ],\r\n      handler: 'lib/services/customer-memory-service.savePreference',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'record_customer_event',\r\n      description: 'Record a customer event (booking, search, cancellation) for history.',\r\n      parameters: [\r\n        { name: 'customerId', type: 'string', description: 'Customer ID', required: true },\r\n        { name: 'eventType', type: 'string', description: 'Event type: booking, search, cancellation, inquiry, review', required: true },\r\n        { name: 'eventData', type: 'object', description: 'Event details', required: true }\r\n      ],\r\n      handler: 'lib/services/customer-memory-service.recordCustomerEvent',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_personalized_recommendations',\r\n      description: 'Get personalized recommendations based on customer profile and history.',\r\n      parameters: [\r\n        { name: 'customerId', type: 'string', description: 'Customer ID', required: true },\r\n        { name: 'context', type: 'object', description: 'Current search context { destination, dates, budget }', required: true },\r\n        { name: 'limit', type: 'number', description: 'Number of recommendations', required: false, default: 5 }\r\n      ],\r\n      handler: 'lib/services/customer-memory-service.getPersonalizedRecommendations',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'delete_customer_data',\r\n      description: 'Delete all customer data (GDPR compliance).',\r\n      parameters: [\r\n        { name: 'customerId', type: 'string', description: 'Customer ID', required: true },\r\n        { name: 'confirmation', type: 'boolean', description: 'Confirm deletion', required: true }\r\n      ],\r\n      handler: 'lib/services/customer-memory-service.deleteCustomerData',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const priceComparisonSkill: AISkill = {\r\n  id: 'price-comparison',\r\n  name: 'Price Comparison Engine',\r\n  nameHe: 'מנוע השוואת מחירים',\r\n  description: 'Compare hotel prices across multiple booking platforms, find best deals, and track price changes',\r\n  descriptionHe: 'השוואת מחירי מלונות בפלטפורמות הזמנה מרובות, איתור עסקאות הטובות ומעקב שינויי מחיר',\r\n  category: 'analysis',\r\n  capabilities: ['price-comparison', 'analytics', 'monitoring'],\r\n  isEnabled: true,\r\n  priority: 14,\r\n  requiredPermissions: ['booking:read', 'monitoring:read', 'monitoring:write'],\r\n  tools: [\r\n    {\r\n      name: 'compare_prices',\r\n      description: 'Compare hotel prices across multiple booking platforms.',\r\n      parameters: [\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\r\n        { name: 'checkIn', type: 'date', description: 'Check-in date', required: true },\r\n        { name: 'checkOut', type: 'date', description: 'Check-out date', required: true },\r\n        { name: 'guests', type: 'object', description: 'Guests { adults, children }', required: true },\r\n        { name: 'roomType', type: 'string', description: 'Room type filter', required: false }\r\n      ],\r\n      handler: 'lib/services/price-comparison-service.comparePrices',\r\n      isAsync: true,\r\n      timeout: 45000\r\n    },\r\n    {\r\n      name: 'get_price_history',\r\n      description: 'Get historical price data for a hotel across sources.',\r\n      parameters: [\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\r\n        { name: 'dateRange', type: 'object', description: 'Date range { from, to }', required: true }\r\n      ],\r\n      handler: 'lib/services/price-comparison-service.getPriceHistory',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'predict_best_price',\r\n      description: 'Predict best time to book based on price patterns.',\r\n      parameters: [\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\r\n        { name: 'travelDates', type: 'object', description: 'Travel dates { checkIn, checkOut }', required: true }\r\n      ],\r\n      handler: 'lib/services/price-comparison-service.getPricePrediction',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'create_price_alert',\r\n      description: 'Create alert when price drops below target.',\r\n      parameters: [\r\n        { name: 'customerId', type: 'string', description: 'Customer ID', required: true },\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\r\n        { name: 'targetPrice', type: 'number', description: 'Target price', required: true },\r\n        { name: 'checkIn', type: 'date', description: 'Check-in date', required: true },\r\n        { name: 'checkOut', type: 'date', description: 'Check-out date', required: true },\r\n        { name: 'notifyEmail', type: 'string', description: 'Email for notifications', required: true }\r\n      ],\r\n      handler: 'lib/services/price-comparison-service.createPriceAlert',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const travelBundleSkill: AISkill = {\r\n  id: 'travel-bundle',\r\n  name: 'Travel Bundle Search',\r\n  nameHe: 'חיפוש חבילות נסיעה',\r\n  description: 'Search and compare flight+hotel packages with savings analysis',\r\n  descriptionHe: 'חיפוש והשוואת חבילות טיסה+מלון עם ניתוח חיסכון',\r\n  category: 'booking',\r\n  capabilities: ['bundling', 'comparison', 'savings'],\r\n  isEnabled: true,\r\n  priority: 15,\r\n  requiredPermissions: ['booking:read', 'flights:read'],\r\n  tools: [\r\n    {\r\n      name: 'search_bundles',\r\n      description: 'Search for flight+hotel bundle packages.',\r\n      parameters: [\r\n        { name: 'origin', type: 'string', description: 'Origin city or airport code', required: true },\r\n        { name: 'destination', type: 'string', description: 'Destination city', required: true },\r\n        { name: 'checkIn', type: 'date', description: 'Check-in/departure date', required: true },\r\n        { name: 'checkOut', type: 'date', description: 'Check-out/return date', required: true },\r\n        { name: 'adults', type: 'number', description: 'Number of adults', required: true },\r\n        { name: 'children', type: 'array', description: 'Children ages', required: false },\r\n        { name: 'class', type: 'string', description: 'Flight class: economy, business, first', required: false },\r\n        { name: 'hotelStars', type: 'array', description: 'Hotel star ratings filter', required: false },\r\n        { name: 'maxBudget', type: 'number', description: 'Maximum total budget', required: false }\r\n      ],\r\n      handler: 'lib/services/travel-bundle-service.searchBundles',\r\n      isAsync: true,\r\n      timeout: 60000\r\n    },\r\n    {\r\n      name: 'get_bundle_details',\r\n      description: 'Get detailed information about a specific bundle.',\r\n      parameters: [\r\n        { name: 'bundleId', type: 'string', description: 'Bundle ID', required: true }\r\n      ],\r\n      handler: 'lib/services/travel-bundle-service.getBundleDetails',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'check_bundle_availability',\r\n      description: 'Check real-time availability of a bundle before booking.',\r\n      parameters: [\r\n        { name: 'bundleId', type: 'string', description: 'Bundle ID', required: true }\r\n      ],\r\n      handler: 'lib/services/travel-bundle-service.checkBundleAvailability',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'create_custom_bundle',\r\n      description: 'Create a custom bundle from individual flight and hotel selections.',\r\n      parameters: [\r\n        { name: 'flightIds', type: 'array', description: 'Selected flight IDs', required: false },\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\r\n        { name: 'roomCode', type: 'string', description: 'Room code', required: true },\r\n        { name: 'checkIn', type: 'date', description: 'Check-in date', required: true },\r\n        { name: 'checkOut', type: 'date', description: 'Check-out date', required: true },\r\n        { name: 'extras', type: 'array', description: 'Extra services: transfer, insurance, tours', required: false }\r\n      ],\r\n      handler: 'lib/services/travel-bundle-service.createCustomBundle',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_bundle_breakdown',\r\n      description: 'Get price breakdown for a bundle showing savings.',\r\n      parameters: [\r\n        { name: 'bundleId', type: 'string', description: 'Bundle ID', required: true }\r\n      ],\r\n      handler: 'lib/services/travel-bundle-service.getBundlePriceBreakdown',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\n// ========================================\r\n// PHASE 1 CRITICAL SKILLS\r\n// ========================================\r\n\r\nexport const paymentProcessingSkill: AISkill = {\r\n  id: 'payment-processing',\r\n  name: 'Payment Processing',\r\n  nameHe: 'עיבוד תשלומים',\r\n  description: 'Process payments securely using Stripe. Supports credit cards, Apple Pay, Google Pay, and 3D Secure.',\r\n  descriptionHe: 'עיבוד תשלומים מאובטח באמצעות Stripe. תומך בכרטיסי אשראי, Apple Pay, Google Pay ו-3D Secure.',\r\n  category: 'booking',\r\n  capabilities: ['payment-processing'],\r\n  isEnabled: true,\r\n  priority: 4,\r\n  requiredPermissions: ['payment:process', 'booking:write'],\r\n  tools: [\r\n    {\r\n      name: 'create_payment_intent',\r\n      description: 'Create a Stripe payment intent for a booking',\r\n      parameters: [\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'amount', type: 'number', description: 'Amount in cents', required: true },\r\n        { name: 'currency', type: 'string', description: 'Currency code (USD, EUR, ILS)', required: true },\r\n        { name: 'customerEmail', type: 'string', description: 'Customer email', required: true },\r\n        { name: 'customerName', type: 'string', description: 'Customer name', required: false },\r\n        { name: 'description', type: 'string', description: 'Payment description', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/payment.createPaymentIntent',\r\n      isAsync: true,\r\n      timeout: 30000\r\n    },\r\n    {\r\n      name: 'process_payment',\r\n      description: 'Process a payment using an existing payment intent',\r\n      parameters: [\r\n        { name: 'paymentIntentId', type: 'string', description: 'Stripe Payment Intent ID', required: true },\r\n        { name: 'paymentMethodId', type: 'string', description: 'Stripe Payment Method ID', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/payment.processPayment',\r\n      isAsync: true,\r\n      timeout: 60000\r\n    },\r\n    {\r\n      name: 'verify_payment',\r\n      description: 'Verify a payment was successful',\r\n      parameters: [\r\n        { name: 'paymentIntentId', type: 'string', description: 'Stripe Payment Intent ID', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/payment.verifyPayment',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_payment_status',\r\n      description: 'Get current status of a payment',\r\n      parameters: [\r\n        { name: 'paymentIntentId', type: 'string', description: 'Stripe Payment Intent ID', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/payment.getPaymentStatus',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'cancel_payment',\r\n      description: 'Cancel a pending payment intent',\r\n      parameters: [\r\n        { name: 'paymentIntentId', type: 'string', description: 'Stripe Payment Intent ID', required: true },\r\n        { name: 'reason', type: 'string', description: 'Cancellation reason', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/payment.cancelPayment',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const refundProcessingSkill: AISkill = {\r\n  id: 'refund-processing',\r\n  name: 'Refund Processing',\r\n  nameHe: 'עיבוד החזרים',\r\n  description: 'Process refunds automatically based on cancellation policy. Supports full and partial refunds.',\r\n  descriptionHe: 'עיבוד החזרים אוטומטי על פי מדיניות הביטול. תומך בהחזרים מלאים וחלקיים.',\r\n  category: 'booking',\r\n  capabilities: ['refund-processing', 'cancellation'],\r\n  isEnabled: true,\r\n  priority: 5,\r\n  requiredPermissions: ['payment:refund', 'booking:cancel'],\r\n  tools: [\r\n    {\r\n      name: 'calculate_refund_amount',\r\n      description: 'Calculate refund amount based on cancellation policy',\r\n      parameters: [\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'paymentIntentId', type: 'string', description: 'Original payment intent ID', required: true },\r\n        { name: 'cancellationDate', type: 'date', description: 'Cancellation date', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/refund.calculateRefundAmount',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'process_refund',\r\n      description: 'Process a full refund for a booking',\r\n      parameters: [\r\n        { name: 'paymentIntentId', type: 'string', description: 'Original payment intent ID', required: true },\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'reason', type: 'string', description: 'Refund reason', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/refund.processRefund',\r\n      isAsync: true,\r\n      timeout: 30000\r\n    },\r\n    {\r\n      name: 'process_partial_refund',\r\n      description: 'Process a partial refund for a booking',\r\n      parameters: [\r\n        { name: 'paymentIntentId', type: 'string', description: 'Original payment intent ID', required: true },\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'amount', type: 'number', description: 'Refund amount in cents', required: true },\r\n        { name: 'reason', type: 'string', description: 'Refund reason', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/refund.processPartialRefund',\r\n      isAsync: true,\r\n      timeout: 30000\r\n    },\r\n    {\r\n      name: 'get_refund_status',\r\n      description: 'Get status of a refund',\r\n      parameters: [\r\n        { name: 'refundId', type: 'string', description: 'Stripe Refund ID', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/refund.getRefundStatus',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'auto_refund_with_policy',\r\n      description: 'Automatically refund based on cancellation policy',\r\n      parameters: [\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'paymentIntentId', type: 'string', description: 'Original payment intent ID', required: true },\r\n        { name: 'reason', type: 'string', description: 'Cancellation reason', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/refund.autoRefundWithPolicy',\r\n      isAsync: true,\r\n      timeout: 60000\r\n    }\r\n  ]\r\n};\r\n\r\nexport const invoiceGenerationSkill: AISkill = {\r\n  id: 'invoice-generation',\r\n  name: 'Invoice Generation',\r\n  nameHe: 'הפקת חשבוניות',\r\n  description: 'Generate professional invoices and receipts in multiple languages with PDF export.',\r\n  descriptionHe: 'הפקת חשבוניות מקצועיות וקבלות במספר שפות עם ייצוא PDF.',\r\n  category: 'communication',\r\n  capabilities: ['invoice', 'pdf-generation', 'email'],\r\n  isEnabled: true,\r\n  priority: 6,\r\n  requiredPermissions: ['booking:read', 'invoice:generate'],\r\n  tools: [\r\n    {\r\n      name: 'generate_invoice',\r\n      description: 'Generate an invoice for a booking',\r\n      parameters: [\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'hotelName', type: 'string', description: 'Hotel name', required: true },\r\n        { name: 'roomType', type: 'string', description: 'Room type', required: true },\r\n        { name: 'checkIn', type: 'date', description: 'Check-in date', required: true },\r\n        { name: 'checkOut', type: 'date', description: 'Check-out date', required: true },\r\n        { name: 'totalPrice', type: 'number', description: 'Total price in cents', required: true },\r\n        { name: 'currency', type: 'string', description: 'Currency code', required: true },\r\n        { name: 'customerName', type: 'string', description: 'Customer name', required: true },\r\n        { name: 'customerEmail', type: 'string', description: 'Customer email', required: true },\r\n        { name: 'confirmationNumber', type: 'string', description: 'Confirmation number', required: true },\r\n        { name: 'guests', type: 'number', description: 'Number of guests', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/invoice.generateInvoice',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'send_invoice_email',\r\n      description: 'Send invoice via email',\r\n      parameters: [\r\n        { name: 'to', type: 'string', description: 'Recipient email', required: true },\r\n        { name: 'invoiceNumber', type: 'string', description: 'Invoice number', required: true },\r\n        { name: 'invoiceHtml', type: 'string', description: 'Invoice HTML content', required: true },\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'customerName', type: 'string', description: 'Customer name', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/invoice.sendInvoiceEmail',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'generate_receipt',\r\n      description: 'Generate a receipt for a completed payment',\r\n      parameters: [\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'paymentId', type: 'string', description: 'Payment ID', required: true },\r\n        { name: 'amount', type: 'number', description: 'Payment amount in cents', required: true },\r\n        { name: 'currency', type: 'string', description: 'Currency code', required: true },\r\n        { name: 'customerName', type: 'string', description: 'Customer name', required: true },\r\n        { name: 'customerEmail', type: 'string', description: 'Customer email', required: true },\r\n        { name: 'hotelName', type: 'string', description: 'Hotel name', required: true },\r\n        { name: 'confirmationNumber', type: 'string', description: 'Confirmation number', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/invoice.generateReceipt',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const fraudDetectionSkill: AISkill = {\r\n  id: 'fraud-detection',\r\n  name: 'Fraud Detection',\r\n  nameHe: 'זיהוי הונאות',\r\n  description: 'Analyze bookings for fraud risk using multiple signals: velocity, email patterns, geolocation, and behavior analysis.',\r\n  descriptionHe: 'ניתוח הזמנות לזיהוי סיכוני הונאה באמצעות אותות מרובים: קצב, דפוסי אימייל, מיקום גיאוגרפי וניתוח התנהגות.',\r\n  category: 'analysis',\r\n  capabilities: ['fraud-detection', 'risk-scoring', 'security'],\r\n  isEnabled: true,\r\n  priority: 3,\r\n  requiredPermissions: ['booking:read', 'security:analyze'],\r\n  tools: [\r\n    {\r\n      name: 'analyze_booking_risk',\r\n      description: 'Analyze a booking for fraud risk and get a risk score',\r\n      parameters: [\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'customerEmail', type: 'string', description: 'Customer email', required: true },\r\n        { name: 'customerName', type: 'string', description: 'Customer name', required: true },\r\n        { name: 'amount', type: 'number', description: 'Booking amount in cents', required: true },\r\n        { name: 'currency', type: 'string', description: 'Currency code', required: true },\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\r\n        { name: 'checkIn', type: 'date', description: 'Check-in date', required: true },\r\n        { name: 'checkOut', type: 'date', description: 'Check-out date', required: true },\r\n        { name: 'ipAddress', type: 'string', description: 'Customer IP address', required: false },\r\n        { name: 'billingCountry', type: 'string', description: 'Billing country code', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/fraud.analyzeBookingRisk',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'flag_suspicious_activity',\r\n      description: 'Flag suspicious activity for review',\r\n      parameters: [\r\n        { name: 'type', type: 'string', description: 'Type: velocity, mismatch, pattern, blacklist, geolocation, device', required: true },\r\n        { name: 'severity', type: 'string', description: 'Severity: low, medium, high, critical', required: true },\r\n        { name: 'description', type: 'string', description: 'Activity description', required: true },\r\n        { name: 'bookingId', type: 'string', description: 'Related booking ID', required: false },\r\n        { name: 'customerId', type: 'string', description: 'Related customer ID', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/fraud.flagSuspiciousActivity',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_risk_score',\r\n      description: 'Get a quick risk score for a booking',\r\n      parameters: [\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'customerEmail', type: 'string', description: 'Customer email', required: true },\r\n        { name: 'amount', type: 'number', description: 'Booking amount in cents', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/fraud.getRiskScore',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'check_blacklist',\r\n      description: 'Check if customer is on blacklist',\r\n      parameters: [\r\n        { name: 'email', type: 'string', description: 'Customer email', required: false },\r\n        { name: 'phone', type: 'string', description: 'Customer phone', required: false },\r\n        { name: 'ipAddress', type: 'string', description: 'Customer IP address', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/fraud.checkBlacklist',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'run_fraud_checks',\r\n      description: 'Run all fraud checks on a booking',\r\n      parameters: [\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'customerEmail', type: 'string', description: 'Customer email', required: true },\r\n        { name: 'customerName', type: 'string', description: 'Customer name', required: true },\r\n        { name: 'amount', type: 'number', description: 'Booking amount in cents', required: true },\r\n        { name: 'currency', type: 'string', description: 'Currency code', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/fraud.runFraudChecks',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const calendarSyncSkill: AISkill = {\r\n  id: 'calendar-sync',\r\n  name: 'Calendar Integration',\r\n  nameHe: 'אינטגרציית לוח שנה',\r\n  description: 'Add bookings to Google Calendar, Outlook, Apple Calendar with automatic reminders',\r\n  descriptionHe: 'הוספת הזמנות ללוח שנה של גוגל, אאוטלוק, אפל עם תזכורות אוטומטיות',\r\n  category: 'communication',\r\n  capabilities: ['calendar', 'sync', 'reminders'],\r\n  isEnabled: true,\r\n  priority: 16,\r\n  requiredPermissions: ['booking:read', 'calendar:write'],\r\n  tools: [\r\n    {\r\n      name: 'add_to_calendar',\r\n      description: 'Generate calendar links for a booking (Google, Outlook, Apple, Yahoo).',\r\n      parameters: [\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'hotelName', type: 'string', description: 'Hotel name', required: true },\r\n        { name: 'hotelAddress', type: 'string', description: 'Hotel address', required: true },\r\n        { name: 'checkIn', type: 'date', description: 'Check-in date', required: true },\r\n        { name: 'checkOut', type: 'date', description: 'Check-out date', required: true },\r\n        { name: 'roomType', type: 'string', description: 'Room type', required: true },\r\n        { name: 'confirmationNumber', type: 'string', description: 'Confirmation number', required: true },\r\n        { name: 'guests', type: 'array', description: 'Guest names', required: true }\r\n      ],\r\n      handler: 'lib/services/calendar-sync-service.getAllCalendarLinks',\r\n      isAsync: false\r\n    },\r\n    {\r\n      name: 'download_ics_file',\r\n      description: 'Download ICS calendar file for the booking.',\r\n      parameters: [\r\n        { name: 'booking', type: 'object', description: 'Booking details', required: true }\r\n      ],\r\n      handler: 'lib/services/calendar-sync-service.downloadICSFile',\r\n      isAsync: false\r\n    },\r\n    {\r\n      name: 'sync_to_google_calendar',\r\n      description: 'Sync booking directly to connected Google Calendar (requires OAuth).',\r\n      parameters: [\r\n        { name: 'booking', type: 'object', description: 'Booking details', required: true },\r\n        { name: 'accessToken', type: 'string', description: 'Google OAuth access token', required: true }\r\n      ],\r\n      handler: 'lib/services/calendar-sync-service.syncToConnectedCalendar',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'update_calendar_event',\r\n      description: 'Update an existing calendar event (for booking modifications).',\r\n      parameters: [\r\n        { name: 'provider', type: 'string', description: 'Calendar provider: google, outlook', required: true },\r\n        { name: 'eventId', type: 'string', description: 'Calendar event ID', required: true },\r\n        { name: 'booking', type: 'object', description: 'Updated booking details', required: true },\r\n        { name: 'accessToken', type: 'string', description: 'OAuth access token', required: true }\r\n      ],\r\n      handler: 'lib/services/calendar-sync-service.updateCalendarEvent',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'delete_calendar_event',\r\n      description: 'Delete calendar event (for cancellations).',\r\n      parameters: [\r\n        { name: 'provider', type: 'string', description: 'Calendar provider', required: true },\r\n        { name: 'eventId', type: 'string', description: 'Calendar event ID', required: true },\r\n        { name: 'accessToken', type: 'string', description: 'OAuth access token', required: true }\r\n      ],\r\n      handler: 'lib/services/calendar-sync-service.deleteCalendarEvent',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\n// ========================================\r\n// PHASE 2 SKILLS\r\n// ========================================\r\n\r\nexport const travelInsuranceSkill: AISkill = {\r\n  id: 'travel-insurance',\r\n  name: 'Travel Insurance',\r\n  nameHe: 'ביטוח נסיעות',\r\n  description: 'Offer and manage travel insurance plans with quotes, purchases, claims, and cancellations.',\r\n  descriptionHe: 'הצעה וניהול תוכניות ביטוח נסיעות כולל הצעות מחיר, רכישות, תביעות וביטולים.',\r\n  category: 'booking',\r\n  capabilities: ['insurance', 'quotes', 'claims'],\r\n  isEnabled: true,\r\n  priority: 7,\r\n  requiredPermissions: ['booking:read', 'insurance:manage'],\r\n  tools: [\r\n    {\r\n      name: 'get_insurance_plans',\r\n      description: 'Get available travel insurance plans',\r\n      parameters: [\r\n        { name: 'destination', type: 'string', description: 'Travel destination', required: false },\r\n        { name: 'tripType', type: 'string', description: 'Type of trip', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/insurance.getInsurancePlans',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_insurance_quote',\r\n      description: 'Get a quote for travel insurance',\r\n      parameters: [\r\n        { name: 'planId', type: 'string', description: 'Insurance plan ID', required: true },\r\n        { name: 'bookingId', type: 'string', description: 'Related booking ID', required: false },\r\n        { name: 'checkIn', type: 'date', description: 'Trip start date', required: true },\r\n        { name: 'checkOut', type: 'date', description: 'Trip end date', required: true },\r\n        { name: 'travelers', type: 'number', description: 'Number of travelers', required: true },\r\n        { name: 'childrenUnder18', type: 'number', description: 'Children under 18 (free on family plan)', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/insurance.getInsuranceQuote',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'purchase_insurance',\r\n      description: 'Purchase travel insurance policy',\r\n      parameters: [\r\n        { name: 'quoteId', type: 'string', description: 'Quote ID', required: true },\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'customerId', type: 'string', description: 'Customer ID', required: true },\r\n        { name: 'customerName', type: 'string', description: 'Customer name', required: true },\r\n        { name: 'customerEmail', type: 'string', description: 'Customer email', required: true },\r\n        { name: 'travelers', type: 'array', description: 'Names of all travelers', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/insurance.purchaseInsurance',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'cancel_insurance',\r\n      description: 'Cancel insurance policy',\r\n      parameters: [\r\n        { name: 'policyId', type: 'string', description: 'Policy ID', required: true },\r\n        { name: 'reason', type: 'string', description: 'Cancellation reason', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/insurance.cancelInsurance',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'file_insurance_claim',\r\n      description: 'File an insurance claim',\r\n      parameters: [\r\n        { name: 'policyId', type: 'string', description: 'Policy ID', required: true },\r\n        { name: 'claimType', type: 'string', description: 'Type of claim', required: true },\r\n        { name: 'description', type: 'string', description: 'Claim description', required: true },\r\n        { name: 'amount', type: 'number', description: 'Claim amount', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/insurance.fileInsuranceClaim',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const abandonedCartSkill: AISkill = {\r\n  id: 'abandoned-cart',\r\n  name: 'Abandoned Cart Recovery',\r\n  nameHe: 'שחזור עגלות נטושות',\r\n  description: 'Track abandoned bookings and recover them with automated email campaigns and discounts.',\r\n  descriptionHe: 'מעקב אחר הזמנות נטושות ושחזורן באמצעות קמפיינים אוטומטיים ומבצעים.',\r\n  category: 'automation',\r\n  capabilities: ['cart-recovery', 'email-automation', 'analytics'],\r\n  isEnabled: true,\r\n  priority: 8,\r\n  requiredPermissions: ['booking:read', 'marketing:send'],\r\n  tools: [\r\n    {\r\n      name: 'track_cart_activity',\r\n      description: 'Track user activity in booking flow',\r\n      parameters: [\r\n        { name: 'sessionId', type: 'string', description: 'Session ID', required: true },\r\n        { name: 'stage', type: 'string', description: 'Booking stage: search, room_selected, prebook, checkout, payment', required: true },\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\r\n        { name: 'hotelName', type: 'string', description: 'Hotel name', required: true },\r\n        { name: 'totalPrice', type: 'number', description: 'Total price', required: true },\r\n        { name: 'currency', type: 'string', description: 'Currency', required: true },\r\n        { name: 'checkIn', type: 'date', description: 'Check-in date', required: true },\r\n        { name: 'checkOut', type: 'date', description: 'Check-out date', required: true },\r\n        { name: 'guests', type: 'number', description: 'Number of guests', required: true },\r\n        { name: 'customerEmail', type: 'string', description: 'Customer email', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/abandoned-cart.trackCartActivity',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_abandoned_carts',\r\n      description: 'Get list of abandoned carts for recovery',\r\n      parameters: [\r\n        { name: 'minAge', type: 'number', description: 'Minimum age in minutes', required: false },\r\n        { name: 'hasEmail', type: 'boolean', description: 'Only carts with email', required: false },\r\n        { name: 'limit', type: 'number', description: 'Max results', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/abandoned-cart.getAbandonedCarts',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'send_recovery_email',\r\n      description: 'Send cart recovery email',\r\n      parameters: [\r\n        { name: 'cartId', type: 'string', description: 'Cart ID', required: true },\r\n        { name: 'templateType', type: 'string', description: 'Template: initial, reminder, lastChance', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/abandoned-cart.sendRecoveryEmail',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_recovery_stats',\r\n      description: 'Get cart recovery statistics',\r\n      parameters: [\r\n        { name: 'startDate', type: 'date', description: 'Start date', required: false },\r\n        { name: 'endDate', type: 'date', description: 'End date', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/abandoned-cart.getRecoveryStats',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'run_recovery_campaign',\r\n      description: 'Run automated recovery campaign',\r\n      parameters: [\r\n        { name: 'dryRun', type: 'boolean', description: 'Preview without sending', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/abandoned-cart.runRecoveryCampaign',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const whatsappBotSkill: AISkill = {\r\n  id: 'whatsapp-bot',\r\n  name: 'WhatsApp Bot',\r\n  nameHe: 'בוט וואטסאפ',\r\n  description: 'Send booking notifications and handle customer support via WhatsApp Business API.',\r\n  descriptionHe: 'שליחת התראות הזמנה ותמיכת לקוחות דרך WhatsApp Business API.',\r\n  category: 'communication',\r\n  capabilities: ['whatsapp', 'notifications', 'support'],\r\n  isEnabled: true,\r\n  priority: 9,\r\n  requiredPermissions: ['booking:read', 'whatsapp:send'],\r\n  tools: [\r\n    {\r\n      name: 'send_whatsapp_message',\r\n      description: 'Send a WhatsApp message',\r\n      parameters: [\r\n        { name: 'to', type: 'string', description: 'Phone number', required: true },\r\n        { name: 'type', type: 'string', description: 'Message type: text, template, interactive', required: true },\r\n        { name: 'content', type: 'string', description: 'Message content', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/whatsapp.sendWhatsAppMessage',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'send_booking_confirmation_whatsapp',\r\n      description: 'Send booking confirmation via WhatsApp',\r\n      parameters: [\r\n        { name: 'phone', type: 'string', description: 'Phone number', required: true },\r\n        { name: 'customerName', type: 'string', description: 'Customer name', required: true },\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'hotelName', type: 'string', description: 'Hotel name', required: true },\r\n        { name: 'checkIn', type: 'date', description: 'Check-in date', required: true },\r\n        { name: 'checkOut', type: 'date', description: 'Check-out date', required: true },\r\n        { name: 'confirmationNumber', type: 'string', description: 'Confirmation number', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/whatsapp.sendBookingConfirmation',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'send_checkin_reminder_whatsapp',\r\n      description: 'Send check-in reminder via WhatsApp',\r\n      parameters: [\r\n        { name: 'phone', type: 'string', description: 'Phone number', required: true },\r\n        { name: 'customerName', type: 'string', description: 'Customer name', required: true },\r\n        { name: 'hotelName', type: 'string', description: 'Hotel name', required: true },\r\n        { name: 'hotelAddress', type: 'string', description: 'Hotel address', required: true },\r\n        { name: 'checkIn', type: 'date', description: 'Check-in date', required: true },\r\n        { name: 'confirmationNumber', type: 'string', description: 'Confirmation number', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/whatsapp.sendCheckInReminder',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'handle_whatsapp_message',\r\n      description: 'Handle incoming WhatsApp message',\r\n      parameters: [\r\n        { name: 'from', type: 'string', description: 'Sender phone', required: true },\r\n        { name: 'messageId', type: 'string', description: 'Message ID', required: true },\r\n        { name: 'type', type: 'string', description: 'Message type', required: true },\r\n        { name: 'text', type: 'string', description: 'Message text', required: false },\r\n        { name: 'buttonId', type: 'string', description: 'Button ID if clicked', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/whatsapp.handleIncomingMessage',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_whatsapp_stats',\r\n      description: 'Get WhatsApp analytics',\r\n      parameters: [\r\n        { name: 'startDate', type: 'date', description: 'Start date', required: false },\r\n        { name: 'endDate', type: 'date', description: 'End date', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/whatsapp.getWhatsAppStats',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const reviewsSkill: AISkill = {\r\n  id: 'reviews-management',\r\n  name: 'Reviews & Ratings',\r\n  nameHe: 'ביקורות ודירוגים',\r\n  description: 'Collect, manage, and analyze guest reviews with automated requests and AI summaries.',\r\n  descriptionHe: 'איסוף, ניהול וניתוח ביקורות אורחים עם בקשות אוטומטיות וסיכומי AI.',\r\n  category: 'analysis',\r\n  capabilities: ['reviews', 'ratings', 'feedback'],\r\n  isEnabled: true,\r\n  priority: 10,\r\n  requiredPermissions: ['booking:read', 'reviews:manage'],\r\n  tools: [\r\n    {\r\n      name: 'request_review',\r\n      description: 'Request review from guest after checkout',\r\n      parameters: [\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\r\n        { name: 'customerId', type: 'string', description: 'Customer ID', required: true },\r\n        { name: 'customerEmail', type: 'string', description: 'Customer email', required: true },\r\n        { name: 'customerName', type: 'string', description: 'Customer name', required: true },\r\n        { name: 'checkOutDate', type: 'date', description: 'Check-out date', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/reviews.requestReview',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'submit_review',\r\n      description: 'Submit a guest review',\r\n      parameters: [\r\n        { name: 'bookingId', type: 'string', description: 'Booking ID', required: true },\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\r\n        { name: 'overallRating', type: 'number', description: 'Overall rating 1-5', required: true },\r\n        { name: 'ratings', type: 'object', description: 'Category ratings', required: true },\r\n        { name: 'title', type: 'string', description: 'Review title', required: true },\r\n        { name: 'content', type: 'string', description: 'Review content', required: true },\r\n        { name: 'tripType', type: 'string', description: 'Trip type', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/reviews.submitReview',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_hotel_reviews',\r\n      description: 'Get reviews for a hotel',\r\n      parameters: [\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true },\r\n        { name: 'minRating', type: 'number', description: 'Minimum rating filter', required: false },\r\n        { name: 'sortBy', type: 'string', description: 'Sort: recent, rating, helpful', required: false },\r\n        { name: 'limit', type: 'number', description: 'Max results', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/reviews.getHotelReviews',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'respond_to_review',\r\n      description: 'Post hotel response to a review',\r\n      parameters: [\r\n        { name: 'reviewId', type: 'string', description: 'Review ID', required: true },\r\n        { name: 'responderId', type: 'string', description: 'Responder ID', required: true },\r\n        { name: 'responderName', type: 'string', description: 'Responder name', required: true },\r\n        { name: 'content', type: 'string', description: 'Response content', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/reviews.respondToReview',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'generate_review_summary',\r\n      description: 'Generate AI summary of hotel reviews',\r\n      parameters: [\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: true }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/reviews.generateReviewSummary',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'moderate_review',\r\n      description: 'Approve, reject, or flag a review',\r\n      parameters: [\r\n        { name: 'reviewId', type: 'string', description: 'Review ID', required: true },\r\n        { name: 'action', type: 'string', description: 'Action: approve, reject, flag', required: true },\r\n        { name: 'reason', type: 'string', description: 'Reason for action', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/reviews.moderateReview',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\n// Revenue Dashboard Skill\r\nexport const revenueDashboardSkill: AISkill = {\r\n  id: 'revenue-dashboard',\r\n  name: 'Revenue Dashboard',\r\n  nameHe: 'דוח הכנסות',\r\n  description: 'Financial reporting, revenue analytics, and KPI tracking for hotel operations.',\r\n  descriptionHe: 'דוחות פיננסיים, אנליטיקת הכנסות ומעקב KPI לפעילות המלון.',\r\n  category: 'analysis',\r\n  capabilities: ['reporting', 'analytics', 'revenue'],\r\n  isEnabled: true,\r\n  priority: 8,\r\n  requiredPermissions: ['analytics:read', 'finance:read'],\r\n  tools: [\r\n    {\r\n      name: 'get_revenue_summary',\r\n      description: 'Get revenue summary with totals, comparisons and trends',\r\n      parameters: [\r\n        { name: 'period', type: 'string', description: 'Period: day, week, month, quarter, year', required: false },\r\n        { name: 'startDate', type: 'date', description: 'Start date', required: false },\r\n        { name: 'endDate', type: 'date', description: 'End date', required: false },\r\n        { name: 'compareWithPrevious', type: 'boolean', description: 'Compare with previous period', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/revenue-dashboard.getRevenueSummary',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_revenue_breakdown',\r\n      description: 'Get revenue breakdown by source, hotel, room type, or channel',\r\n      parameters: [\r\n        { name: 'breakdownBy', type: 'string', description: 'Breakdown: source, hotel, room_type, channel', required: false },\r\n        { name: 'period', type: 'string', description: 'Period: day, week, month, quarter, year', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/revenue-dashboard.getRevenueBreakdown',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_kpi_dashboard',\r\n      description: 'Get KPI dashboard with all key performance indicators',\r\n      parameters: [\r\n        { name: 'period', type: 'string', description: 'Period: day, week, month, quarter, year', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/revenue-dashboard.getKPIDashboard',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'generate_revenue_report',\r\n      description: 'Generate comprehensive revenue report in various formats',\r\n      parameters: [\r\n        { name: 'reportType', type: 'string', description: 'Report type: summary, detailed, executive', required: false },\r\n        { name: 'period', type: 'string', description: 'Period: day, week, month, quarter, year', required: false },\r\n        { name: 'format', type: 'string', description: 'Format: json, html, pdf', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/revenue-dashboard.generateRevenueReport',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\n// Demand Forecasting Skill\r\nexport const demandForecastingSkill: AISkill = {\r\n  id: 'demand-forecasting',\r\n  name: 'Demand Forecasting',\r\n  nameHe: 'חיזוי ביקוש',\r\n  description: 'AI-powered demand prediction, pricing recommendations, and capacity planning.',\r\n  descriptionHe: 'חיזוי ביקוש מבוסס AI, המלצות תמחור ותכנון קיבולת.',\r\n  category: 'analysis',\r\n  capabilities: ['forecasting', 'pricing', 'analytics'],\r\n  isEnabled: true,\r\n  priority: 9,\r\n  requiredPermissions: ['analytics:read', 'pricing:write'],\r\n  tools: [\r\n    {\r\n      name: 'get_demand_forecast',\r\n      description: 'Get demand forecast for upcoming period with confidence scores',\r\n      parameters: [\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: false },\r\n        { name: 'startDate', type: 'date', description: 'Start date', required: false },\r\n        { name: 'days', type: 'number', description: 'Number of days to forecast', required: false },\r\n        { name: 'roomType', type: 'string', description: 'Room type filter', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/demand-forecasting.getDemandForecast',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'get_pricing_recommendations',\r\n      description: 'Get dynamic pricing recommendations based on demand forecast',\r\n      parameters: [\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: false },\r\n        { name: 'date', type: 'date', description: 'Target date', required: false },\r\n        { name: 'roomTypes', type: 'array', description: 'Room types to price', required: false },\r\n        { name: 'competitorPrices', type: 'object', description: 'Competitor prices for comparison', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/demand-forecasting.getPricingRecommendations',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'analyze_seasonality',\r\n      description: 'Analyze seasonal patterns and upcoming events impact',\r\n      parameters: [\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: false },\r\n        { name: 'year', type: 'number', description: 'Year to analyze', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/demand-forecasting.analyzeSeasonality',\r\n      isAsync: true\r\n    },\r\n    {\r\n      name: 'detect_demand_anomalies',\r\n      description: 'Detect unusual demand patterns and anomalies',\r\n      parameters: [\r\n        { name: 'hotelId', type: 'string', description: 'Hotel ID', required: false },\r\n        { name: 'period', type: 'string', description: 'Period to analyze', required: false },\r\n        { name: 'threshold', type: 'number', description: 'Deviation threshold (%)', required: false }\r\n      ],\r\n      handler: 'lib/ai-engines/handlers/demand-forecasting.detectDemandAnomalies',\r\n      isAsync: true\r\n    }\r\n  ]\r\n};\r\n\r\nexport const allSkills: AISkill[] = [\r\n  // Booking\r\n  hotelSearchSkill,\r\n  hotelPrebookSkill,\r\n  hotelBookingSkill,\r\n  bookingCancellationSkill,\r\n  // Phase 1 Critical Skills\r\n  paymentProcessingSkill,\r\n  refundProcessingSkill,\r\n  invoiceGenerationSkill,\r\n  fraudDetectionSkill,\r\n  // Price Monitoring\r\n  priceMonitoringSkill,\r\n  // Communication\r\n  voiceInteractionSkill,\r\n  smsIntegrationSkill,\r\n  emailIntegrationSkill,\r\n  // Research & Analysis\r\n  webSearchSkill,\r\n  knowledgeBaseSkill,\r\n  marketAnalysisSkill,\r\n  // Personalization\r\n  userPreferencesSkill,\r\n  loyaltyProgramSkill,\r\n  // NEW V2 Skills\r\n  promoCodeSkill,\r\n  smartDateSuggestionSkill,\r\n  roomComparisonSkill,\r\n  bundleDealsSkill,\r\n  waitlistSkill,\r\n  groupBookingSkill,\r\n  affiliateSkill,\r\n  // NEW V3 Skills - Advanced Intelligence\r\n  destinationInfoSkill,\r\n  customerMemorySkill,\r\n  priceComparisonSkill,\r\n  travelBundleSkill,\r\n  calendarSyncSkill,\r\n  // Phase 2 Skills\r\n  travelInsuranceSkill,\r\n  abandonedCartSkill,\r\n  whatsappBotSkill,\r\n  reviewsSkill,\r\n  // Phase 3 Skills - Analytics & Forecasting\r\n  revenueDashboardSkill,\r\n  demandForecastingSkill\r\n];\r\n\r\nexport const getSkillById = (id: string): AISkill | undefined => {\r\n  return allSkills.find(skill => skill.id === id);\r\n};\r\n\r\nexport const getSkillsByCategory = (category: string): AISkill[] => {\r\n  return allSkills.filter(skill => skill.category === category);\r\n};\r\n\r\nexport const getEnabledSkills = (): AISkill[] => {\r\n  return allSkills.filter(skill => skill.isEnabled);\r\n};\r\n","/**\r\n * AI Engine Templates\r\n * Pre-configured engine templates for different booking scenarios\r\n */\r\n\r\nimport type { AIEngineTemplate, AIEngineType } from './types';\r\nimport {\r\n  hotelSearchSkill,\r\n  hotelPrebookSkill,\r\n  hotelBookingSkill,\r\n  bookingCancellationSkill,\r\n  priceMonitoringSkill,\r\n  voiceInteractionSkill,\r\n  smsIntegrationSkill,\r\n  emailIntegrationSkill,\r\n  webSearchSkill,\r\n  knowledgeBaseSkill,\r\n  marketAnalysisSkill,\r\n  userPreferencesSkill,\r\n  loyaltyProgramSkill\r\n} from './skills';\r\n\r\n// ========================================\r\n// HOTEL BOOKING ENGINE\r\n// Full-featured hotel booking agent\r\n// ========================================\r\n\r\nexport const hotelBookingEngineTemplate: AIEngineTemplate = {\r\n  id: 'hotel-booking-engine',\r\n  type: 'hotel-booking',\r\n  name: 'Hotel Booking Engine',\r\n  nameHe: 'מנוע הזמנות מלון',\r\n  description: 'Complete hotel booking agent with search, prebook, and booking capabilities',\r\n  descriptionHe: 'סוכן הזמנות מלון מלא עם יכולות חיפוש, הזמנה מוקדמת והזמנה',\r\n  version: '1.0.0',\r\n  skills: [hotelSearchSkill, hotelPrebookSkill, hotelBookingSkill, bookingCancellationSkill, emailIntegrationSkill],\r\n  capabilities: ['search', 'prebook', 'booking', 'cancellation', 'email-integration'],\r\n  modelConfig: {\r\n    provider: 'groq',\r\n    model: 'llama-3.3-70b-versatile',\r\n    temperature: 0.7,\r\n    maxTokens: 4096,\r\n    topP: 0.9\r\n  },\r\n  persona: {\r\n    name: 'Alex',\r\n    nameHe: 'אלכס',\r\n    role: 'Senior Booking Agent',\r\n    roleHe: 'סוכן הזמנות בכיר',\r\n    personality: ['professional', 'helpful', 'efficient', 'knowledgeable'],\r\n    communicationStyle: 'friendly-professional',\r\n    expertise: ['hotel bookings', 'travel planning', 'customer service', 'negotiation'],\r\n    languages: ['en', 'he', 'ar']\r\n  },\r\n  prompts: {\r\n    systemPrompt: `You are Alex, a senior hotel booking agent. Your role is to help customers find and book the perfect hotel accommodations.\r\n\r\nCORE RESPONSIBILITIES:\r\n1. Search for hotels based on customer requirements\r\n2. Present options clearly with pricing and key features\r\n3. Guide customers through the booking process\r\n4. Handle special requests and preferences\r\n5. Provide cancellation and modification assistance\r\n\r\nBOOKING FLOW:\r\n1. Gather requirements: destination, dates, guests, preferences\r\n2. Search for available hotels using search_hotels\r\n3. Present top 3-5 options with key details\r\n4. When customer selects, use prebook_room to confirm availability\r\n5. Collect customer details and complete booking with book_room\r\n6. Send confirmation email\r\n\r\nGUIDELINES:\r\n- Always confirm dates and guest count before searching\r\n- Present prices clearly in the customer's preferred currency\r\n- Highlight included amenities and cancellation policies\r\n- Be proactive about loyalty discounts and promotions\r\n- Escalate complex issues to human agents\r\n\r\nLANGUAGE: Respond in the same language the customer uses.`,\r\n    systemPromptHe: `אתה אלכס, סוכן הזמנות מלון בכיר. תפקידך לעזור ללקוחות למצוא ולהזמין את המלון המושלם.\r\n\r\nתחומי אחריות:\r\n1. חיפוש מלונות לפי דרישות הלקוח\r\n2. הצגת אפשרויות ברורה עם מחירים ותכונות\r\n3. ליווי לקוחות בתהליך ההזמנה\r\n4. טיפול בבקשות מיוחדות\r\n5. סיוע בביטולים ושינויים\r\n\r\nהנחיות:\r\n- תמיד אשר תאריכים ומספר אורחים לפני חיפוש\r\n- הצג מחירים בבירור\r\n- הדגש מדיניות ביטול\r\n- הציע הנחות נאמנות ומבצעים`,\r\n    greetingMessage: `Hello! I'm Alex, your booking assistant. How can I help you find the perfect hotel today?`,\r\n    greetingMessageHe: `שלום! אני אלכס, עוזר ההזמנות שלך. איך אוכל לעזור לך למצוא את המלון המושלם?`,\r\n    errorMessages: {\r\n      noResults: 'I couldn\\'t find any hotels matching your criteria. Would you like to adjust your dates or try a different destination?',\r\n      bookingFailed: 'There was an issue completing your booking. Let me try again or connect you with a specialist.',\r\n      timeout: 'The search is taking longer than expected. Please wait a moment.',\r\n      general: 'Something went wrong. Let me help you with that.'\r\n    }\r\n  },\r\n  config: {\r\n    maxConversationTurns: 50,\r\n    contextWindowSize: 20,\r\n    enableMemory: true,\r\n    enableLogging: true,\r\n    logLevel: 'info',\r\n    enableAnalytics: true,\r\n    responseTimeout: 30000,\r\n    autoSave: true\r\n  },\r\n  integrations: {\r\n    crm: {\r\n      enabled: true,\r\n      provider: 'supabase',\r\n      syncCustomers: true,\r\n      syncBookings: true\r\n    },\r\n    payment: {\r\n      enabled: true,\r\n      provider: 'stripe',\r\n      supportedMethods: ['card', 'apple_pay', 'google_pay']\r\n    },\r\n    analytics: {\r\n      enabled: true,\r\n      provider: 'custom',\r\n      trackConversations: true,\r\n      trackBookings: true\r\n    }\r\n  }\r\n};\r\n\r\n// ========================================\r\n// TRAVEL AGENT ENGINE\r\n// Full-service travel planning agent\r\n// ========================================\r\n\r\nexport const travelAgentEngineTemplate: AIEngineTemplate = {\r\n  id: 'travel-agent-engine',\r\n  type: 'travel-agent',\r\n  name: 'Travel Agent Engine',\r\n  nameHe: 'מנוע סוכן נסיעות',\r\n  description: 'Comprehensive travel planning with destination expertise and personalized recommendations',\r\n  descriptionHe: 'תכנון נסיעות מקיף עם מומחיות ביעדים והמלצות מותאמות אישית',\r\n  version: '1.0.0',\r\n  skills: [\r\n    hotelSearchSkill,\r\n    hotelPrebookSkill,\r\n    hotelBookingSkill,\r\n    webSearchSkill,\r\n    knowledgeBaseSkill,\r\n    userPreferencesSkill,\r\n    loyaltyProgramSkill,\r\n    emailIntegrationSkill\r\n  ],\r\n  capabilities: ['search', 'prebook', 'booking', 'web-search', 'rag-retrieval', 'analytics'],\r\n  modelConfig: {\r\n    provider: 'groq',\r\n    model: 'llama-3.3-70b-versatile',\r\n    temperature: 0.8,\r\n    maxTokens: 4096,\r\n    topP: 0.95\r\n  },\r\n  persona: {\r\n    name: 'Maya',\r\n    nameHe: 'מאיה',\r\n    role: 'Travel Expert',\r\n    roleHe: 'מומחית נסיעות',\r\n    personality: ['enthusiastic', 'knowledgeable', 'creative', 'adventurous'],\r\n    communicationStyle: 'warm-engaging',\r\n    expertise: ['destination planning', 'local experiences', 'cultural insights', 'travel tips'],\r\n    languages: ['en', 'he', 'es', 'fr']\r\n  },\r\n  prompts: {\r\n    systemPrompt: `You are Maya, an experienced travel expert with deep knowledge of destinations worldwide.\r\n\r\nYOUR MISSION:\r\nHelp travelers create unforgettable experiences by providing personalized recommendations, insider tips, and seamless booking assistance.\r\n\r\nEXPERTISE AREAS:\r\n- Destination knowledge: local customs, best seasons, hidden gems\r\n- Accommodation matching: finding the perfect hotel for each traveler\r\n- Experience planning: activities, restaurants, cultural events\r\n- Budget optimization: getting the most value for every trip\r\n\r\nCONVERSATION APPROACH:\r\n1. Understand the traveler's style (adventure, relaxation, culture, family)\r\n2. Learn about their preferences and past experiences\r\n3. Provide tailored destination recommendations\r\n4. Share insider tips and local knowledge\r\n5. Help book accommodations that match their style\r\n6. Create a personalized trip overview\r\n\r\nPERSONALITY:\r\n- Share personal travel stories when relevant\r\n- Be enthusiastic about destinations\r\n- Offer creative and unique suggestions\r\n- Consider sustainability and responsible travel\r\n\r\nRemember to use web search for current events, weather, and local happenings.`,\r\n    greetingMessage: `Hi there! I'm Maya, your travel expert. I absolutely love helping people discover amazing destinations. Whether you're dreaming of pristine beaches, mountain adventures, or vibrant city escapes - I'm here to make it happen! 🌍\r\n\r\nWhat kind of travel experience are you looking for?`,\r\n    greetingMessageHe: `היי! אני מאיה, מומחית הנסיעות שלך. אני פשוט אוהבת לעזור לאנשים לגלות יעדים מדהימים. בין אם אתה חולם על חופים, הרפתקאות בהרים או בריחה לעיר תוססת - אני כאן לגרום לזה לקרות! 🌍\r\n\r\nאיזה סוג חוויית טיול מעניין אותך?`\r\n  },\r\n  config: {\r\n    maxConversationTurns: 100,\r\n    contextWindowSize: 30,\r\n    enableMemory: true,\r\n    enableLogging: true,\r\n    logLevel: 'info',\r\n    enableAnalytics: true\r\n  }\r\n};\r\n\r\n// ========================================\r\n// CONCIERGE ENGINE\r\n// Hotel concierge for in-stay assistance\r\n// ========================================\r\n\r\nexport const conciergeEngineTemplate: AIEngineTemplate = {\r\n  id: 'concierge-engine',\r\n  type: 'concierge',\r\n  name: 'Hotel Concierge Engine',\r\n  nameHe: 'מנוע קונסיירז\\'',\r\n  description: 'In-stay hotel concierge for guest services and local recommendations',\r\n  descriptionHe: 'קונסיירז\\' מלון לשירותי אורחים והמלצות מקומיות',\r\n  version: '1.0.0',\r\n  skills: [webSearchSkill, knowledgeBaseSkill, smsIntegrationSkill, userPreferencesSkill],\r\n  capabilities: ['web-search', 'rag-retrieval', 'sms-integration'],\r\n  modelConfig: {\r\n    provider: 'groq',\r\n    model: 'llama-3.3-70b-versatile',\r\n    temperature: 0.6,\r\n    maxTokens: 2048\r\n  },\r\n  persona: {\r\n    name: 'James',\r\n    nameHe: 'ג\\'יימס',\r\n    role: 'Head Concierge',\r\n    roleHe: 'ראש הקונסיירז\\'',\r\n    personality: ['sophisticated', 'attentive', 'resourceful', 'discrete'],\r\n    communicationStyle: 'formal-elegant',\r\n    expertise: ['local dining', 'entertainment', 'transportation', 'special requests'],\r\n    languages: ['en', 'he', 'fr', 'it', 'de']\r\n  },\r\n  prompts: {\r\n    systemPrompt: `You are James, the head concierge at a luxury hotel. You provide impeccable service and have extensive local knowledge.\r\n\r\nSERVICES YOU PROVIDE:\r\n- Restaurant reservations and recommendations\r\n- Transportation arrangements\r\n- Entertainment and event tickets\r\n- Local tours and experiences\r\n- Special occasion arrangements\r\n- Room service coordination\r\n- Guest requests and amenities\r\n\r\nSTANDARDS:\r\n- Maintain the highest level of professionalism\r\n- Anticipate guest needs before they ask\r\n- Know the best local establishments personally\r\n- Handle all requests with discretion\r\n- Provide multiple options when possible\r\n\r\nCOMMUNICATION STYLE:\r\n- Formal yet warm\r\n- Never say \"no\" - always offer alternatives\r\n- Confirm all arrangements in detail\r\n- Follow up on guest satisfaction`,\r\n    greetingMessage: `Good day. I'm James, your concierge. It's my pleasure to assist you during your stay. How may I be of service?`,\r\n    greetingMessageHe: `יום טוב. אני ג'יימס, הקונסיירז' שלך. זה לשמחתי לסייע לך במהלך השהייה. במה אוכל לעזור?`\r\n  }\r\n};\r\n\r\n// ========================================\r\n// VOICE AGENT ENGINE\r\n// Voice-enabled booking agent\r\n// ========================================\r\n\r\nexport const voiceAgentEngineTemplate: AIEngineTemplate = {\r\n  id: 'voice-agent-engine',\r\n  type: 'voice-agent',\r\n  name: 'Voice Booking Agent',\r\n  nameHe: 'סוכן הזמנות קולי',\r\n  description: 'Voice-enabled agent for phone-based hotel bookings',\r\n  descriptionHe: 'סוכן קולי להזמנות מלון טלפוניות',\r\n  version: '1.0.0',\r\n  skills: [hotelSearchSkill, hotelPrebookSkill, hotelBookingSkill, voiceInteractionSkill, smsIntegrationSkill],\r\n  capabilities: ['search', 'prebook', 'booking', 'voice-interaction', 'sms-integration'],\r\n  modelConfig: {\r\n    provider: 'openai',\r\n    model: 'gpt-4o-realtime',\r\n    temperature: 0.7,\r\n    maxTokens: 1024\r\n  },\r\n  persona: {\r\n    name: 'Sam',\r\n    nameHe: 'סם',\r\n    role: 'Voice Booking Specialist',\r\n    roleHe: 'מומחה הזמנות קולי',\r\n    personality: ['clear', 'patient', 'efficient', 'friendly'],\r\n    communicationStyle: 'conversational-clear',\r\n    expertise: ['phone bookings', 'audio clarity', 'efficient communication'],\r\n    languages: ['en', 'he']\r\n  },\r\n  prompts: {\r\n    systemPrompt: `You are Sam, a voice booking specialist. You handle phone calls for hotel reservations.\r\n\r\nVOICE INTERACTION GUIDELINES:\r\n1. Speak clearly and at a moderate pace\r\n2. Confirm information by repeating back key details\r\n3. Use phonetic spelling for names and confirmation numbers\r\n4. Break down complex information into digestible parts\r\n5. Allow pauses for customer responses\r\n\r\nCALL FLOW:\r\n1. Greet warmly and identify yourself\r\n2. Determine if new booking, modification, or cancellation\r\n3. Gather requirements step by step\r\n4. Confirm all details before proceeding\r\n5. Provide confirmation number clearly\r\n6. Offer to send SMS summary\r\n\r\nAUDIO CONSIDERATIONS:\r\n- Keep sentences short\r\n- Avoid jargon\r\n- Spell out important codes: \"That's B as in Bravo, O as in Oscar...\"\r\n- Always confirm numbers: \"That's 972-50-1234567, correct?\"\r\n\r\nEnd calls with clear next steps and gratitude.`,\r\n    greetingMessage: `Thank you for calling! This is Sam, your booking assistant. How can I help you today?`,\r\n    greetingMessageHe: `תודה שהתקשרת! כאן סם, עוזר ההזמנות שלך. איך אוכל לעזור לך היום?`\r\n  },\r\n  voice: {\r\n    enabled: true,\r\n    provider: 'azure',\r\n    sttLanguage: 'he-IL',\r\n    ttsVoice: 'he-IL-HilaNeural',\r\n    interimResults: true,\r\n    vadSensitivity: 0.5,\r\n    silenceTimeout: 2000\r\n  }\r\n};\r\n\r\n// ========================================\r\n// PRICE MONITOR ENGINE\r\n// Automated price tracking agent\r\n// ========================================\r\n\r\nexport const priceMonitorEngineTemplate: AIEngineTemplate = {\r\n  id: 'price-monitor-engine',\r\n  type: 'price-monitor',\r\n  name: 'Price Monitor Engine',\r\n  nameHe: 'מנוע מעקב מחירים',\r\n  description: 'Automated price monitoring with alerts and trend analysis',\r\n  descriptionHe: 'מעקב מחירים אוטומטי עם התראות וניתוח מגמות',\r\n  version: '1.0.0',\r\n  skills: [priceMonitoringSkill, marketAnalysisSkill, emailIntegrationSkill, smsIntegrationSkill],\r\n  capabilities: ['price-monitoring', 'analytics', 'email-integration', 'sms-integration'],\r\n  modelConfig: {\r\n    provider: 'groq',\r\n    model: 'llama-3.1-8b-instant',\r\n    temperature: 0.3,\r\n    maxTokens: 2048\r\n  },\r\n  persona: {\r\n    name: 'Atlas',\r\n    nameHe: 'אטלס',\r\n    role: 'Price Analyst',\r\n    roleHe: 'אנליסט מחירים',\r\n    personality: ['analytical', 'precise', 'data-driven', 'proactive'],\r\n    communicationStyle: 'informative-concise',\r\n    expertise: ['price analysis', 'market trends', 'deal detection', 'timing optimization']\r\n  },\r\n  prompts: {\r\n    systemPrompt: `You are Atlas, a price monitoring specialist. You track hotel prices and help users book at the best time.\r\n\r\nCAPABILITIES:\r\n1. Track prices for specific hotels and dates\r\n2. Analyze historical pricing patterns\r\n3. Predict optimal booking windows\r\n4. Alert users to significant price drops\r\n5. Compare prices across multiple properties\r\n\r\nDATA-DRIVEN INSIGHTS:\r\n- Present data clearly with percentages and comparisons\r\n- Identify patterns: weekday vs weekend, seasonal trends\r\n- Factor in events that affect pricing\r\n- Consider cancellation policy value in pricing\r\n\r\nALERTS:\r\n- Immediate alert for drops > 15%\r\n- Daily summary for tracked hotels\r\n- Weekly trend reports\r\n- Expiring deal notifications\r\n\r\nBe concise and factual. Present numbers clearly.`,\r\n    greetingMessage: `Hello! I'm Atlas, your price monitoring assistant. I can help you track hotel prices and find the best deals. What would you like to monitor?`,\r\n    greetingMessageHe: `שלום! אני אטלס, עוזר מעקב המחירים שלך. אני יכול לעזור לך לעקוב אחר מחירי מלונות ולמצוא את העסקאות הטובות ביותר. מה תרצה לעקוב?`\r\n  }\r\n};\r\n\r\n// ========================================\r\n// SUPPORT AGENT ENGINE\r\n// Customer support and issue resolution\r\n// ========================================\r\n\r\nexport const supportAgentEngineTemplate: AIEngineTemplate = {\r\n  id: 'support-agent-engine',\r\n  type: 'support-agent',\r\n  name: 'Customer Support Engine',\r\n  nameHe: 'מנוע תמיכת לקוחות',\r\n  description: 'Customer support agent for booking issues, complaints, and inquiries',\r\n  descriptionHe: 'סוכן תמיכת לקוחות לבעיות הזמנה, תלונות ובירורים',\r\n  version: '1.0.0',\r\n  skills: [bookingCancellationSkill, knowledgeBaseSkill, emailIntegrationSkill, smsIntegrationSkill],\r\n  capabilities: ['cancellation', 'rag-retrieval', 'email-integration', 'sms-integration'],\r\n  modelConfig: {\r\n    provider: 'groq',\r\n    model: 'llama-3.3-70b-versatile',\r\n    temperature: 0.5,\r\n    maxTokens: 2048\r\n  },\r\n  persona: {\r\n    name: 'Sophie',\r\n    nameHe: 'סופי',\r\n    role: 'Customer Support Specialist',\r\n    roleHe: 'מומחית תמיכת לקוחות',\r\n    personality: ['empathetic', 'patient', 'solution-oriented', 'calm'],\r\n    communicationStyle: 'understanding-helpful',\r\n    expertise: ['issue resolution', 'policy expertise', 'de-escalation', 'customer advocacy'],\r\n    languages: ['en', 'he', 'ar', 'ru']\r\n  },\r\n  prompts: {\r\n    systemPrompt: `You are Sophie, a customer support specialist. You handle booking issues with empathy and efficiency.\r\n\r\nISSUE HANDLING PRIORITIES:\r\n1. Acknowledge the customer's concern immediately\r\n2. Apologize sincerely when appropriate\r\n3. Take ownership of the issue\r\n4. Find the best possible solution\r\n5. Follow up to ensure satisfaction\r\n\r\nCOMMON ISSUES:\r\n- Booking modifications and cancellations\r\n- Refund requests and processing\r\n- Complaint resolution\r\n- Policy clarification\r\n- Escalation to hotel/management\r\n\r\nCOMMUNICATION APPROACH:\r\n- Always validate the customer's feelings\r\n- Never be defensive\r\n- Offer solutions, not excuses\r\n- Be transparent about limitations\r\n- Under-promise and over-deliver\r\n\r\nESCALATION CRITERIA:\r\n- Unresolved after 3 attempts\r\n- Customer explicitly requests supervisor\r\n- Legal/safety concerns\r\n- High-value customer at risk\r\n\r\nDocument all issues and resolutions carefully.`,\r\n    greetingMessage: `Hello, I'm Sophie from customer support. I'm here to help you with any concerns about your booking. What can I assist you with today?`,\r\n    greetingMessageHe: `שלום, אני סופי מתמיכת הלקוחות. אני כאן לעזור לך עם כל שאלה או בעיה בנוגע להזמנה שלך. במה אוכל לסייע?`\r\n  },\r\n  handoff: {\r\n    enableHandoff: true,\r\n    handoffTriggers: ['speak to human', 'supervisor', 'manager', 'escalate', 'דבר עם אדם', 'מנהל'],\r\n    targetEngines: ['voice-agent-engine'],\r\n    handoffMessage: 'I\\'ll connect you with a specialist who can help further. Please hold.',\r\n    handoffMessageHe: 'אחבר אותך למומחה שיוכל לעזור יותר. אנא המתן.'\r\n  }\r\n};\r\n\r\n// ========================================\r\n// GROUP BOOKING ENGINE\r\n// Corporate and group bookings\r\n// ========================================\r\n\r\nexport const groupBookingEngineTemplate: AIEngineTemplate = {\r\n  id: 'group-booking-engine',\r\n  type: 'group-booking',\r\n  name: 'Group Booking Engine',\r\n  nameHe: 'מנוע הזמנות קבוצתיות',\r\n  description: 'Specialized agent for corporate and group hotel bookings',\r\n  descriptionHe: 'סוכן מתמחה בהזמנות מלון לחברות וקבוצות',\r\n  version: '1.0.0',\r\n  skills: [hotelSearchSkill, hotelPrebookSkill, hotelBookingSkill, marketAnalysisSkill, emailIntegrationSkill],\r\n  capabilities: ['search', 'prebook', 'booking', 'analytics', 'email-integration'],\r\n  modelConfig: {\r\n    provider: 'groq',\r\n    model: 'llama-3.3-70b-versatile',\r\n    temperature: 0.6,\r\n    maxTokens: 4096\r\n  },\r\n  persona: {\r\n    name: 'David',\r\n    nameHe: 'דוד',\r\n    role: 'Corporate Sales Manager',\r\n    roleHe: 'מנהל מכירות לעסקים',\r\n    personality: ['professional', 'negotiator', 'strategic', 'relationship-focused'],\r\n    communicationStyle: 'business-professional',\r\n    expertise: ['corporate travel', 'group rates', 'contract negotiation', 'event planning'],\r\n    languages: ['en', 'he']\r\n  },\r\n  prompts: {\r\n    systemPrompt: `You are David, a corporate sales manager specializing in group and business travel.\r\n\r\nGROUP BOOKING EXPERTISE:\r\n1. Conference and event accommodations\r\n2. Corporate rate negotiations\r\n3. Multiple room blocks\r\n4. Meeting room requirements\r\n5. Group amenities and services\r\n\r\nDISCOVERY PROCESS:\r\n- Company/Organization name\r\n- Event type and purpose\r\n- Number of rooms needed\r\n- Date flexibility\r\n- Budget constraints\r\n- Meeting room requirements\r\n- Special requests (dietary, accessibility)\r\n\r\nNEGOTIATION POINTS:\r\n- Volume discounts (typically 10+ rooms)\r\n- Complimentary upgrades\r\n- Meeting room rates\r\n- Breakfast inclusions\r\n- Cancellation flexibility\r\n- Payment terms\r\n\r\nProvide itemized quotes and comparison options.`,\r\n    greetingMessage: `Hello, I'm David from our corporate booking team. I specialize in group and business travel arrangements. Whether you're planning a conference, corporate retreat, or team event, I'm here to find the perfect solution. What brings you to us today?`,\r\n    greetingMessageHe: `שלום, אני דוד מצוות ההזמנות לעסקים. אני מתמחה בהזמנות קבוצתיות ונסיעות עסקים. בין אם אתה מתכנן כנס, יום גיבוש או אירוע צוות - אני כאן למצוא את הפתרון המושלם. מה מביא אותך אלינו?`\r\n  }\r\n};\r\n\r\n// ========================================\r\n// MULTI-AGENT ORCHESTRATOR\r\n// Coordinates between multiple specialized agents\r\n// ========================================\r\n\r\nexport const orchestratorEngineTemplate: AIEngineTemplate = {\r\n  id: 'orchestrator-engine',\r\n  type: 'multi-agent',\r\n  name: 'Multi-Agent Orchestrator',\r\n  nameHe: 'מתזמר רב-סוכנים',\r\n  description: 'Orchestrates conversations across multiple specialized agents',\r\n  descriptionHe: 'מתזמר שיחות בין סוכנים מתמחים שונים',\r\n  version: '1.0.0',\r\n  skills: [knowledgeBaseSkill],\r\n  capabilities: ['multi-agent', 'rag-retrieval'],\r\n  modelConfig: {\r\n    provider: 'groq',\r\n    model: 'llama-3.3-70b-versatile',\r\n    temperature: 0.3,\r\n    maxTokens: 1024\r\n  },\r\n  persona: {\r\n    name: 'Nexus',\r\n    nameHe: 'נקסוס',\r\n    role: 'Conversation Director',\r\n    roleHe: 'מנהל שיחות',\r\n    personality: ['efficient', 'organized', 'adaptive'],\r\n    communicationStyle: 'adaptive'\r\n  },\r\n  prompts: {\r\n    systemPrompt: `You are Nexus, the conversation orchestrator. Your role is to analyze user requests and route them to the appropriate specialist agent.\r\n\r\nAVAILABLE AGENTS:\r\n1. Alex (hotel-booking) - New bookings and reservations\r\n2. Maya (travel-agent) - Travel planning and recommendations\r\n3. James (concierge) - In-stay services and local recommendations\r\n4. Sam (voice-agent) - Phone-based interactions\r\n5. Atlas (price-monitor) - Price tracking and deal alerts\r\n6. Sophie (support-agent) - Issues and complaints\r\n7. David (group-booking) - Corporate and group bookings\r\n\r\nROUTING LOGIC:\r\n- Analyze the user's intent\r\n- Select the most appropriate agent\r\n- Provide context to the receiving agent\r\n- Monitor for handoff needs during conversation\r\n\r\nHANDOFF TRIGGERS:\r\n- Topic change requiring different expertise\r\n- Explicit user request\r\n- Escalation from specialized agent\r\n- Multi-domain queries (coordinate agents)\r\n\r\nKeep the conversation seamless - users shouldn't feel the agent change unless necessary.`,\r\n    greetingMessage: `Welcome! I'm here to connect you with the right specialist. Are you looking to book a hotel, plan a trip, get help with an existing reservation, or something else?`,\r\n    greetingMessageHe: `ברוכים הבאים! אני כאן לחבר אותך למומחה הנכון. האם אתה מחפש להזמין מלון, לתכנן טיול, לקבל עזרה עם הזמנה קיימת, או משהו אחר?`\r\n  },\r\n  handoff: {\r\n    enableHandoff: true,\r\n    handoffTriggers: ['new booking', 'plan trip', 'existing booking', 'issue', 'group', 'price alert'],\r\n    targetEngines: [\r\n      'hotel-booking-engine',\r\n      'travel-agent-engine',\r\n      'concierge-engine',\r\n      'support-agent-engine',\r\n      'group-booking-engine',\r\n      'price-monitor-engine'\r\n    ]\r\n  }\r\n};\r\n\r\n// ========================================\r\n// EXPORT ALL TEMPLATES\r\n// ========================================\r\n\r\nexport const allTemplates: AIEngineTemplate[] = [\r\n  hotelBookingEngineTemplate,\r\n  travelAgentEngineTemplate,\r\n  conciergeEngineTemplate,\r\n  voiceAgentEngineTemplate,\r\n  priceMonitorEngineTemplate,\r\n  supportAgentEngineTemplate,\r\n  groupBookingEngineTemplate,\r\n  orchestratorEngineTemplate\r\n];\r\n\r\nexport const getTemplateById = (id: string): AIEngineTemplate | undefined => {\r\n  return allTemplates.find(template => template.id === id);\r\n};\r\n\r\nexport const getTemplateByType = (type: AIEngineType): AIEngineTemplate | undefined => {\r\n  return allTemplates.find(template => template.type === type);\r\n};\r\n\r\nexport const getTemplatesByCapability = (capability: string): AIEngineTemplate[] => {\r\n  return allTemplates.filter(template =>\r\n    template.capabilities.includes(capability as any)\r\n  );\r\n};\r\n\r\nexport const getAllTemplateTypes = (): AIEngineType[] => {\r\n  return allTemplates.map(template => template.type);\r\n};\r\n","/**\r\n * AI Engine Manager\r\n * Core orchestration layer for AI booking engines\r\n */\r\n\r\nimport type {\r\n  AIEngineType,\r\n  AIEngineTemplate,\r\n  AIEngineInstance,\r\n  ConversationContext,\r\n  AISkill,\r\n  AITool,\r\n  HandoffConfig\r\n} from './types';\r\nimport { allTemplates, getTemplateById, getTemplateByType } from './templates';\r\nimport { allSkills, getSkillById } from './skills';\r\n\r\n// ========================================\r\n// ENGINE INSTANCE MANAGEMENT\r\n// ========================================\r\n\r\nexport class AIEngineManager {\r\n  private engines: Map<string, AIEngineInstance> = new Map();\r\n  private activeConversations: Map<string, ConversationContext> = new Map();\r\n  private toolHandlers: Map<string, Function> = new Map();\r\n\r\n  constructor() {\r\n    this.initializeDefaultEngines();\r\n  }\r\n\r\n  /**\r\n   * Initialize default engine instances from templates\r\n   */\r\n  private initializeDefaultEngines(): void {\r\n    allTemplates.forEach(template => {\r\n      const instance = this.createEngineInstance(template);\r\n      this.engines.set(instance.instanceId, instance);\r\n    });\r\n    console.log(`[AIEngineManager] Initialized ${this.engines.size} engine instances`);\r\n  }\r\n\r\n  /**\r\n   * Create an engine instance from a template\r\n   */\r\n  createEngineInstance(template: AIEngineTemplate, customConfig?: Partial<AIEngineTemplate>): AIEngineInstance {\r\n    const mergedTemplate = { ...template, ...customConfig };\r\n    \r\n    // Collect all tools from skills\r\n    const tools: AITool[] = [];\r\n    mergedTemplate.skills.forEach(skill => {\r\n      if (skill.isEnabled) {\r\n        tools.push(...skill.tools);\r\n      }\r\n    });\r\n\r\n    const instance: AIEngineInstance = {\r\n      instanceId: `${mergedTemplate.id}-${Date.now()}`,\r\n      template: mergedTemplate,\r\n      status: 'active',\r\n      createdAt: new Date(),\r\n      activeConversations: 0,\r\n      totalConversations: 0,\r\n      tools,\r\n      metadata: {\r\n        version: mergedTemplate.version,\r\n        templateId: mergedTemplate.id\r\n      }\r\n    };\r\n\r\n    return instance;\r\n  }\r\n\r\n  /**\r\n   * Get an engine instance by ID\r\n   */\r\n  getEngine(instanceId: string): AIEngineInstance | undefined {\r\n    return this.engines.get(instanceId);\r\n  }\r\n\r\n  /**\r\n   * Get all engine instances\r\n   */\r\n  getAllEngines(): AIEngineInstance[] {\r\n    return Array.from(this.engines.values());\r\n  }\r\n\r\n  /**\r\n   * Get engines by type\r\n   */\r\n  getEnginesByType(type: AIEngineType): AIEngineInstance[] {\r\n    return Array.from(this.engines.values()).filter(\r\n      engine => engine.template.type === type\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Get active engines\r\n   */\r\n  getActiveEngines(): AIEngineInstance[] {\r\n    return Array.from(this.engines.values()).filter(\r\n      engine => engine.status === 'active'\r\n    );\r\n  }\r\n\r\n  // ========================================\r\n  // CONVERSATION MANAGEMENT\r\n  // ========================================\r\n\r\n  /**\r\n   * Start a new conversation with an engine\r\n   */\r\n  startConversation(\r\n    engineInstanceId: string,\r\n    userId?: string,\r\n    sessionId?: string,\r\n    initialContext?: Record<string, any>\r\n  ): ConversationContext | null {\r\n    const engine = this.engines.get(engineInstanceId);\r\n    if (!engine) {\r\n      console.error(`[AIEngineManager] Engine not found: ${engineInstanceId}`);\r\n      return null;\r\n    }\r\n\r\n    const conversationId = `conv-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\r\n    \r\n    const context: ConversationContext = {\r\n      conversationId,\r\n      engineInstanceId,\r\n      userId,\r\n      sessionId: sessionId || conversationId,\r\n      startedAt: new Date(),\r\n      lastActivityAt: new Date(),\r\n      messageCount: 0,\r\n      currentIntent: undefined,\r\n      extractedEntities: {},\r\n      bookingData: {},\r\n      preferences: {},\r\n      metadata: initialContext || {}\r\n    };\r\n\r\n    this.activeConversations.set(conversationId, context);\r\n    engine.activeConversations++;\r\n    engine.totalConversations++;\r\n\r\n    console.log(`[AIEngineManager] Started conversation ${conversationId} with engine ${engine.template.name}`);\r\n    return context;\r\n  }\r\n\r\n  /**\r\n   * Get conversation context\r\n   */\r\n  getConversation(conversationId: string): ConversationContext | undefined {\r\n    return this.activeConversations.get(conversationId);\r\n  }\r\n\r\n  /**\r\n   * Update conversation context\r\n   */\r\n  updateConversation(\r\n    conversationId: string,\r\n    updates: Partial<ConversationContext>\r\n  ): ConversationContext | null {\r\n    const context = this.activeConversations.get(conversationId);\r\n    if (!context) return null;\r\n\r\n    const updated: ConversationContext = {\r\n      ...context,\r\n      ...updates,\r\n      lastActivityAt: new Date()\r\n    };\r\n\r\n    this.activeConversations.set(conversationId, updated);\r\n    return updated;\r\n  }\r\n\r\n  /**\r\n   * End a conversation\r\n   */\r\n  endConversation(conversationId: string): void {\r\n    const context = this.activeConversations.get(conversationId);\r\n    if (!context) return;\r\n\r\n    const engine = this.engines.get(context.engineInstanceId);\r\n    if (engine) {\r\n      engine.activeConversations = Math.max(0, engine.activeConversations - 1);\r\n    }\r\n\r\n    this.activeConversations.delete(conversationId);\r\n    console.log(`[AIEngineManager] Ended conversation ${conversationId}`);\r\n  }\r\n\r\n  // ========================================\r\n  // TOOL EXECUTION\r\n  // ========================================\r\n\r\n  /**\r\n   * Register a tool handler\r\n   */\r\n  registerToolHandler(handlerPath: string, handler: Function): void {\r\n    this.toolHandlers.set(handlerPath, handler);\r\n  }\r\n\r\n  /**\r\n   * Execute a tool\r\n   */\r\n  async executeTool(\r\n    toolName: string,\r\n    parameters: Record<string, any>,\r\n    context: ConversationContext\r\n  ): Promise<{\r\n    success: boolean;\r\n    result?: any;\r\n    error?: string;\r\n  }> {\r\n    // Find the tool across all skills\r\n    let tool: AITool | undefined;\r\n    for (const skill of allSkills) {\r\n      tool = skill.tools.find(t => t.name === toolName);\r\n      if (tool) break;\r\n    }\r\n\r\n    if (!tool) {\r\n      return { success: false, error: `Tool not found: ${toolName}` };\r\n    }\r\n\r\n    // Get handler\r\n    const handler = this.toolHandlers.get(tool.handler);\r\n    if (!handler) {\r\n      console.warn(`[AIEngineManager] Handler not registered: ${tool.handler}`);\r\n      // Return mock for now\r\n      return {\r\n        success: true,\r\n        result: { message: `[Mock] Tool ${toolName} executed with params`, parameters }\r\n      };\r\n    }\r\n\r\n    try {\r\n      const result = await handler(parameters, context);\r\n      return { success: true, result };\r\n    } catch (error: any) {\r\n      console.error(`[AIEngineManager] Tool execution error:`, error);\r\n      return { success: false, error: error.message };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get all available tools for an engine\r\n   */\r\n  getEngineTools(engineInstanceId: string): AITool[] {\r\n    const engine = this.engines.get(engineInstanceId);\r\n    if (!engine) return [];\r\n\r\n    const tools: AITool[] = [];\r\n    engine.template.skills.forEach(skill => {\r\n      if (skill.isEnabled) {\r\n        tools.push(...skill.tools);\r\n      }\r\n    });\r\n\r\n    return tools;\r\n  }\r\n\r\n  /**\r\n   * Format tools for LLM consumption (OpenAI function format)\r\n   */\r\n  formatToolsForLLM(engineInstanceId: string): any[] {\r\n    const tools = this.getEngineTools(engineInstanceId);\r\n    \r\n    return tools.map(tool => ({\r\n      type: 'function',\r\n      function: {\r\n        name: tool.name,\r\n        description: tool.description,\r\n        parameters: {\r\n          type: 'object',\r\n          properties: tool.parameters.reduce((acc, param) => {\r\n            acc[param.name] = {\r\n              type: param.type === 'date' ? 'string' : param.type,\r\n              description: param.description\r\n            };\r\n            if (param.enum) {\r\n              acc[param.name].enum = param.enum;\r\n            }\r\n            return acc;\r\n          }, {} as Record<string, any>),\r\n          required: tool.parameters\r\n            .filter(p => p.required)\r\n            .map(p => p.name)\r\n        }\r\n      }\r\n    }));\r\n  }\r\n\r\n  // ========================================\r\n  // HANDOFF MANAGEMENT\r\n  // ========================================\r\n\r\n  /**\r\n   * Check if handoff should be triggered\r\n   */\r\n  shouldTriggerHandoff(\r\n    message: string,\r\n    context: ConversationContext\r\n  ): { shouldHandoff: boolean; targetEngine?: string; reason?: string } {\r\n    const engine = this.engines.get(context.engineInstanceId);\r\n    if (!engine?.template.handoff?.enableHandoff) {\r\n      return { shouldHandoff: false };\r\n    }\r\n\r\n    const handoff = engine.template.handoff;\r\n    const lowerMessage = message.toLowerCase();\r\n\r\n    // Check trigger phrases\r\n    for (const trigger of handoff.handoffTriggers || []) {\r\n      if (lowerMessage.includes(trigger.toLowerCase())) {\r\n        // Determine target engine based on trigger\r\n        const targetEngine = this.determineHandoffTarget(trigger, handoff);\r\n        return {\r\n          shouldHandoff: true,\r\n          targetEngine,\r\n          reason: `Triggered by phrase: \"${trigger}\"`\r\n        };\r\n      }\r\n    }\r\n\r\n    return { shouldHandoff: false };\r\n  }\r\n\r\n  /**\r\n   * Determine which engine to hand off to\r\n   */\r\n  private determineHandoffTarget(trigger: string, handoff: HandoffConfig): string | undefined {\r\n    const targetEngines = handoff.targetEngines || [];\r\n    if (targetEngines.length === 0) return undefined;\r\n\r\n    // Simple keyword matching for now\r\n    const triggerLower = trigger.toLowerCase();\r\n    \r\n    if (triggerLower.includes('book') || triggerLower.includes('הזמנ')) {\r\n      return targetEngines.find(e => e.includes('booking'));\r\n    }\r\n    if (triggerLower.includes('support') || triggerLower.includes('issue') || triggerLower.includes('problem')) {\r\n      return targetEngines.find(e => e.includes('support'));\r\n    }\r\n    if (triggerLower.includes('group') || triggerLower.includes('corporate') || triggerLower.includes('קבוצ')) {\r\n      return targetEngines.find(e => e.includes('group'));\r\n    }\r\n    if (triggerLower.includes('price') || triggerLower.includes('מחיר')) {\r\n      return targetEngines.find(e => e.includes('price'));\r\n    }\r\n\r\n    return targetEngines[0];\r\n  }\r\n\r\n  /**\r\n   * Execute handoff to another engine\r\n   */\r\n  async executeHandoff(\r\n    conversationId: string,\r\n    targetEngineId: string\r\n  ): Promise<{\r\n    success: boolean;\r\n    newContext?: ConversationContext;\r\n    handoffMessage?: string;\r\n    error?: string;\r\n  }> {\r\n    const currentContext = this.activeConversations.get(conversationId);\r\n    if (!currentContext) {\r\n      return { success: false, error: 'Conversation not found' };\r\n    }\r\n\r\n    // Find target engine\r\n    let targetEngine: AIEngineInstance | undefined;\r\n    for (const engine of this.engines.values()) {\r\n      if (engine.template.id === targetEngineId || engine.instanceId === targetEngineId) {\r\n        targetEngine = engine;\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (!targetEngine) {\r\n      return { success: false, error: `Target engine not found: ${targetEngineId}` };\r\n    }\r\n\r\n    // Create new conversation with target engine, preserving context\r\n    const newContext = this.startConversation(\r\n      targetEngine.instanceId,\r\n      currentContext.userId,\r\n      currentContext.sessionId,\r\n      {\r\n        ...currentContext.metadata,\r\n        handoffFrom: currentContext.engineInstanceId,\r\n        previousContext: {\r\n          extractedEntities: currentContext.extractedEntities,\r\n          bookingData: currentContext.bookingData,\r\n          preferences: currentContext.preferences\r\n        }\r\n      }\r\n    );\r\n\r\n    if (!newContext) {\r\n      return { success: false, error: 'Failed to create new conversation' };\r\n    }\r\n\r\n    // Preserve extracted data\r\n    newContext.extractedEntities = { ...currentContext.extractedEntities };\r\n    newContext.bookingData = { ...currentContext.bookingData };\r\n    newContext.preferences = { ...currentContext.preferences };\r\n\r\n    // End old conversation\r\n    this.endConversation(conversationId);\r\n\r\n    const handoffMessage = targetEngine.template.handoff?.handoffMessage || \r\n      `I'm connecting you with our ${targetEngine.template.persona?.role || 'specialist'} who can better assist you.`;\r\n\r\n    console.log(`[AIEngineManager] Handoff executed: ${currentContext.engineInstanceId} -> ${targetEngine.instanceId}`);\r\n\r\n    return {\r\n      success: true,\r\n      newContext,\r\n      handoffMessage\r\n    };\r\n  }\r\n\r\n  // ========================================\r\n  // ENGINE CONFIGURATION\r\n  // ========================================\r\n\r\n  /**\r\n   * Update engine configuration\r\n   */\r\n  updateEngineConfig(\r\n    instanceId: string,\r\n    config: Partial<AIEngineTemplate>\r\n  ): AIEngineInstance | null {\r\n    const engine = this.engines.get(instanceId);\r\n    if (!engine) return null;\r\n\r\n    engine.template = { ...engine.template, ...config };\r\n    engine.lastModified = new Date();\r\n\r\n    return engine;\r\n  }\r\n\r\n  /**\r\n   * Enable/disable a skill for an engine\r\n   */\r\n  toggleEngineSkill(instanceId: string, skillId: string, enabled: boolean): boolean {\r\n    const engine = this.engines.get(instanceId);\r\n    if (!engine) return false;\r\n\r\n    const skill = engine.template.skills.find(s => s.id === skillId);\r\n    if (!skill) return false;\r\n\r\n    skill.isEnabled = enabled;\r\n    engine.lastModified = new Date();\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Add a skill to an engine\r\n   */\r\n  addSkillToEngine(instanceId: string, skillId: string): boolean {\r\n    const engine = this.engines.get(instanceId);\r\n    if (!engine) return false;\r\n\r\n    const skill = getSkillById(skillId);\r\n    if (!skill) return false;\r\n\r\n    // Check if skill already exists\r\n    if (engine.template.skills.some(s => s.id === skillId)) {\r\n      return false;\r\n    }\r\n\r\n    engine.template.skills.push({ ...skill });\r\n    engine.lastModified = new Date();\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Set engine status\r\n   */\r\n  setEngineStatus(instanceId: string, status: 'active' | 'paused' | 'maintenance'): boolean {\r\n    const engine = this.engines.get(instanceId);\r\n    if (!engine) return false;\r\n\r\n    engine.status = status;\r\n    engine.lastModified = new Date();\r\n\r\n    return true;\r\n  }\r\n\r\n  // ========================================\r\n  // ANALYTICS & REPORTING\r\n  // ========================================\r\n\r\n  /**\r\n   * Get engine statistics\r\n   */\r\n  getEngineStats(instanceId?: string): Record<string, any> {\r\n    if (instanceId) {\r\n      const engine = this.engines.get(instanceId);\r\n      if (!engine) return {};\r\n\r\n      return {\r\n        instanceId: engine.instanceId,\r\n        name: engine.template.name,\r\n        type: engine.template.type,\r\n        status: engine.status,\r\n        activeConversations: engine.activeConversations,\r\n        totalConversations: engine.totalConversations,\r\n        skillCount: engine.template.skills.length,\r\n        toolCount: engine.tools.length,\r\n        createdAt: engine.createdAt,\r\n        lastModified: engine.lastModified\r\n      };\r\n    }\r\n\r\n    // Aggregate stats for all engines\r\n    const engines = Array.from(this.engines.values());\r\n    return {\r\n      totalEngines: engines.length,\r\n      activeEngines: engines.filter(e => e.status === 'active').length,\r\n      totalActiveConversations: engines.reduce((sum, e) => sum + e.activeConversations, 0),\r\n      totalConversations: engines.reduce((sum, e) => sum + e.totalConversations, 0),\r\n      enginesByType: engines.reduce((acc, e) => {\r\n        acc[e.template.type] = (acc[e.template.type] || 0) + 1;\r\n        return acc;\r\n      }, {} as Record<string, number>)\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get conversation analytics\r\n   */\r\n  getConversationAnalytics(timeRange?: { from: Date; to: Date }): Record<string, any> {\r\n    const conversations = Array.from(this.activeConversations.values());\r\n\r\n    // Filter by time range if provided\r\n    let filtered = conversations;\r\n    if (timeRange) {\r\n      filtered = conversations.filter(c => \r\n        c.startedAt >= timeRange.from && c.startedAt <= timeRange.to\r\n      );\r\n    }\r\n\r\n    return {\r\n      activeConversations: filtered.length,\r\n      averageMessageCount: filtered.reduce((sum, c) => sum + c.messageCount, 0) / filtered.length || 0,\r\n      conversationsByEngine: filtered.reduce((acc, c) => {\r\n        acc[c.engineInstanceId] = (acc[c.engineInstanceId] || 0) + 1;\r\n        return acc;\r\n      }, {} as Record<string, number>),\r\n      intents: filtered.reduce((acc, c) => {\r\n        if (c.currentIntent) {\r\n          acc[c.currentIntent] = (acc[c.currentIntent] || 0) + 1;\r\n        }\r\n        return acc;\r\n      }, {} as Record<string, number>)\r\n    };\r\n  }\r\n}\r\n\r\n// ========================================\r\n// SINGLETON EXPORT\r\n// ========================================\r\n\r\nlet managerInstance: AIEngineManager | null = null;\r\n\r\nexport function getAIEngineManager(): AIEngineManager {\r\n  if (!managerInstance) {\r\n    managerInstance = new AIEngineManager();\r\n  }\r\n  return managerInstance;\r\n}\r\n\r\nexport function resetAIEngineManager(): void {\r\n  managerInstance = null;\r\n}\r\n"],"names":[],"mappings":"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"}