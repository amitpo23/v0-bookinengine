{"version":3,"sources":["../../../node_modules/next/src/server/route-modules/app-page/module.compiled.js","../../../node_modules/next/src/server/route-modules/app-page/vendored/rsc/react.ts","../../../lib/logging/api-logger.ts"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-rsc']!.React\n","// Comprehensive API Logging System\n// Tracks all API calls, responses, and errors\n\nimport { createClient } from \"@supabase/supabase-js\"\n\n// Log levels\nexport type LogLevel = \"debug\" | \"info\" | \"warn\" | \"error\"\n\n// Log entry structure\nexport interface ApiLogEntry {\n  id?: string\n  timestamp: string\n  level: LogLevel\n  category: \"api\" | \"medici\" | \"booking\" | \"auth\" | \"system\"\n  action: string\n  method?: string\n  endpoint?: string\n  requestBody?: any\n  responseBody?: any\n  statusCode?: number\n  duration?: number\n  userId?: string\n  sessionId?: string\n  ip?: string\n  userAgent?: string\n  error?: string\n  metadata?: Record<string, any>\n}\n\n// In-memory buffer for logs (also saved to Supabase if configured)\nconst logBuffer: ApiLogEntry[] = []\nconst MAX_BUFFER_SIZE = 1000\n\n// Supabase client for persistent logging\nlet supabase: ReturnType<typeof createClient> | null = null\n\nfunction getSupabase() {\n  if (!supabase && process.env.NEXT_PUBLIC_SUPABASE_URL && process.env.SUPABASE_SERVICE_KEY) {\n    supabase = createClient(\n      process.env.NEXT_PUBLIC_SUPABASE_URL,\n      process.env.SUPABASE_SERVICE_KEY\n    )\n  }\n  return supabase\n}\n\n// Color codes for console output\nconst colors = {\n  reset: \"\\x1b[0m\",\n  bright: \"\\x1b[1m\",\n  dim: \"\\x1b[2m\",\n  red: \"\\x1b[31m\",\n  green: \"\\x1b[32m\",\n  yellow: \"\\x1b[33m\",\n  blue: \"\\x1b[34m\",\n  magenta: \"\\x1b[35m\",\n  cyan: \"\\x1b[36m\",\n  white: \"\\x1b[37m\",\n  bgRed: \"\\x1b[41m\",\n  bgGreen: \"\\x1b[42m\",\n  bgYellow: \"\\x1b[43m\",\n  bgBlue: \"\\x1b[44m\",\n}\n\nfunction getLevelColor(level: LogLevel): string {\n  switch (level) {\n    case \"debug\": return colors.dim\n    case \"info\": return colors.cyan\n    case \"warn\": return colors.yellow\n    case \"error\": return colors.red\n    default: return colors.white\n  }\n}\n\nfunction getCategoryIcon(category: ApiLogEntry[\"category\"]): string {\n  switch (category) {\n    case \"api\": return \"üåê\"\n    case \"medici\": return \"üè®\"\n    case \"booking\": return \"üìã\"\n    case \"auth\": return \"üîê\"\n    case \"system\": return \"‚öôÔ∏è\"\n    default: return \"üìù\"\n  }\n}\n\nfunction formatDuration(ms: number): string {\n  if (ms < 1000) return `${ms}ms`\n  return `${(ms / 1000).toFixed(2)}s`\n}\n\nfunction truncate(str: string, maxLen: number = 200): string {\n  if (!str) return \"\"\n  if (str.length <= maxLen) return str\n  return str.substring(0, maxLen) + \"...\"\n}\n\n// Main logger class\nclass ApiLogger {\n  private static instance: ApiLogger\n  private enabled: boolean = true\n\n  private constructor() {}\n\n  static getInstance(): ApiLogger {\n    if (!ApiLogger.instance) {\n      ApiLogger.instance = new ApiLogger()\n    }\n    return ApiLogger.instance\n  }\n\n  setEnabled(enabled: boolean) {\n    this.enabled = enabled\n  }\n\n  private formatLogForConsole(entry: ApiLogEntry): string {\n    const time = new Date(entry.timestamp).toLocaleTimeString(\"he-IL\")\n    const icon = getCategoryIcon(entry.category)\n    const levelColor = getLevelColor(entry.level)\n    \n    let output = `${colors.dim}[${time}]${colors.reset} ${icon} ${levelColor}[${entry.level.toUpperCase()}]${colors.reset} `\n    output += `${colors.bright}${entry.action}${colors.reset}`\n    \n    if (entry.method && entry.endpoint) {\n      const methodColor = entry.method === \"GET\" ? colors.green : \n                         entry.method === \"POST\" ? colors.blue : \n                         entry.method === \"PUT\" ? colors.yellow : colors.red\n      output += ` ${methodColor}${entry.method}${colors.reset} ${entry.endpoint}`\n    }\n    \n    if (entry.statusCode) {\n      const statusColor = entry.statusCode < 300 ? colors.green : \n                         entry.statusCode < 400 ? colors.yellow : colors.red\n      output += ` ${statusColor}[${entry.statusCode}]${colors.reset}`\n    }\n    \n    if (entry.duration) {\n      output += ` ${colors.magenta}(${formatDuration(entry.duration)})${colors.reset}`\n    }\n    \n    return output\n  }\n\n  async log(entry: Omit<ApiLogEntry, \"id\" | \"timestamp\">): Promise<void> {\n    if (!this.enabled) return\n\n    const fullEntry: ApiLogEntry = {\n      ...entry,\n      timestamp: new Date().toISOString(),\n    }\n\n    // Console output\n    console.log(this.formatLogForConsole(fullEntry))\n    \n    // Additional details for errors or debug\n    if (entry.level === \"error\" && entry.error) {\n      console.error(`${colors.red}  Error: ${entry.error}${colors.reset}`)\n    }\n    \n    if (entry.requestBody && (entry.level === \"debug\" || entry.level === \"error\")) {\n      console.log(`${colors.dim}  Request: ${truncate(JSON.stringify(entry.requestBody))}${colors.reset}`)\n    }\n    \n    if (entry.responseBody && entry.level === \"error\") {\n      console.log(`${colors.dim}  Response: ${truncate(JSON.stringify(entry.responseBody))}${colors.reset}`)\n    }\n\n    // Add to buffer\n    logBuffer.push(fullEntry)\n    if (logBuffer.length > MAX_BUFFER_SIZE) {\n      logBuffer.shift()\n    }\n\n    // Save to Supabase (async, non-blocking)\n    this.saveToSupabase(fullEntry).catch(() => {})\n  }\n\n  private async saveToSupabase(entry: ApiLogEntry): Promise<void> {\n    const db = getSupabase()\n    if (!db) return\n\n    try {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      await (db.from(\"api_logs\") as any).insert({\n        timestamp: entry.timestamp,\n        level: entry.level,\n        category: entry.category,\n        action: entry.action,\n        method: entry.method,\n        endpoint: entry.endpoint,\n        request_body: entry.requestBody,\n        response_body: entry.responseBody,\n        status_code: entry.statusCode,\n        duration_ms: entry.duration,\n        user_id: entry.userId,\n        session_id: entry.sessionId,\n        ip_address: entry.ip,\n        user_agent: entry.userAgent,\n        error_message: entry.error,\n        metadata: entry.metadata,\n      })\n    } catch (error) {\n      // Silent fail - don't let logging break the app\n    }\n  }\n\n  // Convenience methods\n  debug(category: ApiLogEntry[\"category\"], action: string, metadata?: Record<string, any>) {\n    this.log({ level: \"debug\", category, action, metadata })\n  }\n\n  info(category: ApiLogEntry[\"category\"], action: string, metadata?: Record<string, any>) {\n    this.log({ level: \"info\", category, action, metadata })\n  }\n\n  warn(category: ApiLogEntry[\"category\"], action: string, metadata?: Record<string, any>) {\n    this.log({ level: \"warn\", category, action, metadata })\n  }\n\n  error(category: ApiLogEntry[\"category\"], action: string, error?: string, metadata?: Record<string, any>) {\n    this.log({ level: \"error\", category, action, error, metadata })\n  }\n\n  // API request logging\n  async logApiRequest(params: {\n    method: string\n    endpoint: string\n    requestBody?: any\n    responseBody?: any\n    statusCode: number\n    duration: number\n    userId?: string\n    ip?: string\n    userAgent?: string\n    error?: string\n  }) {\n    const level: LogLevel = params.statusCode >= 500 ? \"error\" : \n                           params.statusCode >= 400 ? \"warn\" : \"info\"\n    \n    await this.log({\n      level,\n      category: \"api\",\n      action: `API Request`,\n      ...params,\n    })\n  }\n\n  // Medici API logging\n  async logMediciCall(params: {\n    action: string\n    endpoint: string\n    requestBody?: any\n    responseBody?: any\n    statusCode: number\n    duration: number\n    error?: string\n  }) {\n    const level: LogLevel = params.statusCode >= 500 ? \"error\" : \n                           params.statusCode >= 400 ? \"warn\" : \"info\"\n    \n    await this.log({\n      level,\n      category: \"medici\",\n      method: \"POST\",\n      ...params,\n    })\n  }\n\n  // Get recent logs\n  getRecentLogs(count: number = 100, filter?: Partial<ApiLogEntry>): ApiLogEntry[] {\n    let logs = [...logBuffer].reverse()\n    \n    if (filter) {\n      logs = logs.filter(log => {\n        if (filter.level && log.level !== filter.level) return false\n        if (filter.category && log.category !== filter.category) return false\n        if (filter.action && !log.action.includes(filter.action)) return false\n        return true\n      })\n    }\n    \n    return logs.slice(0, count)\n  }\n\n  // Clear buffer\n  clearBuffer() {\n    logBuffer.length = 0\n  }\n}\n\n// Export singleton instance\nexport const apiLogger = ApiLogger.getInstance()\n\n// Export helper for timing operations\nexport function withTiming<T>(operation: () => Promise<T>): Promise<{ result: T; duration: number }> {\n  const start = Date.now()\n  return operation().then(result => ({\n    result,\n    duration: Date.now() - start\n  }))\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","vendored","React"],"mappings":"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","ignoreList":[0,1]}