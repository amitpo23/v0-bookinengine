module.exports=[89561,e=>{"use strict";var t=e.i(74119),r=e.i(74815),n=e.i(66969),a=e.i(8984),o=e.i(80568),s=e.i(85983),i=e.i(51311),l=e.i(48892),u=e.i(16339),c=e.i(34600),d=e.i(71794),p=e.i(4358),h=e.i(80603),m=e.i(79181),g=e.i(53442),f=e.i(70798),R=e.i(93695);e.i(51004);var v=e.i(64291),y=e.i(14539);let w=new Map;async function E(e,t="IL"){let r=`dest-${e}-${t}`,n=w.get(r);if(n&&Date.now()-n.timestamp<36e5)return n.data;try{var a,o,s,i;let n,l,u,c=process.env.SERPAPI_KEY;if(!c)return console.warn("[Trends] SERPAPI_KEY not configured, returning mock data"),N(e,t);let d=`${e} ${t} travel hotel vacation`,p=await fetch(`https://serpapi.com/search.json?engine=google_trends&q=${encodeURIComponent(d)}&geo=${t}&api_key=${c}`);if(!p.ok)return console.error("[Trends] SerpAPI error:",p.statusText),N(e,t);let h=(a=await p.json(),o=e,s=t,n=a.interest_over_time?.timeline_data||[],l=a.related_queries?.rising||[],u=n.reduce((e,t)=>e+(t.values?.[0]?.value||0),0)/(n.length||1),{destination:o,country:s,popularityScore:Math.round(u),seasonality:u>70?"high":u>40?"medium":"low",trending:u>50,topReasons:l.slice(0,5).map(e=>e.query||""),bestMonths:(i=n).length?i.map(e=>({month:e.date||"",value:e.values?.[0]?.value||0})).sort((e,t)=>t.value-e.value).slice(0,3).map(e=>{let t=e.month.match(/(\w+)/);return t?t[1]:""}).filter(Boolean):["Summer","Winter"]});return w.set(r,{data:h,timestamp:Date.now()}),h}catch(r){return console.error("[Trends] Error fetching trends:",r),N(e,t)}}async function x(e,t="IL"){let r=`travel-${e.join(",")}-${t}`,n=w.get(r);if(n&&Date.now()-n.timestamp<36e5)return n.data;try{let n=process.env.SERPAPI_KEY;if(!n)return e.map(e=>P(e,t));let a=[];for(let r of e){let e=await fetch(`https://serpapi.com/search.json?engine=google_trends&q=${encodeURIComponent(r)}&geo=${t}&api_key=${n}`);if(e.ok){let n=await e.json();a.push(function(e,t,r){let n=e.interest_over_time?.timeline_data||[],a=e.related_queries?.rising||[],o=n.reduce((e,t)=>e+(t.values?.[0]?.value||0),0)/(n.length||1);return{keyword:t,trend:o>60?"rising":o<30?"falling":"stable",interest:Math.round(o),relatedQueries:a.slice(0,10).map(e=>e.query||""),region:r,timestamp:new Date}}(n,r,t))}}return w.set(r,{data:a,timestamp:Date.now()}),a}catch(r){return console.error("[Trends] Error fetching travel trends:",r),e.map(e=>P(e,t))}}async function A(e=10){let t=`top-destinations-${e}`,r=w.get(t);if(r&&Date.now()-r.timestamp<36e5)return r.data;try{var n,a;let r=process.env.SERPAPI_KEY;if(!r)return S(e);let o=await fetch(`https://serpapi.com/search.json?engine=google_trends&q=travel+destinations&geo=US&api_key=${r}`);if(!o.ok)return S(e);let s=(n=await o.json(),a=e,(n.related_queries?.top||[]).slice(0,a).map((e,t)=>({destination:e.query||`Destination ${t+1}`,country:"Various",popularityScore:e.value||0,seasonality:"medium",trending:e.value>50,topReasons:["Popular search","Rising interest"],bestMonths:["Summer","Spring"]})));return w.set(t,{data:s,timestamp:Date.now()}),s}catch(t){return console.error("[Trends] Error fetching top destinations:",t),S(e)}}function N(e,t){let r={"Tel Aviv":85,Jerusalem:78,Eilat:72,Paris:95,London:92,"New York":88,Dubai:90,Barcelona:87,Rome:84,Amsterdam:81}[e]||Math.floor(30*Math.random())+50;return{destination:e,country:t,popularityScore:r,seasonality:r>80?"high":r>60?"medium":"low",trending:r>75,topReasons:["Beautiful beaches","Rich culture","Great food","Historical sites","Shopping destinations"],bestMonths:["May","June","September","October"]}}function P(e,t){let r=Math.floor(50*Math.random())+30;return{keyword:e,trend:r>60?"rising":r<40?"falling":"stable",interest:r,relatedQueries:[`${e} hotels`,`${e} vacation packages`,`${e} things to do`,`${e} weather`,`${e} flights`],region:t,timestamp:new Date}}function S(e){return[{name:"Paris",country:"France",score:95},{name:"London",country:"UK",score:92},{name:"Dubai",country:"UAE",score:90},{name:"New York",country:"USA",score:88},{name:"Barcelona",country:"Spain",score:87},{name:"Rome",country:"Italy",score:84},{name:"Tokyo",country:"Japan",score:86},{name:"Amsterdam",country:"Netherlands",score:81},{name:"Istanbul",country:"Turkey",score:79},{name:"Tel Aviv",country:"Israel",score:85}].slice(0,e).map(e=>({destination:e.name,country:e.country,popularityScore:e.score,seasonality:e.score>85?"high":"medium",trending:e.score>85,topReasons:["Popular destination","Rich culture","Great attractions"],bestMonths:["May","June","September"]}))}async function _(e){try{let{searchParams:t}=new URL(e.url),r=t.get("action");if("destination"===r){let e=t.get("destination"),r=t.get("country")||"IL";if(!e)return y.NextResponse.json({error:"Destination parameter is required"},{status:400});let n=await E(e,r);return y.NextResponse.json({success:!0,data:n})}if("travel"===r){let e=t.get("keywords"),r=t.get("region")||"IL";if(!e)return y.NextResponse.json({error:"Keywords parameter is required"},{status:400});let n=e.split(",").map(e=>e.trim()),a=await x(n,r);return y.NextResponse.json({success:!0,data:a})}if("top"===r){let e=parseInt(t.get("limit")||"10"),r=await A(e);return y.NextResponse.json({success:!0,data:r})}return y.NextResponse.json({error:"Invalid action. Use: destination, travel, or top"},{status:400})}catch(e){return console.error("[API Trends] Error:",e),y.NextResponse.json({error:e.message||"Failed to fetch trends data"},{status:500})}}async function T(e){try{let{action:t,destination:r,country:n,keywords:a,region:o,limit:s}=await e.json();if("destination"===t){if(!r)return y.NextResponse.json({error:"Destination is required"},{status:400});let e=await E(r,n||"IL");return y.NextResponse.json({success:!0,data:e})}if("travel"===t){if(!a||!Array.isArray(a))return y.NextResponse.json({error:"Keywords array is required"},{status:400});let e=await x(a,o||"IL");return y.NextResponse.json({success:!0,data:e})}if("top"===t){let e=await A(s||10);return y.NextResponse.json({success:!0,data:e})}return y.NextResponse.json({error:"Invalid action. Use: destination, travel, or top"},{status:400})}catch(e){return console.error("[API Trends] Error:",e),y.NextResponse.json({error:e.message||"Failed to fetch trends data"},{status:500})}}e.s(["GET",()=>_,"POST",()=>T],67945);var C=e.i(67945);let I=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/trends/route",pathname:"/api/trends",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/v0-bookinengine/app/api/trends/route.ts",nextConfigOutput:"",userland:C}),{workAsyncStorage:b,workUnitAsyncStorage:j,serverHooks:M}=I;function $(){return(0,n.patchFetch)({workAsyncStorage:b,workUnitAsyncStorage:j})}async function k(e,t,n){I.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let y="/api/trends/route";y=y.replace(/\/index$/,"")||"/";let w=await I.prepare(e,t,{srcPage:y,multiZoneDraftMode:!1});if(!w)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:E,params:x,nextConfig:A,parsedUrl:N,isDraftMode:P,prerenderManifest:S,routerServerContext:_,isOnDemandRevalidate:T,revalidateOnlyGenerated:C,resolvedPathname:b,clientReferenceManifest:j,serverActionsManifest:M}=w,$=(0,l.normalizeAppPath)(y),k=!!(S.dynamicRoutes[$]||S.routes[b]),q=async()=>((null==_?void 0:_.render404)?await _.render404(e,t,N,!1):t.end("This page could not be found"),null);if(k&&!P){let e=!!S.routes[b],t=S.dynamicRoutes[$];if(t&&!1===t.fallback&&!e){if(A.experimental.adapterPath)return await q();throw new R.NoFallbackError}}let D=null;!k||I.isDev||P||(D="/index"===(D=b)?"/":D);let U=!0===I.isDev||!k,O=k&&!U;M&&j&&(0,s.setReferenceManifestsSingleton)({page:y,clientReferenceManifest:j,serverActionsManifest:M,serverModuleMap:(0,i.createServerModuleMap)({serverActionsManifest:M})});let H=e.method||"GET",K=(0,o.getTracer)(),L=K.getActiveScopeSpan(),F={params:x,prerenderManifest:S,renderOpts:{experimental:{authInterrupts:!!A.experimental.authInterrupts},cacheComponents:!!A.cacheComponents,supportsDynamicResponse:U,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:A.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n)=>I.onRequestError(e,t,n,_)},sharedContext:{buildId:E}},B=new u.NodeNextRequest(e),G=new u.NodeNextResponse(t),Y=c.NextRequestAdapter.fromNodeNextRequest(B,(0,c.signalFromNodeResponse)(t));try{let s=async e=>I.handle(Y,F).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=K.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=r.get("next.route");if(n){let t=`${H} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${H} ${y}`)}),i=!!(0,a.getRequestMeta)(e,"minimalMode"),l=async a=>{var o,l;let u=async({previousCacheEntry:r})=>{try{if(!i&&T&&C&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let o=await s(a);e.fetchMetrics=F.renderOpts.fetchMetrics;let l=F.renderOpts.pendingWaitUntil;l&&n.waitUntil&&(n.waitUntil(l),l=void 0);let u=F.renderOpts.collectedTags;if(!k)return await (0,h.sendResponse)(B,G,o,F.renderOpts.pendingWaitUntil),null;{let e=await o.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(o.headers);u&&(t[f.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==F.renderOpts.collectedRevalidate&&!(F.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&F.renderOpts.collectedRevalidate,n=void 0===F.renderOpts.collectedExpire||F.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:F.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:o.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==r?void 0:r.isStale)&&await I.onRequestError(e,t,{routerKind:"App Router",routePath:y,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:O,isOnDemandRevalidate:T})},_),t}},c=await I.handleResponse({req:e,nextConfig:A,cacheKey:D,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:S,isRoutePPREnabled:!1,isOnDemandRevalidate:T,revalidateOnlyGenerated:C,responseGenerator:u,waitUntil:n.waitUntil,isMinimalMode:i});if(!k)return null;if((null==c||null==(o=c.value)?void 0:o.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(l=c.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});i||t.setHeader("x-nextjs-cache",T?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),P&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let d=(0,m.fromNodeOutgoingHttpHeaders)(c.value.headers);return i&&k||d.delete(f.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||d.get("Cache-Control")||d.set("Cache-Control",(0,g.getCacheControlHeader)(c.cacheControl)),await (0,h.sendResponse)(B,G,new Response(c.value.body,{headers:d,status:c.value.status||200})),null};L?await l(L):await K.withPropagatedContext(e.headers,()=>K.trace(d.BaseServerSpan.handleRequest,{spanName:`${H} ${y}`,kind:o.SpanKind.SERVER,attributes:{"http.method":H,"http.target":e.url}},l))}catch(t){if(t instanceof R.NoFallbackError||await I.onRequestError(e,t,{routerKind:"App Router",routePath:$,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:O,isOnDemandRevalidate:T})}),k)throw t;return await (0,h.sendResponse)(B,G,new Response(null,{status:500})),null}}e.s(["handler",()=>k,"patchFetch",()=>$,"routeModule",()=>I,"serverHooks",()=>M,"workAsyncStorage",()=>b,"workUnitAsyncStorage",()=>j],89561)}];

//# sourceMappingURL=52597_next_dist_esm_build_templates_app-route_18aaf0ab.js.map